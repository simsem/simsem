
R version 2.15.2 (2012-10-26) -- "Trick or Treat"
Copyright (C) 2012 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: i386-w64-mingw32/i386 (32-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> pkgname <- "simsem"
> source(file.path(R.home("share"), "R", "examples-header.R"))
> options(warn = 1)
> options(pager = "console")
> library('simsem')
Loading required package: lavaan
Loading required package: MASS
Loading required package: boot
Loading required package: mnormt
Loading required package: quadprog
This is lavaan 0.5-10
lavaan is BETA software! Please report any bugs.
Loading required package: copula
 
###############################################################################################
This is simsem 0.5-0
simsem is BETA software! Please report any bugs.
simsem was developed at the University of Kansas Center for Research Methods and Data Analysis.
###############################################################################################
> 
> assign(".oldSearch", search(), pos = 'CheckExEnv')
> cleanEx()
> nameEx("SimDataDist-class")
> ### * SimDataDist-class
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: SimDataDist-class
> ### Title: Class '"SimDataDist"': Data distribution object
> ### Aliases: SimDataDist-class summary,SimDataDist-method
> ###   plotDist,SimDataDist-method
> ### Keywords: classes
> 
> ### ** Examples
> 
> showClass("SimDataDist")
Class "SimDataDist" [package "simsem"]

Slots:
                                                                       
Name:             p      margins paramMargins    keepScale      reverse
Class:      numeric    character         list      logical       vector
                   
Name:        copula
Class:       copula
> 
> d1 <- list(df=2)
> d2 <- list(df=3)
> d3 <- list(df=4)
> d4 <- list(df=5)
> d5 <- list(df=3)
> d6 <- list(df=4)
> d7 <- list(df=5)
> d8 <- list(df=6)
> 
> dist <- bindDist(c(rep("t", 4), rep("chisq", 8)), d1, d2, d3, d4, d5, d6, d7, d8, d5, d6, d7, d8)
> summary(dist)
DATA DISTRIBUTION OBJECT
The number of variables is 12 
Keep means and variances of the original scales: TRUE / TRUE / TRUE / TRUE / TRUE / TRUE / TRUE / TRUE / TRUE / TRUE / TRUE / TRUE 
The list of distributions:
1. t: df = 2
2. t: df = 3
3. t: df = 4
4. t: df = 5
5. chisq: df = 3
6. chisq: df = 4
7. chisq: df = 5
8. chisq: df = 6
9. chisq: df = 3
10. chisq: df = 4
11. chisq: df = 5
12. chisq: df = 6
Reverse (mirror) distribution: FALSE / FALSE / FALSE / FALSE / FALSE / FALSE / FALSE / FALSE / FALSE / FALSE / FALSE / FALSE 
> 
> 
> 
> cleanEx()
> nameEx("SimMatrix-class")
> ### * SimMatrix-class
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: SimMatrix-class
> ### Title: Matrix object: Random parameters matrix
> ### Aliases: SimMatrix-class summaryShort,SimMatrix-method
> ###   summary,SimMatrix-method
> ### Keywords: classes
> 
> ### ** Examples
> 
> showClass("SimMatrix")
Class "SimMatrix" [package "simsem"]

Slots:
                                              
Name:       free  popParam   misspec symmetric
Class:    matrix    matrix    matrix   logical
> 
> loading <- matrix(0, 6, 2)
> loading[1:3, 1] <- NA
> loading[4:6, 2] <- NA
> loadingValues <- matrix(0, 6, 2)
> loadingValues[1:3, 1] <- 0.7
> loadingValues[4:6, 2] <- 0.7
> LY <- bind(loading, loadingValues)
> summary(LY)
[1] "Random Full Matrix Object."
[1] "Free/Fixed Parameters:"
     [,1] [,2]
[1,]   NA    0
[2,]   NA    0
[3,]   NA    0
[4,]    0   NA
[5,]    0   NA
[6,]    0   NA
[1] "Population Parameters/Starting Values:"
     [,1]  [,2] 
[1,] "0.7" ""   
[2,] "0.7" ""   
[3,] "0.7" ""   
[4,] ""    "0.7"
[5,] ""    "0.7"
[6,] ""    "0.7"
[1] "Model misspecification"
     [,1]
[1,]  NaN
> rawDraw(LY)
$param
     [,1] [,2]
[1,]  0.7  0.0
[2,]  0.7  0.0
[3,]  0.7  0.0
[4,]  0.0  0.7
[5,]  0.0  0.7
[6,]  0.0  0.7

$paramMis
     [,1] [,2]
[1,]  0.7  0.0
[2,]  0.7  0.0
[3,]  0.7  0.0
[4,]  0.0  0.7
[5,]  0.0  0.7
[6,]  0.0  0.7

$missRaw
     [,1] [,2]
[1,]    0    0
[2,]    0    0
[3,]    0    0
[4,]    0    0
[5,]    0    0
[6,]    0    0

> 
> LY <- bind(loading, "rnorm(1, 0.6, 0.05)")
> summary(LY)
[1] "Random Full Matrix Object."
[1] "Free/Fixed Parameters:"
     [,1] [,2]
[1,]   NA    0
[2,]   NA    0
[3,]   NA    0
[4,]    0   NA
[5,]    0   NA
[6,]    0   NA
[1] "Population Parameters/Starting Values:"
     [,1]                  [,2]                 
[1,] "rnorm(1, 0.6, 0.05)" ""                   
[2,] "rnorm(1, 0.6, 0.05)" ""                   
[3,] "rnorm(1, 0.6, 0.05)" ""                   
[4,] ""                    "rnorm(1, 0.6, 0.05)"
[5,] ""                    "rnorm(1, 0.6, 0.05)"
[6,] ""                    "rnorm(1, 0.6, 0.05)"
[1] "Model misspecification"
     [,1]
[1,]  NaN
> rawDraw(LY)
$param
          [,1]      [,2]
[1,] 0.6091822 0.0000000
[2,] 0.5582186 0.0000000
[3,] 0.6797640 0.0000000
[4,] 0.0000000 0.6164754
[5,] 0.0000000 0.5589766
[6,] 0.0000000 0.6243715

$paramMis
          [,1]      [,2]
[1,] 0.6091822 0.0000000
[2,] 0.5582186 0.0000000
[3,] 0.6797640 0.0000000
[4,] 0.0000000 0.6164754
[5,] 0.0000000 0.5589766
[6,] 0.0000000 0.6243715

$missRaw
     [,1] [,2]
[1,]    0    0
[2,]    0    0
[3,]    0    0
[4,]    0    0
[5,]    0    0
[6,]    0    0

> 
> mis <- matrix("runif(1, -0.1, 0.1)", 6, 2)
> mis[is.na(loading)] <- 0
> LY <- bind(loading, "rnorm(1, 0.6, 0.05)", mis)
> summary(LY)
[1] "Random Full Matrix Object."
[1] "Free/Fixed Parameters:"
     [,1] [,2]
[1,]   NA    0
[2,]   NA    0
[3,]   NA    0
[4,]    0   NA
[5,]    0   NA
[6,]    0   NA
[1] "Population Parameters/Starting Values:"
     [,1]                  [,2]                 
[1,] "rnorm(1, 0.6, 0.05)" ""                   
[2,] "rnorm(1, 0.6, 0.05)" ""                   
[3,] "rnorm(1, 0.6, 0.05)" ""                   
[4,] ""                    "rnorm(1, 0.6, 0.05)"
[5,] ""                    "rnorm(1, 0.6, 0.05)"
[6,] ""                    "rnorm(1, 0.6, 0.05)"
[1] "Model misspecification"
     [,1]                  [,2]                 
[1,] "0"                   "runif(1, -0.1, 0.1)"
[2,] "0"                   "runif(1, -0.1, 0.1)"
[3,] "0"                   "runif(1, -0.1, 0.1)"
[4,] "runif(1, -0.1, 0.1)" "0"                  
[5,] "runif(1, -0.1, 0.1)" "0"                  
[6,] "runif(1, -0.1, 0.1)" "0"                  
> rawDraw(LY)
$param
          [,1]      [,2]
[1,] 0.6194922 0.0000000
[2,] 0.5689380 0.0000000
[3,] 0.4892650 0.0000000
[4,] 0.0000000 0.6471918
[5,] 0.0000000 0.6410611
[6,] 0.0000000 0.6296951

$paramMis
             [,1]         [,2]
[1,]  0.619492162  0.019913165
[2,]  0.568937971 -0.001291739
[3,]  0.489265006 -0.062756480
[4,]  0.073938169  0.647191811
[5,] -0.031930201  0.641061060
[6,] -0.003583977  0.629695066

$missRaw
             [,1]         [,2]
[1,]  0.000000000  0.019913165
[2,]  0.000000000 -0.001291739
[3,]  0.000000000 -0.062756480
[4,]  0.073938169  0.000000000
[5,] -0.031930201  0.000000000
[6,] -0.003583977  0.000000000

> 
> 
> 
> cleanEx()
> nameEx("SimMissing-class")
> ### * SimMissing-class
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: SimMissing-class
> ### Title: Class '"SimMissing"'
> ### Aliases: SimMissing-class summary,SimMissing-method
> ### Keywords: classes
> 
> ### ** Examples
> 
> misstemplate <- miss(pmMCAR=0.2)
> summary(misstemplate)
MISSING OBJECT
The method of missing data handling: Maximum Likelihood 
Covariates: none 
Ignored Variables: none 
Proportion of MCAR: 0.2 
> 
> 
> 
> cleanEx()
> nameEx("SimResult-class")
> ### * SimResult-class
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: SimResult-class
> ### Title: Class '"SimResult"': Simulation Result Object
> ### Aliases: SimResult-class summary,SimResult-method
> ###   summaryShort,SimResult-method
> ### Keywords: classes
> 
> ### ** Examples
> 
> showClass("SimResult")
Class "SimResult" [package "simsem"]

Slots:
                                                                       
Name:     modelType         nRep         coef           se          fit
Class:    character      numeric   data.frame   data.frame   data.frame
                                                                       
Name:     converged   paramValue misspecValue       popFit         FMI1
Class:       vector   data.frame   data.frame   data.frame   data.frame
                                                                       
Name:          FMI2      stdCoef         seed            n         nobs
Class:   data.frame   data.frame      numeric       vector   data.frame
                                                                       
Name:        pmMCAR        pmMAR     extraOut    paramOnly       timing
Class:       vector       vector         list      logical         list
> loading <- matrix(0, 6, 1)
> loading[1:6, 1] <- NA
> LY <- bind(loading, 0.7)
> RPS <- binds(diag(1))
> RTE <- binds(diag(6))
> CFA.Model <- model(LY = LY, RPS = RPS, RTE = RTE, modelType="CFA")
> 
> # We make the examples running only 5 replications to save time.
> # In reality, more replications are needed.
> Output <- sim(5, n=500, CFA.Model)
Loading required package: parallel
> 
> # Summary the simulation result
> summary(Output)
RESULT OBJECT
Model Type
[1] "cfa"
========= Fit Indices Cutoffs ============
           Alpha
Fit Indices      0.1     0.05     0.01    0.001     Mean     SD
      chisq   13.007   14.312   15.357   15.592    8.442  4.587
      aic   7494.181 7494.820 7495.332 7495.447 7438.781 64.987
      bic   7570.044 7570.683 7571.194 7571.310 7514.644 64.987
      rmsea    0.025    0.032    0.037    0.038    0.009  0.017
      cfi      0.996    0.995    0.994    0.994    0.999  0.003
      tli      0.994    0.992    0.991    0.990    1.001  0.007
      srmr     0.015    0.015    0.016    0.016    0.012  0.003
========= Parameter Estimates and Standard Errors ============
       Estimate.Average Estimate.SD Average.SE Power..Not.equal.0. Std.Est
f1=~y1            0.694       0.018      0.042                   1   0.700
f1=~y2            0.664       0.050      0.042                   1   0.675
f1=~y3            0.653       0.046      0.041                   1   0.671
f1=~y4            0.675       0.057      0.041                   1   0.688
f1=~y5            0.695       0.078      0.041                   1   0.702
f1=~y6            0.699       0.053      0.042                   1   0.702
y1~~y1            0.501       0.033      0.039                   1   0.509
y2~~y2            0.525       0.012      0.039                   1   0.544
y3~~y3            0.518       0.060      0.039                   1   0.548
y4~~y4            0.504       0.046      0.038                   1   0.525
y5~~y5            0.492       0.018      0.038                   1   0.507
y6~~y6            0.500       0.048      0.039                   1   0.506
y1~1             -0.009       0.058      0.044                   0  -0.009
y2~1             -0.010       0.038      0.044                   0  -0.010
y3~1             -0.048       0.019      0.043                   0  -0.049
y4~1             -0.030       0.054      0.044                   0  -0.031
y5~1             -0.025       0.036      0.044                   0  -0.024
y6~1              0.005       0.042      0.044                   0   0.005
       Std.Est.SD Average.Param Average.Bias Coverage
f1=~y1      0.016          0.70       -0.006      1.0
f1=~y2      0.024          0.70       -0.036      1.0
f1=~y3      0.043          0.70       -0.047      0.8
f1=~y4      0.042          0.70       -0.025      1.0
f1=~y5      0.034          0.70       -0.005      0.8
f1=~y6      0.022          0.70       -0.001      0.8
y1~~y1      0.022          0.51       -0.009      1.0
y2~~y2      0.033          0.51        0.015      1.0
y3~~y3      0.058          0.51        0.008      0.6
y4~~y4      0.059          0.51       -0.006      1.0
y5~~y5      0.049          0.51       -0.018      1.0
y6~~y6      0.031          0.51       -0.010      1.0
y1~1        0.058          0.00       -0.009      1.0
y2~1        0.039          0.00       -0.010      1.0
y3~1        0.019          0.00       -0.048      1.0
y4~1        0.056          0.00       -0.030      1.0
y5~1        0.033          0.00       -0.025      1.0
y6~1        0.042          0.00        0.005      1.0
========= Correlation between Fit Indices ============
       chisq    aic    bic  rmsea    cfi    tli   srmr
chisq  1.000  0.119  0.119  0.904 -0.879 -0.996  0.938
aic    0.119  1.000  1.000  0.479 -0.487 -0.097 -0.143
bic    0.119  1.000  1.000  0.479 -0.487 -0.097 -0.143
rmsea  0.904  0.479  0.479  1.000 -0.995 -0.875  0.725
cfi   -0.879 -0.487 -0.487 -0.995  1.000  0.848 -0.677
tli   -0.996 -0.097 -0.097 -0.875  0.848  1.000 -0.943
srmr   0.938 -0.143 -0.143  0.725 -0.677 -0.943  1.000
================== Replications =====================
Number of replications = 5 
Number of converged replications = 5 
Number of nonconverged replications: 
   1. Nonconvergent Results = 0 
   2. Nonconvergent results from multiple imputation = 0 
   3. At least one SE were negative or NA = 0 
   4. At least one variance estimates were negative = 0 
   5. At least one correlation estimates were greater than 1 or less than -1 = 0 
> 
> # Short summary of the simulation result
> summaryShort(Output)
RESULT OBJECT
[1] "cfa"
Model Type: cfa 
Convergence 5 / 5 
Sample size: 500 
Percent Completely Missing at Random: 0 
Percent Missing at Random: 0 
========= Fit Indices Cutoffs ============
           Alpha
Fit Indices     0.05     Mean     SD
      chisq   14.312    8.442  4.587
      aic   7494.820 7438.781 64.987
      bic   7570.683 7514.644 64.987
      rmsea    0.032    0.009  0.017
      cfi      0.995    0.999  0.003
      tli      0.992    1.001  0.007
      srmr     0.015    0.012  0.003
> 
> # Find the fit index cutoff
> getCutoff(Output, 0.05)
       chisq     aic      bic      rmsea       cfi       tli       srmr
95% 14.31242 7494.82 7570.683 0.03157818 0.9953105 0.9921841 0.01544728
> 
> # Summary of parameter estimates
> summaryParam(Output)
       Estimate.Average Estimate.SD Average.SE Power..Not.equal.0.      Std.Est
f1=~y1      0.694043770  0.01781547 0.04163742                   1  0.700299596
f1=~y2      0.664032498  0.05004988 0.04174177                   1  0.674733152
f1=~y3      0.652742108  0.04602682 0.04134117                   1  0.671307416
f1=~y4      0.675329584  0.05666475 0.04140133                   1  0.687819804
f1=~y5      0.694838588  0.07836253 0.04143609                   1  0.701624723
f1=~y6      0.698589134  0.05338015 0.04167931                   1  0.702433747
y1~~y1      0.500730846  0.03285951 0.03855153                   1  0.509377930
y2~~y2      0.524743514  0.01245703 0.03927918                   1  0.544291157
y3~~y3      0.518102812  0.06014569 0.03861459                   1  0.547892722
y4~~y4      0.504363909  0.04566056 0.03830122                   1  0.525493316
y5~~y5      0.491558560  0.01803614 0.03810518                   1  0.506775777
y6~~y6      0.499749541  0.04761284 0.03854435                   1  0.506183431
y1~1       -0.008810148  0.05751387 0.04432595                   0 -0.009327775
y2~1       -0.009631695  0.03817582 0.04396553                   0 -0.009606366
y3~1       -0.048035069  0.01876568 0.04348083                   0 -0.049286225
y4~1       -0.030141352  0.05444905 0.04387118                   0 -0.030503564
y5~1       -0.025018328  0.03628409 0.04418667                   0 -0.023806731
y6~1        0.004855082  0.04243569 0.04444396                   0  0.004583798
       Std.Est.SD Average.Param Average.Bias Coverage
f1=~y1 0.01591170          0.70 -0.005956230      1.0
f1=~y2 0.02355888          0.70 -0.035967502      1.0
f1=~y3 0.04262673          0.70 -0.047257892      0.8
f1=~y4 0.04199108          0.70 -0.024670416      1.0
f1=~y5 0.03440514          0.70 -0.005161412      0.8
f1=~y6 0.02245549          0.70 -0.001410866      0.8
y1~~y1 0.02215388          0.51 -0.009269154      1.0
y2~~y2 0.03250012          0.51  0.014743514      1.0
y3~~y3 0.05770237          0.51  0.008102812      0.6
y4~~y4 0.05868259          0.51 -0.005636091      1.0
y5~~y5 0.04916697          0.51 -0.018441440      1.0
y6~~y6 0.03138416          0.51 -0.010250459      1.0
y1~1   0.05825793          0.00 -0.008810148      1.0
y2~1   0.03923871          0.00 -0.009631695      1.0
y3~1   0.01881353          0.00 -0.048035069      1.0
y4~1   0.05627538          0.00 -0.030141352      1.0
y5~1   0.03319385          0.00 -0.025018328      1.0
y6~1   0.04189960          0.00  0.004855082      1.0
> 
> # Summary of population parameters
> summaryPopulation(Output)
                 f1=~y1 f1=~y2 f1=~y3 f1=~y4 f1=~y5 f1=~y6 y1~~y1 y2~~y2 y3~~y3
Population Value 0.7    0.7    0.7    0.7    0.7    0.7    0.51   0.51   0.51  
                 y4~~y4 y5~~y5 y6~~y6 y1~1 y2~1 y3~1 y4~1 y5~1 y6~1
Population Value 0.51   0.51   0.51   0    0    0    0    0    0   
> 
> 
> 
> cleanEx()

detaching 'package:parallel'

> nameEx("SimSem-class")
> ### * SimSem-class
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: SimSem-class
> ### Title: Class '"SimSem"'
> ### Aliases: SimSem-class summary,SimSem-method
> 
> ### ** Examples
> 
> showClass("SimSem")
Class "SimSem" [package "simsem"]

Slots:
                                                        
Name:         pt      dgen modelType  groupLab       con
Class:      list      list character character      list
> 
> loading <- matrix(0, 6, 2)
> loading[1:3, 1] <- NA
> loading[4:6, 2] <- NA
> loadingValues <- matrix(0, 6, 2)
> loadingValues[1:3, 1] <- 0.7
> loadingValues[4:6, 2] <- 0.7
> LY <- bind(loading, loadingValues)
> summary(LY)
[1] "Random Full Matrix Object."
[1] "Free/Fixed Parameters:"
     [,1] [,2]
[1,]   NA    0
[2,]   NA    0
[3,]   NA    0
[4,]    0   NA
[5,]    0   NA
[6,]    0   NA
[1] "Population Parameters/Starting Values:"
     [,1]  [,2] 
[1,] "0.7" ""   
[2,] "0.7" ""   
[3,] "0.7" ""   
[4,] ""    "0.7"
[5,] ""    "0.7"
[6,] ""    "0.7"
[1] "Model misspecification"
     [,1]
[1,]  NaN
> 
> latent.cor <- matrix(NA, 2, 2)
> diag(latent.cor) <- 1
> RPS <- binds(latent.cor, 0.5)
> 
> # Error Correlation Object
> error.cor <- matrix(0, 6, 6)
> diag(error.cor) <- 1
> RTE <- binds(error.cor)
> 
> CFA.Model <- model(LY = LY, RPS = RPS, RTE = RTE, modelType="CFA")
> summary(CFA.Model)
Model Type
[1] "cfa"
========================Lavaan Analysis Model========================
   id lhs op rhs user group free ustart exo eq.id label unco
1   1  f1 =~  y1    0     1    1     NA   0     0          1
2   2  f1 =~  y2    0     1    2     NA   0     0          2
3   3  f1 =~  y3    0     1    3     NA   0     0          3
4   4  f1 =~  y4    0     1    0      0   0     0          0
5   5  f1 =~  y5    0     1    0      0   0     0          0
6   6  f1 =~  y6    0     1    0      0   0     0          0
7   7  f2 =~  y1    0     1    0      0   0     0          0
8   8  f2 =~  y2    0     1    0      0   0     0          0
9   9  f2 =~  y3    0     1    0      0   0     0          0
10 10  f2 =~  y4    0     1    4     NA   0     0          4
11 11  f2 =~  y5    0     1    5     NA   0     0          5
12 12  f2 =~  y6    0     1    6     NA   0     0          6
13 13  f1 ~~  f1    0     1    0      1   0     0          0
14 14  f1 ~~  f2    0     1    7     NA   0     0          7
15 15  f2 ~~  f2    0     1    0      1   0     0          0
16 16  y1 ~~  y1    0     1    8     NA   0     0          8
17 17  y1 ~~  y2    0     1    0      0   0     0          0
18 18  y1 ~~  y3    0     1    0      0   0     0          0
19 19  y1 ~~  y4    0     1    0      0   0     0          0
20 20  y1 ~~  y5    0     1    0      0   0     0          0
21 21  y1 ~~  y6    0     1    0      0   0     0          0
22 22  y2 ~~  y2    0     1    9     NA   0     0          9
23 23  y2 ~~  y3    0     1    0      0   0     0          0
24 24  y2 ~~  y4    0     1    0      0   0     0          0
25 25  y2 ~~  y5    0     1    0      0   0     0          0
26 26  y2 ~~  y6    0     1    0      0   0     0          0
27 27  y3 ~~  y3    0     1   10     NA   0     0         10
28 28  y3 ~~  y4    0     1    0      0   0     0          0
29 29  y3 ~~  y5    0     1    0      0   0     0          0
30 30  y3 ~~  y6    0     1    0      0   0     0          0
31 31  y4 ~~  y4    0     1   11     NA   0     0         11
32 32  y4 ~~  y5    0     1    0      0   0     0          0
33 33  y4 ~~  y6    0     1    0      0   0     0          0
34 34  y5 ~~  y5    0     1   12     NA   0     0         12
35 35  y5 ~~  y6    0     1    0      0   0     0          0
36 36  y6 ~~  y6    0     1   13     NA   0     0         13
37 37  f1 ~1        0     1    0      0   0     0          0
38 38  f2 ~1        0     1    0      0   0     0          0
39 39  y1 ~1        0     1   14     NA   0     0         14
40 40  y2 ~1        0     1   15     NA   0     0         15
41 41  y3 ~1        0     1   16     NA   0     0         16
42 42  y4 ~1        0     1   17     NA   0     0         17
43 43  y5 ~1        0     1   18     NA   0     0         18
44 44  y6 ~1        0     1   19     NA   0     0         19
========================Data Generation Template========================
-------- Group 1 --------

LY: Loading of Indicator.Y on Factor.ETA 
     [,1]     [,2]    
[1,] "NA:0.7" "0"     
[2,] "NA:0.7" "0"     
[3,] "NA:0.7" "0"     
[4,] "0"      "NA:0.7"
[5,] "0"      "NA:0.7"
[6,] "0"      "NA:0.7"

RTE: Correlation of Measurement.Error.EPSILON 
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    1    0    0    0    0    0
[2,]    0    1    0    0    0    0
[3,]    0    0    1    0    0    0
[4,]    0    0    0    1    0    0
[5,]    0    0    0    0    1    0
[6,]    0    0    0    0    0    1

VY: Variance of Indicator.Y 
[1] "NA:1" "NA:1" "NA:1" "NA:1" "NA:1" "NA:1"

TY: Measurement Intercept of Indicator.Y 
[1] "NA:0" "NA:0" "NA:0" "NA:0" "NA:0" "NA:0"

VPS: Variance of Regression.Residual.PSI 
[1] "1" "1"

RPS: Correlation of Regression.Residual.PSI 
     [,1]     [,2]    
[1,] "1"      "NA:0.5"
[2,] "NA:0.5" "1"     

VE: Variance of Factor.ETA 
[1] "1" "1"

AL: Regression Intercept of Factor.ETA 
[1] "0" "0"

ME: Mean of Factor.ETA 
[1] "0" "0"
-------------------------- 
> 
> 
> 
> cleanEx()
> nameEx("SimVector-class")
> ### * SimVector-class
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: SimVector-class
> ### Title: Vector object: Random parameters vector
> ### Aliases: SimVector-class summaryShort,SimVector-method
> ###   summary,SimVector-method
> ### Keywords: classes
> 
> ### ** Examples
> 
> showClass("SimVector")
Class "SimVector" [package "simsem"]

Slots:
                                 
Name:      free popParam  misspec
Class:   vector   vector   vector
> 
> factor.mean <- rep(NA, 2)
> factor.mean.starting <- c(5, 2)
> AL <- bind(factor.mean, factor.mean.starting)
> rawDraw(AL)
$param
[1] 5 2

$paramMis
[1] 5 2

$missRaw
[1] 0 0

> summary(AL)
[1] "Random Vector Object."
[1] "Free/Fixed Parameters:"
[1] NA NA
[1] "Population Parameters/Starting Values:"
[1] "5" "2"
[1] "Model misspecification"
logical(0)
> summaryShort(AL)
[1] "NA:5" "NA:2"
> 
> 
> 
> cleanEx()
> nameEx("analyze")
> ### * analyze
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: analyze
> ### Title: Data analysis using the model specification
> ### Aliases: analyze
> 
> ### ** Examples
> 
> loading <- matrix(0, 6, 2)
> loading[1:3, 1] <- NA
> loading[4:6, 2] <- NA
> LY <- bind(loading, 0.7)
> 
> latent.cor <- matrix(NA, 2, 2)
> diag(latent.cor) <- 1
> RPS <- binds(latent.cor, 0.5)
> 
> RTE <- binds(diag(6))
> 
> VY <- bind(rep(NA,6),2)
> 
> CFA.Model <- model(LY = LY, RPS = RPS, RTE = RTE, modelType = "CFA")
> 
> dat <- generate(CFA.Model,200)
> out <- analyze(CFA.Model,dat)
> 
> 
> 
> cleanEx()
> nameEx("anova")
> ### * anova
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: anova
> ### Title: Provide a comparison of nested models and nonnested models
> ###   across replications
> ### Aliases: anova,SimResult-method
> 
> ### ** Examples
> 
> ## Not run: 
> ##D loading1 <- matrix(0, 6, 1)
> ##D loading1[1:6, 1] <- NA
> ##D loading2 <- loading1
> ##D loading2[6,1] <- 0
> ##D LY1 <- bind(loading1, 0.7)
> ##D LY2 <- bind(loading2, 0.7)
> ##D RPS <- binds(diag(1))
> ##D RTE <- binds(diag(6))
> ##D CFA.Model1 <- model(LY = LY1, RPS = RPS, RTE = RTE, modelType="CFA")
> ##D CFA.Model2 <- model(LY = LY2, RPS = RPS, RTE = RTE, modelType="CFA")
> ##D 
> ##D # We make the examples running only 5 replications to save time.
> ##D # In reality, more replications are needed.
> ##D # Need to make sure that both simResult calls have the same seed!
> ##D Output1 <- sim(5, n=500, model=CFA.Model1, generate=CFA.Model1, seed=123567)
> ##D Output2 <- sim(5, n=500, model=CFA.Model2, generate=CFA.Model1, seed=123567)
> ##D anova(Output1, Output2)
> ##D 
> ##D # The example when the sample size is varying
> ##D Output1b <- sim(NULL, n=seq(50, 500, 50), model=CFA.Model1, generate=CFA.Model1, seed=123567)
> ##D Output2b <- sim(NULL, n=seq(50, 500, 50), model=CFA.Model2, generate=CFA.Model1, seed=123567)
> ##D anova(Output1b, Output2b)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("bind")
> ### * bind
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: bind
> ### Title: Specify matrices for Monte Carlo simulation of structural
> ###   equation models
> ### Aliases: bind binds
> 
> ### ** Examples
> 
> loading <- matrix(0, 6, 2)
> loading[1:3, 1] <- NA
> loading[4:6, 2] <- NA
> loadingValues <- matrix(0, 6, 2)
> loadingValues[1:3, 1] <- 0.7
> loadingValues[4:6, 2] <- 0.7
> LY <- bind(loading, loadingValues)
> summary(LY)
[1] "Random Full Matrix Object."
[1] "Free/Fixed Parameters:"
     [,1] [,2]
[1,]   NA    0
[2,]   NA    0
[3,]   NA    0
[4,]    0   NA
[5,]    0   NA
[6,]    0   NA
[1] "Population Parameters/Starting Values:"
     [,1]  [,2] 
[1,] "0.7" ""   
[2,] "0.7" ""   
[3,] "0.7" ""   
[4,] ""    "0.7"
[5,] ""    "0.7"
[6,] ""    "0.7"
[1] "Model misspecification"
     [,1]
[1,]  NaN
> 
> # Set both factor correlations to .05
> latent.cor <- matrix(NA, 2, 2)
> diag(latent.cor) <- 1
> RPS <- binds(latent.cor, 0.5)
> 
> # Misspecify all error covarainces
> error.cor <- matrix(0, 6, 6)
> diag(error.cor) <- NA
> RTE <- binds(error.cor,1,"runif(1,-.05,.05)")
> 
> 
> 
> cleanEx()
> nameEx("bindDist")
> ### * bindDist
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: bindDist
> ### Title: Create a data distribution object.
> ### Aliases: bindDist
> 
> ### ** Examples
> 
> library(copula)
> 
> # Create three-dimensional distribution by gaussian copula with 
> # the following marginal distributions
> #   1. t-distribution with df = 2
> # 	2. chi-square distribution with df = 3
> #	3. normal distribution with mean = 0 and sd = 1
> 
> # Setting the attribute of each marginal distribution
> d1 <- list(df=2)
> d2 <- list(df=3)
> d3 <- list(mean=0, sd=1)
> 
> # Create a data distribution object by setting the names of each distribution
> # and their arguments
> dist <- bindDist(c("t", "chisq", "norm"), d1, d2, d3)
> 
> # Create data by using Gumbel Copula as the multivariate distribution
> dist <- bindDist(c("t", "chisq", "norm"), d1, d2, d3, copula = gumbelCopula(2, dim = 3))
> 
> # Reverse the direction of chi-square distribution from positively skew to negatively skew
> dist <- bindDist(c("t", "chisq", "norm"), d1, d2, d3, copula = gumbelCopula(2, dim = 3),
+ 	reverse = c(FALSE, TRUE, FALSE))
> 
> 
> 
> cleanEx()
> nameEx("continuousPower")
> ### * continuousPower
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: continuousPower
> ### Title: Find power of model parameters when simulations have randomly
> ###   varying parameters
> ### Aliases: continuousPower
> 
> ### ** Examples
> 
> ## Not run: 
> ##D # Specify Sample Size by n
> ##D loading <- matrix(0, 6, 1)
> ##D loading[1:6, 1] <- NA
> ##D LY <- bind(loading, 0.7)
> ##D RPS <- binds(diag(1))
> ##D RTE <- binds(diag(6))
> ##D CFA.Model <- model(LY = LY, RPS = RPS, RTE = RTE, modelType="CFA")
> ##D dat <- generate(CFA.Model, 50)
> ##D out <- analyze(CFA.Model, dat)
> ##D 
> ##D # Specify both continuous sample size and percent missing completely at random. Note that more fine-grained 
> ##D # values of n and pmMCAR is needed, e.g., n=seq(50, 500, 1) and pmMCAR=seq(0, 0.2, 0.01)
> ##D Output <- sim(NULL, CFA.Model, n=seq(100, 200, 20), pmMCAR=c(0, 0.1, 0.2))
> ##D summary(Output)
> ##D 
> ##D # Find the power of all combinations of different sample size and percent MCAR missing
> ##D Cpow <- continuousPower(Output, contN = TRUE, contMCAR = TRUE)
> ##D Cpow
> ##D 
> ##D # Find the power of parameter estimates when sample size is 200 and percent MCAR missing is 0.3
> ##D Cpow2 <- continuousPower(Output, contN = TRUE, contMCAR = TRUE, pred=list(N = 200, pmMCAR = 0.3))
> ##D Cpow2
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("createData")
> ### * createData
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: createData
> ### Title: Create data from a set of drawn parameters.
> ### Aliases: createData
> 
> ### ** Examples
> 
> loading <- matrix(0, 6, 2)
> loading[1:3, 1] <- NA
> loading[4:6, 2] <- NA
> LY <- bind(loading, 0.7)
> 
> latent.cor <- matrix(NA, 2, 2)
> diag(latent.cor) <- 1
> RPS <- binds(latent.cor, 0.5)
> 
> RTE <- binds(diag(6))
> 
> VY <- bind(rep(NA,6),2)
> 
> CFA.Model <- model(LY = LY, RPS = RPS, RTE = RTE, modelType = "CFA")
> 
> # Draw a parameter set for data generation.
> param <- draw(CFA.Model)
> 
> # Generate data from the first group in the paramList.
> dat <- createData(param[[1]], n = 200) 
> 
> 
> 
> cleanEx()
> nameEx("draw")
> ### * draw
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: draw
> ### Title: Draw parameters from a 'SimSem' object.
> ### Aliases: draw
> 
> ### ** Examples
> 
> loading <- matrix(0, 6, 2)
> loading[1:3, 1] <- NA
> loading[4:6, 2] <- NA
> LY <- bind(loading, 0.7)
> 
> latent.cor <- matrix(NA, 2, 2)
> diag(latent.cor) <- 1
> RPS <- binds(latent.cor, 0.5)
> 
> RTE <- binds(diag(6))
> 
> VY <- bind(rep(NA,6),2)
> 
> CFA.Model <- model(LY = LY, RPS = RPS, RTE = RTE, modelType = "CFA")
> 
> # Draw a parameter set for data generation.
> param <- draw(CFA.Model)
> 
> # Example of Multiple Group Model with Weak Invariance
> 
> loading.in <- matrix(0, 6, 2)
> loading.in[1:3, 1] <- c("load1", "load2", "load3")
> loading.in[4:6, 2] <- c("load4", "load5", "load6")
> mis <- matrix(0,6,2)
> mis[loading.in == "0"] <- "runif(1, -0.1, 0.1)"
> LY.in <- bind(loading.in, "runif(1, 0.7, 0.8)", mis)
> 
> latent.cor <- matrix(NA, 2, 2)
> diag(latent.cor) <- 1
> RPS <- binds(latent.cor, 0.5)
> 
> RTE <- binds(diag(6))
> 
> VTE <- bind(rep(NA, 6), 0.51)
> 
> VPS1 <- bind(rep(1, 2))
> 
> VPS2 <- bind(rep(NA, 2), c(1.1, 1.2))
> 
> # Inequality constraint
> script <- "
+ sth := load1 + load2 + load3
+ load4 == (load5 + load6) / 2
+ load4 > 0
+ load5 > 0
+ sth2 := load1 - load2
+ "
> 
> # Model Template
> weak <- model(LY = LY.in, RPS = RPS, VPS=list(VPS1, VPS2), RTE = RTE, VTE=VTE, ngroups=2, modelType = "CFA", con=script)
> 
> # Constraint --> Misspecification --> Fill Parameters
> draw(weak, createOrder=c(1, 2, 3))
[[1]]
[[1]]$param
[[1]]$param$PS
     [,1] [,2]
[1,]  1.0  0.5
[2,]  0.5  1.0

[[1]]$param$BE
NULL

[[1]]$param$AL
[1] 0 0

[[1]]$param$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[1]]$param$LY
          [,1]      [,2]
[1,] 0.7660798 0.0000000
[2,] 0.7629114 0.0000000
[3,] 0.7061786 0.0000000
[4,] 0.0000000 0.7685971
[5,] 0.0000000 0.7991906
[6,] 0.0000000 0.7380035

[[1]]$param$TY
[1] 0 0 0 0 0 0

[[1]]$param$GA
NULL

[[1]]$param$KA
NULL


[[1]]$misspec
[[1]]$misspec$PS
     [,1] [,2]
[1,]  1.0  0.5
[2,]  0.5  1.0

[[1]]$misspec$BE
NULL

[[1]]$misspec$AL
[1] 0 0

[[1]]$misspec$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[1]]$misspec$LY
            [,1]          [,2]
[1,]  0.76607978 -0.0231792564
[2,]  0.76291140  0.0539682840
[3,]  0.70617863 -0.0004601516
[4,] -0.05880509  0.7685970637
[5,] -0.06468865  0.7991906095
[6,]  0.03740457  0.7380035179

[[1]]$misspec$TY
[1] 0 0 0 0 0 0

[[1]]$misspec$GA
NULL

[[1]]$misspec$KA
NULL


[[1]]$misOnly
[[1]]$misOnly$LY
            [,1]          [,2]
[1,]  0.00000000 -0.0231792564
[2,]  0.00000000  0.0539682840
[3,]  0.00000000 -0.0004601516
[4,] -0.05880509  0.0000000000
[5,] -0.06468865  0.0000000000
[6,]  0.03740457  0.0000000000

[[1]]$misOnly$PS
NULL

[[1]]$misOnly$RPS
     [,1] [,2]
[1,]    0    0
[2,]    0    0

[[1]]$misOnly$TE
NULL

[[1]]$misOnly$RTE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    0    0    0    0    0    0
[2,]    0    0    0    0    0    0
[3,]    0    0    0    0    0    0
[4,]    0    0    0    0    0    0
[5,]    0    0    0    0    0    0
[6,]    0    0    0    0    0    0

[[1]]$misOnly$BE
NULL

[[1]]$misOnly$VTE
[1] 0 0 0 0 0 0

[[1]]$misOnly$VY
NULL

[[1]]$misOnly$VPS
[1] 0 0

[[1]]$misOnly$VE
[1] 0 0

[[1]]$misOnly$TY
[1] 0 0 0 0 0 0

[[1]]$misOnly$AL
[1] 0 0

[[1]]$misOnly$MY
NULL

[[1]]$misOnly$ME
[1] 0 0

[[1]]$misOnly$KA
NULL

[[1]]$misOnly$GA
NULL



[[2]]
[[2]]$param
[[2]]$param$PS
          [,1]      [,2]
[1,] 1.1000000 0.5744563
[2,] 0.5744563 1.2000000

[[2]]$param$BE
NULL

[[2]]$param$AL
[1] 0 0

[[2]]$param$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[2]]$param$LY
          [,1]      [,2]
[1,] 0.7660798 0.0000000
[2,] 0.7629114 0.0000000
[3,] 0.7061786 0.0000000
[4,] 0.0000000 0.7685971
[5,] 0.0000000 0.7991906
[6,] 0.0000000 0.7380035

[[2]]$param$TY
[1] 0 0 0 0 0 0

[[2]]$param$GA
NULL

[[2]]$param$KA
NULL


[[2]]$misspec
[[2]]$misspec$PS
          [,1]      [,2]
[1,] 1.1000000 0.5744563
[2,] 0.5744563 1.2000000

[[2]]$misspec$BE
NULL

[[2]]$misspec$AL
[1] 0 0

[[2]]$misspec$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[2]]$misspec$LY
            [,1]        [,2]
[1,]  0.76607978 -0.02277718
[2,]  0.76291140 -0.09732193
[3,]  0.70617863 -0.02352241
[4,]  0.03033475  0.76859706
[5,] -0.07488898  0.79919061
[6,] -0.04655587  0.73800352

[[2]]$misspec$TY
[1] 0 0 0 0 0 0

[[2]]$misspec$GA
NULL

[[2]]$misspec$KA
NULL


[[2]]$misOnly
[[2]]$misOnly$LY
            [,1]        [,2]
[1,]  0.00000000 -0.02277718
[2,]  0.00000000 -0.09732193
[3,]  0.00000000 -0.02352241
[4,]  0.03033475  0.00000000
[5,] -0.07488898  0.00000000
[6,] -0.04655587  0.00000000

[[2]]$misOnly$PS
NULL

[[2]]$misOnly$RPS
     [,1] [,2]
[1,]    0    0
[2,]    0    0

[[2]]$misOnly$TE
NULL

[[2]]$misOnly$RTE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    0    0    0    0    0    0
[2,]    0    0    0    0    0    0
[3,]    0    0    0    0    0    0
[4,]    0    0    0    0    0    0
[5,]    0    0    0    0    0    0
[6,]    0    0    0    0    0    0

[[2]]$misOnly$BE
NULL

[[2]]$misOnly$VTE
[1] 0 0 0 0 0 0

[[2]]$misOnly$VY
NULL

[[2]]$misOnly$VPS
[1] 0 0

[[2]]$misOnly$VE
[1] 0 0

[[2]]$misOnly$TY
[1] 0 0 0 0 0 0

[[2]]$misOnly$AL
[1] 0 0

[[2]]$misOnly$MY
NULL

[[2]]$misOnly$ME
[1] 0 0

[[2]]$misOnly$KA
NULL

[[2]]$misOnly$GA
NULL



> 
> # Constraint --> Fill Parameters --> Misspecification 
> draw(weak, createOrder=c(1, 3, 2))
[[1]]
[[1]]$param
[[1]]$param$PS
     [,1] [,2]
[1,]  1.0  0.5
[2,]  0.5  1.0

[[1]]$param$BE
NULL

[[1]]$param$AL
[1] 0 0

[[1]]$param$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[1]]$param$LY
          [,1]      [,2]
[1,] 0.7599566 0.0000000
[2,] 0.7493541 0.0000000
[3,] 0.7186218 0.0000000
[4,] 0.0000000 0.7714996
[5,] 0.0000000 0.7647060
[6,] 0.0000000 0.7782933

[[1]]$param$TY
[1] 0 0 0 0 0 0

[[1]]$param$GA
NULL

[[1]]$param$KA
NULL


[[1]]$misspec
[[1]]$misspec$PS
     [,1] [,2]
[1,]  1.0  0.5
[2,]  0.5  1.0

[[1]]$misspec$BE
NULL

[[1]]$misspec$AL
[1] 0 0

[[1]]$misspec$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[1]]$misspec$LY
           [,1]        [,2]
[1,] 0.75995658 -0.07841127
[2,] 0.74935413  0.04474219
[3,] 0.71862176 -0.01774511
[4,] 0.06547466  0.77149965
[5,] 0.03369335  0.76470602
[6,] 0.05884797  0.77829328

[[1]]$misspec$TY
[1] 0 0 0 0 0 0

[[1]]$misspec$GA
NULL

[[1]]$misspec$KA
NULL


[[1]]$misOnly
[[1]]$misOnly$LY
           [,1]        [,2]
[1,] 0.00000000 -0.07841127
[2,] 0.00000000  0.04474219
[3,] 0.00000000 -0.01774511
[4,] 0.06547466  0.00000000
[5,] 0.03369335  0.00000000
[6,] 0.05884797  0.00000000

[[1]]$misOnly$PS
NULL

[[1]]$misOnly$RPS
     [,1] [,2]
[1,]    0    0
[2,]    0    0

[[1]]$misOnly$TE
NULL

[[1]]$misOnly$RTE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    0    0    0    0    0    0
[2,]    0    0    0    0    0    0
[3,]    0    0    0    0    0    0
[4,]    0    0    0    0    0    0
[5,]    0    0    0    0    0    0
[6,]    0    0    0    0    0    0

[[1]]$misOnly$BE
NULL

[[1]]$misOnly$VTE
[1] 0 0 0 0 0 0

[[1]]$misOnly$VY
NULL

[[1]]$misOnly$VPS
[1] 0 0

[[1]]$misOnly$VE
[1] 0 0

[[1]]$misOnly$TY
[1] 0 0 0 0 0 0

[[1]]$misOnly$AL
[1] 0 0

[[1]]$misOnly$MY
NULL

[[1]]$misOnly$ME
[1] 0 0

[[1]]$misOnly$KA
NULL

[[1]]$misOnly$GA
NULL



[[2]]
[[2]]$param
[[2]]$param$PS
          [,1]      [,2]
[1,] 1.1000000 0.5744563
[2,] 0.5744563 1.2000000

[[2]]$param$BE
NULL

[[2]]$param$AL
[1] 0 0

[[2]]$param$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[2]]$param$LY
          [,1]      [,2]
[1,] 0.7599566 0.0000000
[2,] 0.7493541 0.0000000
[3,] 0.7186218 0.0000000
[4,] 0.0000000 0.7714996
[5,] 0.0000000 0.7647060
[6,] 0.0000000 0.7782933

[[2]]$param$TY
[1] 0 0 0 0 0 0

[[2]]$param$GA
NULL

[[2]]$param$KA
NULL


[[2]]$misspec
[[2]]$misspec$PS
          [,1]      [,2]
[1,] 1.1000000 0.5744563
[2,] 0.5744563 1.2000000

[[2]]$misspec$BE
NULL

[[2]]$misspec$AL
[1] 0 0

[[2]]$misspec$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[2]]$misspec$LY
             [,1]         [,2]
[1,]  0.759956583  0.038546311
[2,]  0.749354131 -0.004476076
[3,]  0.718621760  0.072241895
[4,] -0.095333760  0.771499648
[5,] -0.004553987  0.764706019
[6,]  0.046462748  0.778293276

[[2]]$misspec$TY
[1] 0 0 0 0 0 0

[[2]]$misspec$GA
NULL

[[2]]$misspec$KA
NULL


[[2]]$misOnly
[[2]]$misOnly$LY
             [,1]         [,2]
[1,]  0.000000000  0.038546311
[2,]  0.000000000 -0.004476076
[3,]  0.000000000  0.072241895
[4,] -0.095333760  0.000000000
[5,] -0.004553987  0.000000000
[6,]  0.046462748  0.000000000

[[2]]$misOnly$PS
NULL

[[2]]$misOnly$RPS
     [,1] [,2]
[1,]    0    0
[2,]    0    0

[[2]]$misOnly$TE
NULL

[[2]]$misOnly$RTE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    0    0    0    0    0    0
[2,]    0    0    0    0    0    0
[3,]    0    0    0    0    0    0
[4,]    0    0    0    0    0    0
[5,]    0    0    0    0    0    0
[6,]    0    0    0    0    0    0

[[2]]$misOnly$BE
NULL

[[2]]$misOnly$VTE
[1] 0 0 0 0 0 0

[[2]]$misOnly$VY
NULL

[[2]]$misOnly$VPS
[1] 0 0

[[2]]$misOnly$VE
[1] 0 0

[[2]]$misOnly$TY
[1] 0 0 0 0 0 0

[[2]]$misOnly$AL
[1] 0 0

[[2]]$misOnly$MY
NULL

[[2]]$misOnly$ME
[1] 0 0

[[2]]$misOnly$KA
NULL

[[2]]$misOnly$GA
NULL



> 
> # Misspecification --> Constraint --> Fill Parameters
> draw(weak, createOrder=c(2, 1, 3))
[[1]]
[[1]]$param
[[1]]$param$PS
     [,1] [,2]
[1,]  1.0  0.5
[2,]  0.5  1.0

[[1]]$param$BE
NULL

[[1]]$param$AL
[1] 0 0

[[1]]$param$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[1]]$param$LY
          [,1]      [,2]
[1,] 0.7099466 0.0000000
[2,] 0.7316272 0.0000000
[3,] 0.7518634 0.0000000
[4,] 0.0000000 0.7368281
[5,] 0.0000000 0.7258017
[6,] 0.0000000 0.7478545

[[1]]$param$TY
[1] 0 0 0 0 0 0

[[1]]$param$GA
NULL

[[1]]$param$KA
NULL


[[1]]$misspec
[[1]]$misspec$PS
     [,1] [,2]
[1,]  1.0  0.5
[2,]  0.5  1.0

[[1]]$misspec$BE
NULL

[[1]]$misspec$AL
[1] 0 0

[[1]]$misspec$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[1]]$misspec$LY
            [,1]         [,2]
[1,]  0.70994662 -0.041279325
[2,]  0.73162717 -0.008186855
[3,]  0.75186343 -0.033521065
[4,]  0.03240102  0.736828101
[5,] -0.01863396  0.725801678
[6,]  0.08257518  0.747854525

[[1]]$misspec$TY
[1] 0 0 0 0 0 0

[[1]]$misspec$GA
NULL

[[1]]$misspec$KA
NULL


[[1]]$misOnly
[[1]]$misOnly$LY
            [,1]         [,2]
[1,]  0.00000000 -0.041279325
[2,]  0.00000000 -0.008186855
[3,]  0.00000000 -0.033521065
[4,]  0.03240102  0.000000000
[5,] -0.01863396  0.000000000
[6,]  0.08257518  0.000000000

[[1]]$misOnly$PS
NULL

[[1]]$misOnly$RPS
     [,1] [,2]
[1,]    0    0
[2,]    0    0

[[1]]$misOnly$TE
NULL

[[1]]$misOnly$RTE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    0    0    0    0    0    0
[2,]    0    0    0    0    0    0
[3,]    0    0    0    0    0    0
[4,]    0    0    0    0    0    0
[5,]    0    0    0    0    0    0
[6,]    0    0    0    0    0    0

[[1]]$misOnly$BE
NULL

[[1]]$misOnly$VTE
[1] 0 0 0 0 0 0

[[1]]$misOnly$VY
NULL

[[1]]$misOnly$VPS
[1] 0 0

[[1]]$misOnly$VE
[1] 0 0

[[1]]$misOnly$TY
[1] 0 0 0 0 0 0

[[1]]$misOnly$AL
[1] 0 0

[[1]]$misOnly$MY
NULL

[[1]]$misOnly$ME
[1] 0 0

[[1]]$misOnly$KA
NULL

[[1]]$misOnly$GA
NULL



[[2]]
[[2]]$param
[[2]]$param$PS
          [,1]      [,2]
[1,] 1.1000000 0.5744563
[2,] 0.5744563 1.2000000

[[2]]$param$BE
NULL

[[2]]$param$AL
[1] 0 0

[[2]]$param$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[2]]$param$LY
          [,1]      [,2]
[1,] 0.7099466 0.0000000
[2,] 0.7316272 0.0000000
[3,] 0.7518634 0.0000000
[4,] 0.0000000 0.7368281
[5,] 0.0000000 0.7258017
[6,] 0.0000000 0.7478545

[[2]]$param$TY
[1] 0 0 0 0 0 0

[[2]]$param$GA
NULL

[[2]]$param$KA
NULL


[[2]]$misspec
[[2]]$misspec$PS
          [,1]      [,2]
[1,] 1.1000000 0.5744563
[2,] 0.5744563 1.2000000

[[2]]$misspec$BE
NULL

[[2]]$misspec$AL
[1] 0 0

[[2]]$misspec$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[2]]$misspec$LY
            [,1]         [,2]
[1,]  0.70994662 -0.033245014
[2,]  0.73162717 -0.004729751
[3,]  0.75186343  0.078439667
[4,] -0.03218541  0.736828101
[5,]  0.06788807  0.725801678
[6,] -0.03066330  0.747854525

[[2]]$misspec$TY
[1] 0 0 0 0 0 0

[[2]]$misspec$GA
NULL

[[2]]$misspec$KA
NULL


[[2]]$misOnly
[[2]]$misOnly$LY
            [,1]         [,2]
[1,]  0.00000000 -0.033245014
[2,]  0.00000000 -0.004729751
[3,]  0.00000000  0.078439667
[4,] -0.03218541  0.000000000
[5,]  0.06788807  0.000000000
[6,] -0.03066330  0.000000000

[[2]]$misOnly$PS
NULL

[[2]]$misOnly$RPS
     [,1] [,2]
[1,]    0    0
[2,]    0    0

[[2]]$misOnly$TE
NULL

[[2]]$misOnly$RTE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    0    0    0    0    0    0
[2,]    0    0    0    0    0    0
[3,]    0    0    0    0    0    0
[4,]    0    0    0    0    0    0
[5,]    0    0    0    0    0    0
[6,]    0    0    0    0    0    0

[[2]]$misOnly$BE
NULL

[[2]]$misOnly$VTE
[1] 0 0 0 0 0 0

[[2]]$misOnly$VY
NULL

[[2]]$misOnly$VPS
[1] 0 0

[[2]]$misOnly$VE
[1] 0 0

[[2]]$misOnly$TY
[1] 0 0 0 0 0 0

[[2]]$misOnly$AL
[1] 0 0

[[2]]$misOnly$MY
NULL

[[2]]$misOnly$ME
[1] 0 0

[[2]]$misOnly$KA
NULL

[[2]]$misOnly$GA
NULL



> 
> # Misspecification --> Fill Parameters --> Constraint
> draw(weak, createOrder=c(2, 3, 1))
[[1]]
[[1]]$param
[[1]]$param$PS
     [,1] [,2]
[1,]  1.0  0.5
[2,]  0.5  1.0

[[1]]$param$BE
NULL

[[1]]$param$AL
[1] 0 0

[[1]]$param$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[1]]$param$LY
          [,1]      [,2]
[1,] 0.7960618 0.0000000
[2,] 0.7434659 0.0000000
[3,] 0.7712515 0.0000000
[4,] 0.0000000 0.7191467
[5,] 0.0000000 0.7143304
[6,] 0.0000000 0.7239629

[[1]]$param$TY
[1] 0 0 0 0 0 0

[[1]]$param$GA
NULL

[[1]]$param$KA
NULL


[[1]]$misspec
[[1]]$misspec$PS
     [,1] [,2]
[1,]  1.0  0.5
[2,]  0.5  1.0

[[1]]$misspec$BE
NULL

[[1]]$misspec$AL
[1] 0 0

[[1]]$misspec$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[1]]$misspec$LY
            [,1]        [,2]
[1,]  0.79606180 -0.05946155
[2,]  0.74346595  0.04222424
[3,]  0.77125147 -0.07566162
[4,] -0.02000113  0.71914669
[5,] -0.03492957  0.71433044
[6,]  0.05141743  0.72396294

[[1]]$misspec$TY
[1] 0 0 0 0 0 0

[[1]]$misspec$GA
NULL

[[1]]$misspec$KA
NULL


[[1]]$misOnly
[[1]]$misOnly$LY
            [,1]        [,2]
[1,]  0.00000000 -0.05946155
[2,]  0.00000000  0.04222424
[3,]  0.00000000 -0.07566162
[4,] -0.02000113  0.00000000
[5,] -0.03492957  0.00000000
[6,]  0.05141743  0.00000000

[[1]]$misOnly$PS
NULL

[[1]]$misOnly$RPS
     [,1] [,2]
[1,]    0    0
[2,]    0    0

[[1]]$misOnly$TE
NULL

[[1]]$misOnly$RTE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    0    0    0    0    0    0
[2,]    0    0    0    0    0    0
[3,]    0    0    0    0    0    0
[4,]    0    0    0    0    0    0
[5,]    0    0    0    0    0    0
[6,]    0    0    0    0    0    0

[[1]]$misOnly$BE
NULL

[[1]]$misOnly$VTE
[1] 0 0 0 0 0 0

[[1]]$misOnly$VY
NULL

[[1]]$misOnly$VPS
[1] 0 0

[[1]]$misOnly$VE
[1] 0 0

[[1]]$misOnly$TY
[1] 0 0 0 0 0 0

[[1]]$misOnly$AL
[1] 0 0

[[1]]$misOnly$MY
NULL

[[1]]$misOnly$ME
[1] 0 0

[[1]]$misOnly$KA
NULL

[[1]]$misOnly$GA
NULL



[[2]]
[[2]]$param
[[2]]$param$PS
          [,1]      [,2]
[1,] 1.1000000 0.5744563
[2,] 0.5744563 1.2000000

[[2]]$param$BE
NULL

[[2]]$param$AL
[1] 0 0

[[2]]$param$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[2]]$param$LY
          [,1]      [,2]
[1,] 0.7960618 0.0000000
[2,] 0.7434659 0.0000000
[3,] 0.7712515 0.0000000
[4,] 0.0000000 0.7191467
[5,] 0.0000000 0.7143304
[6,] 0.0000000 0.7239629

[[2]]$param$TY
[1] 0 0 0 0 0 0

[[2]]$param$GA
NULL

[[2]]$param$KA
NULL


[[2]]$misspec
[[2]]$misspec$PS
          [,1]      [,2]
[1,] 1.1000000 0.5744563
[2,] 0.5744563 1.2000000

[[2]]$misspec$BE
NULL

[[2]]$misspec$AL
[1] 0 0

[[2]]$misspec$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[2]]$misspec$LY
             [,1]        [,2]
[1,]  0.796061800 -0.01798318
[2,]  0.743465948  0.06217405
[3,]  0.771251468  0.02098666
[4,]  0.055782935  0.71914669
[5,]  0.059461765  0.71433044
[6,] -0.008945109  0.72396294

[[2]]$misspec$TY
[1] 0 0 0 0 0 0

[[2]]$misspec$GA
NULL

[[2]]$misspec$KA
NULL


[[2]]$misOnly
[[2]]$misOnly$LY
             [,1]        [,2]
[1,]  0.000000000 -0.01798318
[2,]  0.000000000  0.06217405
[3,]  0.000000000  0.02098666
[4,]  0.055782935  0.00000000
[5,]  0.059461765  0.00000000
[6,] -0.008945109  0.00000000

[[2]]$misOnly$PS
NULL

[[2]]$misOnly$RPS
     [,1] [,2]
[1,]    0    0
[2,]    0    0

[[2]]$misOnly$TE
NULL

[[2]]$misOnly$RTE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    0    0    0    0    0    0
[2,]    0    0    0    0    0    0
[3,]    0    0    0    0    0    0
[4,]    0    0    0    0    0    0
[5,]    0    0    0    0    0    0
[6,]    0    0    0    0    0    0

[[2]]$misOnly$BE
NULL

[[2]]$misOnly$VTE
[1] 0 0 0 0 0 0

[[2]]$misOnly$VY
NULL

[[2]]$misOnly$VPS
[1] 0 0

[[2]]$misOnly$VE
[1] 0 0

[[2]]$misOnly$TY
[1] 0 0 0 0 0 0

[[2]]$misOnly$AL
[1] 0 0

[[2]]$misOnly$MY
NULL

[[2]]$misOnly$ME
[1] 0 0

[[2]]$misOnly$KA
NULL

[[2]]$misOnly$GA
NULL



> 
> # Fill Parameters --> Constraint --> Misspecification
> draw(weak, createOrder=c(3, 1, 2))
[[1]]
[[1]]$param
[[1]]$param$PS
     [,1] [,2]
[1,]  1.0  0.5
[2,]  0.5  1.0

[[1]]$param$BE
NULL

[[1]]$param$AL
[1] 0 0

[[1]]$param$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[1]]$param$LY
          [,1]      [,2]
[1,] 0.7992684 0.0000000
[2,] 0.7633493 0.0000000
[3,] 0.7213208 0.0000000
[4,] 0.0000000 0.7289843
[5,] 0.0000000 0.7431474
[6,] 0.0000000 0.7148212

[[1]]$param$TY
[1] 0 0 0 0 0 0

[[1]]$param$GA
NULL

[[1]]$param$KA
NULL


[[1]]$misspec
[[1]]$misspec$PS
     [,1] [,2]
[1,]  1.0  0.5
[2,]  0.5  1.0

[[1]]$misspec$BE
NULL

[[1]]$misspec$AL
[1] 0 0

[[1]]$misspec$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[1]]$misspec$LY
             [,1]       [,2]
[1,]  0.799268406 0.01975219
[2,]  0.763349326 0.09523414
[3,]  0.721320814 0.04635850
[4,] -0.074125530 0.72898426
[5,] -0.004376393 0.74314737
[6,]  0.084814894 0.71482116

[[1]]$misspec$TY
[1] 0 0 0 0 0 0

[[1]]$misspec$GA
NULL

[[1]]$misspec$KA
NULL


[[1]]$misOnly
[[1]]$misOnly$LY
             [,1]       [,2]
[1,]  0.000000000 0.01975219
[2,]  0.000000000 0.09523414
[3,]  0.000000000 0.04635850
[4,] -0.074125530 0.00000000
[5,] -0.004376393 0.00000000
[6,]  0.084814894 0.00000000

[[1]]$misOnly$PS
NULL

[[1]]$misOnly$RPS
     [,1] [,2]
[1,]    0    0
[2,]    0    0

[[1]]$misOnly$TE
NULL

[[1]]$misOnly$RTE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    0    0    0    0    0    0
[2,]    0    0    0    0    0    0
[3,]    0    0    0    0    0    0
[4,]    0    0    0    0    0    0
[5,]    0    0    0    0    0    0
[6,]    0    0    0    0    0    0

[[1]]$misOnly$BE
NULL

[[1]]$misOnly$VTE
[1] 0 0 0 0 0 0

[[1]]$misOnly$VY
NULL

[[1]]$misOnly$VPS
[1] 0 0

[[1]]$misOnly$VE
[1] 0 0

[[1]]$misOnly$TY
[1] 0 0 0 0 0 0

[[1]]$misOnly$AL
[1] 0 0

[[1]]$misOnly$MY
NULL

[[1]]$misOnly$ME
[1] 0 0

[[1]]$misOnly$KA
NULL

[[1]]$misOnly$GA
NULL



[[2]]
[[2]]$param
[[2]]$param$PS
          [,1]      [,2]
[1,] 1.1000000 0.5744563
[2,] 0.5744563 1.2000000

[[2]]$param$BE
NULL

[[2]]$param$AL
[1] 0 0

[[2]]$param$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[2]]$param$LY
          [,1]      [,2]
[1,] 0.7992684 0.0000000
[2,] 0.7633493 0.0000000
[3,] 0.7213208 0.0000000
[4,] 0.0000000 0.7289843
[5,] 0.0000000 0.7431474
[6,] 0.0000000 0.7148212

[[2]]$param$TY
[1] 0 0 0 0 0 0

[[2]]$param$GA
NULL

[[2]]$param$KA
NULL


[[2]]$misspec
[[2]]$misspec$PS
          [,1]      [,2]
[1,] 1.1000000 0.5744563
[2,] 0.5744563 1.2000000

[[2]]$misspec$BE
NULL

[[2]]$misspec$AL
[1] 0 0

[[2]]$misspec$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[2]]$misspec$LY
            [,1]          [,2]
[1,]  0.79926841 -0.0008812844
[2,]  0.76334933 -0.0031300951
[3,]  0.72132081 -0.0653115330
[4,] -0.01074313  0.7289842626
[5,]  0.02802021  0.7431473691
[6,]  0.09836772  0.7148211561

[[2]]$misspec$TY
[1] 0 0 0 0 0 0

[[2]]$misspec$GA
NULL

[[2]]$misspec$KA
NULL


[[2]]$misOnly
[[2]]$misOnly$LY
            [,1]          [,2]
[1,]  0.00000000 -0.0008812844
[2,]  0.00000000 -0.0031300951
[3,]  0.00000000 -0.0653115330
[4,] -0.01074313  0.0000000000
[5,]  0.02802021  0.0000000000
[6,]  0.09836772  0.0000000000

[[2]]$misOnly$PS
NULL

[[2]]$misOnly$RPS
     [,1] [,2]
[1,]    0    0
[2,]    0    0

[[2]]$misOnly$TE
NULL

[[2]]$misOnly$RTE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    0    0    0    0    0    0
[2,]    0    0    0    0    0    0
[3,]    0    0    0    0    0    0
[4,]    0    0    0    0    0    0
[5,]    0    0    0    0    0    0
[6,]    0    0    0    0    0    0

[[2]]$misOnly$BE
NULL

[[2]]$misOnly$VTE
[1] 0 0 0 0 0 0

[[2]]$misOnly$VY
NULL

[[2]]$misOnly$VPS
[1] 0 0

[[2]]$misOnly$VE
[1] 0 0

[[2]]$misOnly$TY
[1] 0 0 0 0 0 0

[[2]]$misOnly$AL
[1] 0 0

[[2]]$misOnly$MY
NULL

[[2]]$misOnly$ME
[1] 0 0

[[2]]$misOnly$KA
NULL

[[2]]$misOnly$GA
NULL



> 
> # Fill Parameters --> Misspecification --> Constraint
> draw(weak, createOrder=c(3, 2, 1))
[[1]]
[[1]]$param
[[1]]$param$PS
     [,1] [,2]
[1,]  1.0  0.5
[2,]  0.5  1.0

[[1]]$param$BE
NULL

[[1]]$param$AL
[1] 0 0

[[1]]$param$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[1]]$param$LY
          [,1]      [,2]
[1,] 0.7207545 0.0000000
[2,] 0.7228658 0.0000000
[3,] 0.7595712 0.0000000
[4,] 0.0000000 0.7755561
[5,] 0.0000000 0.7526028
[6,] 0.0000000 0.7985095

[[1]]$param$TY
[1] 0 0 0 0 0 0

[[1]]$param$GA
NULL

[[1]]$param$KA
NULL


[[1]]$misspec
[[1]]$misspec$PS
     [,1] [,2]
[1,]  1.0  0.5
[2,]  0.5  1.0

[[1]]$misspec$BE
NULL

[[1]]$misspec$AL
[1] 0 0

[[1]]$misspec$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[1]]$misspec$LY
            [,1]       [,2]
[1,]  0.72075451 0.02855910
[2,]  0.72286581 0.08572304
[3,]  0.75957120 0.01961848
[4,]  0.01497444 0.77555615
[5,] -0.08458712 0.75260277
[6,] -0.09289188 0.79850952

[[1]]$misspec$TY
[1] 0 0 0 0 0 0

[[1]]$misspec$GA
NULL

[[1]]$misspec$KA
NULL


[[1]]$misOnly
[[1]]$misOnly$LY
            [,1]       [,2]
[1,]  0.00000000 0.02855910
[2,]  0.00000000 0.08572304
[3,]  0.00000000 0.01961848
[4,]  0.01497444 0.00000000
[5,] -0.08458712 0.00000000
[6,] -0.09289188 0.00000000

[[1]]$misOnly$PS
NULL

[[1]]$misOnly$RPS
     [,1] [,2]
[1,]    0    0
[2,]    0    0

[[1]]$misOnly$TE
NULL

[[1]]$misOnly$RTE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    0    0    0    0    0    0
[2,]    0    0    0    0    0    0
[3,]    0    0    0    0    0    0
[4,]    0    0    0    0    0    0
[5,]    0    0    0    0    0    0
[6,]    0    0    0    0    0    0

[[1]]$misOnly$BE
NULL

[[1]]$misOnly$VTE
[1] 0 0 0 0 0 0

[[1]]$misOnly$VY
NULL

[[1]]$misOnly$VPS
[1] 0 0

[[1]]$misOnly$VE
[1] 0 0

[[1]]$misOnly$TY
[1] 0 0 0 0 0 0

[[1]]$misOnly$AL
[1] 0 0

[[1]]$misOnly$MY
NULL

[[1]]$misOnly$ME
[1] 0 0

[[1]]$misOnly$KA
NULL

[[1]]$misOnly$GA
NULL



[[2]]
[[2]]$param
[[2]]$param$PS
          [,1]      [,2]
[1,] 1.1000000 0.5744563
[2,] 0.5744563 1.2000000

[[2]]$param$BE
NULL

[[2]]$param$AL
[1] 0 0

[[2]]$param$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[2]]$param$LY
          [,1]      [,2]
[1,] 0.7207545 0.0000000
[2,] 0.7228658 0.0000000
[3,] 0.7595712 0.0000000
[4,] 0.0000000 0.7755561
[5,] 0.0000000 0.7526028
[6,] 0.0000000 0.7985095

[[2]]$param$TY
[1] 0 0 0 0 0 0

[[2]]$param$GA
NULL

[[2]]$param$KA
NULL


[[2]]$misspec
[[2]]$misspec$PS
          [,1]      [,2]
[1,] 1.1000000 0.5744563
[2,] 0.5744563 1.2000000

[[2]]$misspec$BE
NULL

[[2]]$misspec$AL
[1] 0 0

[[2]]$misspec$TE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] 0.51 0.00 0.00 0.00 0.00 0.00
[2,] 0.00 0.51 0.00 0.00 0.00 0.00
[3,] 0.00 0.00 0.51 0.00 0.00 0.00
[4,] 0.00 0.00 0.00 0.51 0.00 0.00
[5,] 0.00 0.00 0.00 0.00 0.51 0.00
[6,] 0.00 0.00 0.00 0.00 0.00 0.51

[[2]]$misspec$LY
            [,1]         [,2]
[1,]  0.72075451 -0.009485834
[2,]  0.72286581 -0.064974646
[3,]  0.75957120  0.049339654
[4,] -0.05222626  0.775556147
[5,] -0.04836681  0.752602772
[6,]  0.04586192  0.798509522

[[2]]$misspec$TY
[1] 0 0 0 0 0 0

[[2]]$misspec$GA
NULL

[[2]]$misspec$KA
NULL


[[2]]$misOnly
[[2]]$misOnly$LY
            [,1]         [,2]
[1,]  0.00000000 -0.009485834
[2,]  0.00000000 -0.064974646
[3,]  0.00000000  0.049339654
[4,] -0.05222626  0.000000000
[5,] -0.04836681  0.000000000
[6,]  0.04586192  0.000000000

[[2]]$misOnly$PS
NULL

[[2]]$misOnly$RPS
     [,1] [,2]
[1,]    0    0
[2,]    0    0

[[2]]$misOnly$TE
NULL

[[2]]$misOnly$RTE
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    0    0    0    0    0    0
[2,]    0    0    0    0    0    0
[3,]    0    0    0    0    0    0
[4,]    0    0    0    0    0    0
[5,]    0    0    0    0    0    0
[6,]    0    0    0    0    0    0

[[2]]$misOnly$BE
NULL

[[2]]$misOnly$VTE
[1] 0 0 0 0 0 0

[[2]]$misOnly$VY
NULL

[[2]]$misOnly$VPS
[1] 0 0

[[2]]$misOnly$VE
[1] 0 0

[[2]]$misOnly$TY
[1] 0 0 0 0 0 0

[[2]]$misOnly$AL
[1] 0 0

[[2]]$misOnly$MY
NULL

[[2]]$misOnly$ME
[1] 0 0

[[2]]$misOnly$KA
NULL

[[2]]$misOnly$GA
NULL



> 
> 
> 
> cleanEx()
> nameEx("estmodel")
> ### * estmodel
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: estmodel
> ### Title: Shortcut for data analysis template for simulation.
> ### Aliases: estmodel estmodel.cfa estmodel.path estmodel.sem
> 
> ### ** Examples
> 
> loading <- matrix(0, 12, 4)
> loading[1:3, 1] <- NA
> loading[4:6, 2] <- NA
> loading[7:9, 3] <- NA
> loading[10:12, 4] <- NA
> 
> CFA.Model <- estmodel(LY = loading, modelType = "CFA")
> 
> path <- matrix(0, 4, 4)
> path[3, 1:2] <- NA
> path[4, 3] <- NA
> Path.Model <- estmodel(BE = path, modelType = "Path")
> 
> SEM.Model <- estmodel(BE = path, LY = loading, modelType="SEM")
> 
> # Shortcut
> CFA.Model <- estmodel.cfa(LY = loading)
> Path.Model <- estmodel.path(BE = path)
> SEM.Model <- estmodel.sem(BE = path, LY = loading)
> 
> 
> 
> cleanEx()
> nameEx("exportData")
> ### * exportData
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: exportData
> ### Title: Export data sets for analysis with outside SEM program.
> ### Aliases: exportData
> 
> ### ** Examples
> 
> loading <- matrix(0, 6, 2)
> loading[1:3, 1] <- NA
> loading[4:6, 2] <- NA
> LY <- bind(loading, 0.7)
> 
> latent.cor <- matrix(NA, 2, 2)
> diag(latent.cor) <- 1
> RPS <- binds(latent.cor, 0.5)
> 
> RTE <- binds(diag(6))
> 
> VY <- bind(rep(NA,6),2)
> 
> CFA.Model <- model(LY = LY, RPS = RPS, RTE = RTE, modelType = "CFA")
> 
> ## Export 20 replications to an external data file (not run).
> #exportData(20, CFA.Model, 200)
> 
> 
> 
> cleanEx()
> nameEx("findFactorIntercept")
> ### * findFactorIntercept
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: findFactorIntercept
> ### Title: Find factor intercept from regression coefficient matrix and
> ###   factor total means
> ### Aliases: findFactorIntercept
> 
> ### ** Examples
> 
> path <- matrix(0, 9, 9)
> path[4, 1] <- path[7, 4] <- 0.6
> path[5, 2] <- path[8, 5] <- 0.6
> path[6, 3] <- path[9, 6] <- 0.6
> path[5, 1] <- path[8, 4] <- 0.4
> path[6, 2] <- path[9, 5] <- 0.4
> factorMean <- c(5, 2, 3, 0, 0, 0, 0, 0, 0)
> findFactorIntercept(path, factorMean)
[1]  5.0  2.0  3.0 -3.0 -3.2 -2.6  0.0  0.0  0.0
> 
> 
> 
> cleanEx()
> nameEx("findFactorMean")
> ### * findFactorMean
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: findFactorMean
> ### Title: Find factor total means from regression coefficient matrix and
> ###   factor intercept
> ### Aliases: findFactorMean
> 
> ### ** Examples
> 
> path <- matrix(0, 9, 9)
> path[4, 1] <- path[7, 4] <- 0.6
> path[5, 2] <- path[8, 5] <- 0.6
> path[6, 3] <- path[9, 6] <- 0.6
> path[5, 1] <- path[8, 4] <- 0.4
> path[6, 2] <- path[9, 5] <- 0.4
> intcept <- c(5, 2, 3, 0, 0, 0, 0, 0, 0)
> findFactorMean(path, intcept)
[1] 5.00 2.00 3.00 3.00 3.20 2.60 1.80 3.12 2.84
> 
> 
> 
> cleanEx()
> nameEx("findFactorResidualVar")
> ### * findFactorResidualVar
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: findFactorResidualVar
> ### Title: Find factor residual variances from regression coefficient
> ###   matrix, factor (residual) correlations, and total factor variances
> ### Aliases: findFactorResidualVar
> 
> ### ** Examples
> 
> path <- matrix(0, 9, 9)
> path[4, 1] <- path[7, 4] <- 0.6
> path[5, 2] <- path[8, 5] <- 0.6
> path[6, 3] <- path[9, 6] <- 0.6
> path[5, 1] <- path[8, 4] <- 0.4
> path[6, 2] <- path[9, 5] <- 0.4
> facCor <- diag(9)
> facCor[1, 2] <- facCor[2, 1] <- 0.4
> facCor[1, 3] <- facCor[3, 1] <- 0.4
> facCor[2, 3] <- facCor[3, 2] <- 0.4
> totalVar <- rep(1, 9)
> findFactorResidualVar(path, facCor, totalVar)
[1] 1.00000 1.00000 1.00000 0.64000 0.28800 0.28800 0.64000 0.29568 0.21888
> 
> 
> 
> cleanEx()
> nameEx("findFactorTotalCov")
> ### * findFactorTotalCov
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: findFactorTotalCov
> ### Title: Find factor total covariance from regression coefficient matrix,
> ###   factor residual covariance
> ### Aliases: findFactorTotalCov
> 
> ### ** Examples
> 
> path <- matrix(0, 9, 9)
> path[4, 1] <- path[7, 4] <- 0.6
> path[5, 2] <- path[8, 5] <- 0.6
> path[6, 3] <- path[9, 6] <- 0.6
> path[5, 1] <- path[8, 4] <- 0.4
> path[6, 2] <- path[9, 5] <- 0.4
> facCor <- diag(9)
> facCor[1, 2] <- facCor[2, 1] <- 0.4
> facCor[1, 3] <- facCor[3, 1] <- 0.4
> facCor[2, 3] <- facCor[3, 2] <- 0.4
> residualVar <- c(1, 1, 1, 0.64, 0.288, 0.288, 0.64, 0.29568, 0.21888)
> findFactorTotalCov(path, corPsi=facCor, errorVarPsi=residualVar)
       [,1]  [,2]  [,3]   [,4]   [,5]   [,6]    [,7]    [,8]    [,9]
 [1,] 1.000 0.400 0.400 0.6000 0.6400 0.4000 0.36000 0.62400 0.49600
 [2,] 0.400 1.000 0.400 0.2400 0.7600 0.6400 0.14400 0.55200 0.68800
 [3,] 0.400 0.400 1.000 0.2400 0.4000 0.7600 0.14400 0.33600 0.61600
 [4,] 0.600 0.240 0.240 1.0000 0.3840 0.2400 0.60000 0.63040 0.29760
 [5,] 0.640 0.760 0.400 0.3840 1.0000 0.5440 0.23040 0.75360 0.72640
 [6,] 0.400 0.640 0.760 0.2400 0.5440 1.0000 0.14400 0.42240 0.81760
 [7,] 0.360 0.144 0.144 0.6000 0.2304 0.1440 1.00000 0.37824 0.17856
 [8,] 0.624 0.552 0.336 0.6304 0.7536 0.4224 0.37824 1.00000 0.55488
 [9,] 0.496 0.688 0.616 0.2976 0.7264 0.8176 0.17856 0.55488 1.00000
> 
> 
> 
> cleanEx()
> nameEx("findFactorTotalVar")
> ### * findFactorTotalVar
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: findFactorTotalVar
> ### Title: Find factor total variances from regression coefficient matrix,
> ###   factor (residual) correlations, and factor residual variances
> ### Aliases: findFactorTotalVar
> 
> ### ** Examples
> 
> path <- matrix(0, 9, 9)
> path[4, 1] <- path[7, 4] <- 0.6
> path[5, 2] <- path[8, 5] <- 0.6
> path[6, 3] <- path[9, 6] <- 0.6
> path[5, 1] <- path[8, 4] <- 0.4
> path[6, 2] <- path[9, 5] <- 0.4
> facCor <- diag(9)
> facCor[1, 2] <- facCor[2, 1] <- 0.4
> facCor[1, 3] <- facCor[3, 1] <- 0.4
> facCor[2, 3] <- facCor[3, 2] <- 0.4
> residualVar <- c(1, 1, 1, 0.64, 0.288, 0.288, 0.64, 0.29568, 0.21888)
> findFactorTotalVar(path, facCor, residualVar)
[1] 1 1 1 1 1 1 1 1 1
> 
> 
> 
> cleanEx()
> nameEx("findIndIntercept")
> ### * findIndIntercept
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: findIndIntercept
> ### Title: Find indicator intercepts from factor loading matrix, total
> ###   factor mean, and indicator mean.
> ### Aliases: findIndIntercept
> 
> ### ** Examples
> 
> loading <- matrix(0, 6, 2)
> loading[1:3, 1] <- c(0.6, 0.7, 0.8)
> loading[4:6, 2] <- c(0.6, 0.7, 0.8)
> facMean <- c(0.5, 0.2)
> indMean <- rep(1, 6)
> findIndIntercept(loading, facMean, indMean)
[1] 0.70 0.65 0.60 0.88 0.86 0.84
> 
> 
> 
> cleanEx()
> nameEx("findIndMean")
> ### * findIndMean
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: findIndMean
> ### Title: Find indicator total means from factor loading matrix, total
> ###   factor mean, and indicator intercept.
> ### Aliases: findIndMean
> 
> ### ** Examples
> 
> loading <- matrix(0, 6, 2)
> loading[1:3, 1] <- c(0.6, 0.7, 0.8)
> loading[4:6, 2] <- c(0.6, 0.7, 0.8)
> facMean <- c(0.5, 0.2)
> intcept <- rep(0, 6)
> findIndMean(loading, facMean, intcept)
[1] 0.30 0.35 0.40 0.12 0.14 0.16
> 
> 
> 
> cleanEx()
> nameEx("findIndResidualVar")
> ### * findIndResidualVar
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: findIndResidualVar
> ### Title: Find indicator residual variances from factor loading matrix,
> ###   total factor covariance, and total indicator variances.
> ### Aliases: findIndResidualVar
> 
> ### ** Examples
> 
> loading <- matrix(0, 6, 2)
> loading[1:3, 1] <- c(0.6, 0.7, 0.8)
> loading[4:6, 2] <- c(0.6, 0.7, 0.8)
> facCov <- matrix(c(1, 0.5, 0.5, 1), 2, 2)
> totalVar <- rep(1, 6)
> findIndResidualVar(loading, facCov, totalVar)
[1] 0.64 0.51 0.36 0.64 0.51 0.36
> 
> 
> 
> cleanEx()
> nameEx("findIndTotalVar")
> ### * findIndTotalVar
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: findIndTotalVar
> ### Title: Find indicator total variances from factor loading matrix, total
> ###   factor covariance, and indicator residual variances.
> ### Aliases: findIndTotalVar
> 
> ### ** Examples
> 
> loading <- matrix(0, 6, 2)
> loading[1:3, 1] <- c(0.6, 0.7, 0.8)
> loading[4:6, 2] <- c(0.6, 0.7, 0.8)
> facCov <- matrix(c(1, 0.5, 0.5, 1), 2, 2)
> resVar <- c(0.64, 0.51, 0.36, 0.64, 0.51, 0.36)
> findIndTotalVar(loading, facCov, resVar)
[1] 1 1 1 1 1 1
> 
> 
> 
> cleanEx()
> nameEx("findPossibleFactorCor")
> ### * findPossibleFactorCor
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: findPossibleFactorCor
> ### Title: Find the appropriate position for freely estimated correlation
> ###   (or covariance) given a regression coefficient matrix
> ### Aliases: findPossibleFactorCor
> 
> ### ** Examples
> 
> path <- matrix(0, 9, 9)
> path[4, 1] <- path[7, 4] <- NA
> path[5, 2] <- path[8, 5] <- NA
> path[6, 3] <- path[9, 6] <- NA
> path[5, 1] <- path[8, 4] <- NA
> path[6, 2] <- path[9, 5] <- NA
> findPossibleFactorCor(path)
      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
 [1,]    1   NA   NA    0    0    0    0    0    0
 [2,]   NA    1   NA    0    0    0    0    0    0
 [3,]   NA   NA    1    0    0    0    0    0    0
 [4,]    0    0    0    1   NA   NA    0    0    0
 [5,]    0    0    0   NA    1   NA    0    0    0
 [6,]    0    0    0   NA   NA    1    0    0    0
 [7,]    0    0    0    0    0    0    1   NA   NA
 [8,]    0    0    0    0    0    0   NA    1   NA
 [9,]    0    0    0    0    0    0   NA   NA    1
> 
> 
> 
> cleanEx()
> nameEx("findPower")
> ### * findPower
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: findPower
> ### Title: Find a value of independent variables that provides a given
> ###   value of power.
> ### Aliases: findPower
> 
> ### ** Examples
> 
> ## Not run: 
> ##D # Specify Sample Size by n
> ##D loading <- matrix(0, 6, 1)
> ##D loading[1:6, 1] <- NA
> ##D LY <- bind(loading, 0.4)
> ##D RPS <- binds(diag(1))
> ##D RTE <- binds(diag(6))
> ##D CFA.Model <- model(LY = LY, RPS = RPS, RTE = RTE, modelType="CFA")
> ##D 
> ##D # Specify both sample size and percent missing completely at random. Note that more fine-grained 
> ##D # values of n and pmMCAR is needed, e.g., n=seq(50, 500, 1) and pmMCAR=seq(0, 0.2, 0.01)
> ##D Output <- sim(NULL, model=CFA.Model, n=seq(100, 200, 20), pmMCAR=c(0, 0.1, 0.2))
> ##D 
> ##D # Find the power of all possible combination of N and pmMCAR
> ##D pow <- getPower(Output)
> ##D 
> ##D # Find the sample size that provides the power of 0.8
> ##D findPower(pow, "N", 0.80)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("findRecursiveSet")
> ### * findRecursiveSet
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: findRecursiveSet
> ### Title: Group variables regarding the position in mediation chain
> ### Aliases: findRecursiveSet
> 
> ### ** Examples
> 
> path <- matrix(0, 9, 9)
> path[4, 1] <- path[7, 4] <- NA
> path[5, 2] <- path[8, 5] <- NA
> path[6, 3] <- path[9, 6] <- NA
> path[5, 1] <- path[8, 4] <- NA
> path[6, 2] <- path[9, 5] <- NA
> findRecursiveSet(path)
[[1]]
[1] 1 2 3

[[2]]
[1] 4 5 6

[[3]]
[1] 7 8 9

> 
> 
> 
> cleanEx()
> nameEx("generate")
> ### * generate
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: generate
> ### Title: Generate data using SimSem template
> ### Aliases: generate
> 
> ### ** Examples
> 
> loading <- matrix(0, 6, 2)
> loading[1:3, 1] <- NA
> loading[4:6, 2] <- NA
> LY <- bind(loading, 0.7)
> 
> latent.cor <- matrix(NA, 2, 2)
> diag(latent.cor) <- 1
> RPS <- binds(latent.cor, 0.5)
> 
> RTE <- binds(diag(6))
> 
> VY <- bind(rep(NA,6),2)
> 
> CFA.Model <- model(LY = LY, RPS = RPS, RTE = RTE, modelType = "CFA")
> 
> dat <- generate(CFA.Model,200)
> 
> 
> 
> cleanEx()
> nameEx("getCutoff")
> ### * getCutoff
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: getCutoff
> ### Title: Find fit indices cutoff given a priori alpha level
> ### Aliases: getCutoff getCutoff-methods getCutoff,data.frame-method
> ###   getCutoff,matrix-method getCutoff,SimResult-method
> 
> ### ** Examples
> 
> ## Not run: 
> ##D loading <- matrix(0, 6, 2)
> ##D loading[1:3, 1] <- NA
> ##D loading[4:6, 2] <- NA
> ##D loadingValues <- matrix(0, 6, 2)
> ##D loadingValues[1:3, 1] <- 0.7
> ##D loadingValues[4:6, 2] <- 0.7
> ##D LY <- bind(loading, loadingValues)
> ##D latent.cor <- matrix(NA, 2, 2)
> ##D diag(latent.cor) <- 1
> ##D RPS <- binds(latent.cor, 0.5)
> ##D error.cor <- matrix(0, 6, 6)
> ##D diag(error.cor) <- 1
> ##D RTE <- binds(error.cor)
> ##D CFA.Model <- model(LY = LY, RPS = RPS, RTE = RTE, modelType="CFA")
> ##D 
> ##D # We make the examples running only 5 replications to save time.
> ##D # In reality, more replications are needed.
> ##D Output <- sim(5, n = 200, model=CFA.Model)
> ##D 
> ##D # Get the cutoff (critical value) when alpha is 0.05
> ##D getCutoff(Output, 0.05)
> ##D 
> ##D # Finding the cutoff when the sample size is varied. Note that more fine-grained 
> ##D # values of n is needed, e.g., n=seq(50, 500, 1)
> ##D Output2 <- sim(NULL, model=CFA.Model, n=seq(50, 100, 10))
> ##D 
> ##D # Get the fit index cutoff when sample size is 75.
> ##D getCutoff(Output2, 0.05, nVal = 75)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("getCutoffNested")
> ### * getCutoffNested
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: getCutoffNested
> ### Title: Find fit indices cutoff for nested model comparison given a
> ###   priori alpha level
> ### Aliases: getCutoffNested
> 
> ### ** Examples
> 
> ## Not run: 
> ##D # Nested Model
> ##D loading.null <- matrix(0, 6, 1)
> ##D loading.null[1:6, 1] <- NA
> ##D LY.NULL <- bind(loading.null, 0.7)
> ##D RPS.NULL <- binds(diag(1))
> ##D 
> ##D error.cor.mis <- matrix("rnorm(1, 0, 0.1)", 6, 6)
> ##D diag(error.cor.mis) <- 1
> ##D RTE <- binds(diag(6), misspec=error.cor.mis)
> ##D CFA.Model.NULL <- model(LY = LY.NULL, RPS = RPS.NULL, RTE = RTE, modelType="CFA")
> ##D 
> ##D # Parent Model
> ##D loading.alt <- matrix(0, 6, 2)
> ##D loading.alt[1:3, 1] <- NA
> ##D loading.alt[4:6, 2] <- NA
> ##D LY.ALT <- bind(loading.alt, 0.7)
> ##D latent.cor.alt <- matrix(NA, 2, 2)
> ##D diag(latent.cor.alt) <- 1
> ##D RPS.ALT <- binds(latent.cor.alt, "runif(1, 0.7, 0.9)")
> ##D CFA.Model.ALT <- model(LY = LY.ALT, RPS = RPS.ALT, RTE = RTE, modelType="CFA")
> ##D 
> ##D # The actual number of replications should be greater than 10.
> ##D Output.NULL.NULL <- sim(10, n=500, model=CFA.Model.NULL, generate=CFA.Model.NULL)
> ##D Output.NULL.ALT <- sim(10, n=500, model=CFA.Model.ALT, generate=CFA.Model.NULL)
> ##D 
> ##D # Find the fix index cutoff from the sampling distribution of the difference
> ##D # in fit index of nested models where the alpha is 0.05.
> ##D getCutoffNested(Output.NULL.NULL, Output.NULL.ALT, alpha=0.05)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("getCutoffNonNested")
> ### * getCutoffNonNested
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: getCutoffNonNested
> ### Title: Find fit indices cutoff for non-nested model comparison given a
> ###   priori alpha level
> ### Aliases: getCutoffNonNested
> 
> ### ** Examples
> 
> ## Not run: 
> ##D # Model A: Factor 1 with items 1-3 and Factor 2 with items 4-8
> ##D loading.A <- matrix(0, 8, 2)
> ##D loading.A[1:3, 1] <- NA
> ##D loading.A[4:8, 2] <- NA
> ##D LY.A <- bind(loading.A, 0.7)
> ##D latent.cor <- matrix(NA, 2, 2)
> ##D diag(latent.cor) <- 1
> ##D RPS <- binds(latent.cor, "runif(1, 0.7, 0.9)")
> ##D RTE <- binds(diag(8))
> ##D CFA.Model.A <- model(LY = LY.A, RPS = RPS, RTE = RTE, modelType="CFA")
> ##D 
> ##D # Model B: Factor 1 with items 1-4 and Factor 2 with items 5-8
> ##D loading.B <- matrix(0, 8, 2)
> ##D loading.B[1:4, 1] <- NA
> ##D loading.B[5:8, 2] <- NA
> ##D LY.B <- bind(loading.B, 0.7)
> ##D CFA.Model.B <- model(LY = LY.B, RPS = RPS, RTE = RTE, modelType="CFA")
> ##D 
> ##D # The actual number of replications should be greater than 10.
> ##D Output.A.A <- sim(10, n=500, model=CFA.Model.A, generate=CFA.Model.A)
> ##D Output.A.B <- sim(10, n=500, model=CFA.Model.B, generate=CFA.Model.A)
> ##D Output.B.A <- sim(10, n=500, model=CFA.Model.A, generate=CFA.Model.B)
> ##D Output.B.B <- sim(10, n=500, model=CFA.Model.B, generate=CFA.Model.B)
> ##D 
> ##D # Find the cutoffs from the sampling distribution to reject model A (model 1)
> ##D # and to reject model B (model 2)
> ##D getCutoffNonNested(Output.A.A, Output.A.B, Output.B.A, Output.B.B)
> ##D 
> ##D # Find the cutoffs from the sampling distribution to reject model A (model 1)
> ##D getCutoffNonNested(Output.A.A, Output.A.B)
> ##D 
> ##D # Find the cutoffs from the sampling distribution to reject model B (model 1)
> ##D getCutoffNonNested(Output.B.B, Output.B.A)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("getExtraOutput")
> ### * getExtraOutput
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: getExtraOutput
> ### Title: Get extra outputs from the result of simulation
> ### Aliases: getExtraOutput
> 
> ### ** Examples
> 
> ## Not run: 
> ##D loading <- matrix(0, 6, 1)
> ##D loading[1:6, 1] <- NA
> ##D LY <- bind(loading, 0.7)
> ##D RPS <- binds(diag(1))
> ##D RTE <- binds(diag(6))
> ##D CFA.Model <- model(LY = LY, RPS = RPS, RTE = RTE, modelType="CFA")
> ##D 
> ##D # Write a function to extract the modification index from lavaan object
> ##D outfun <- function(out) {
> ##D 	result <- inspect(out, "mi")
> ##D }
> ##D 
> ##D # We will use only 5 replications to save time.
> ##D # In reality, more replications are needed.
> ##D Output <- sim(5, n=200, model=CFA.Model, outfun=outfun)
> ##D 
> ##D # Get the modification index of each replication
> ##D getExtraOutput(Output)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("getPopulation")
> ### * getPopulation
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: getPopulation
> ### Title: Extract the data generation population model underlying a result
> ###   object
> ### Aliases: getPopulation
> 
> ### ** Examples
> 
> ## Not run: 
> ##D loading <- matrix(0, 6, 1)
> ##D loading[1:6, 1] <- NA
> ##D LY <- bind(loading, "runif(1, 0.4, 0.9)")
> ##D RPS <- binds(diag(1))
> ##D RTE <- binds(diag(6))
> ##D CFA.Model <- model(LY = LY, RPS = RPS, RTE = RTE, modelType="CFA")
> ##D 
> ##D # We will use only 10 replications to save time.
> ##D # In reality, more replications are needed.
> ##D Output <- sim(10, n=200, model=CFA.Model)
> ##D 
> ##D # Get the population parameters
> ##D getPopulation(Output)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("getPower")
> ### * getPower
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: getPower
> ### Title: Find power of model parameters
> ### Aliases: getPower
> 
> ### ** Examples
> 
> ## Not run: 
> ##D loading <- matrix(0, 6, 1)
> ##D loading[1:6, 1] <- NA
> ##D LY <- bind(loading, 0.7)
> ##D RPS <- binds(diag(1))
> ##D RTE <- binds(diag(6))
> ##D CFA.Model <- model(LY = LY, RPS = RPS, RTE = RTE, modelType="CFA")
> ##D 
> ##D # Specify both sample size and percent missing completely at random. Note that more fine-grained 
> ##D # values of n and pmMCAR is needed, e.g., n=seq(50, 500, 1) and pmMCAR=seq(0, 0.2, 0.01)
> ##D Output <- sim(NULL, model=CFA.Model, n=seq(100, 200, 20), pmMCAR=c(0, 0.1, 0.2))
> ##D summary(Output)
> ##D 
> ##D # Get the power of all possible combinations of n and pmMCAR
> ##D getPower(Output)
> ##D 
> ##D # Get the power of the combinations of n of 100 and 200 and pmMCAR of 0, 0.1, and 0.2
> ##D getPower(Output, nVal=c(100, 200), pmMCARval=c(0, 0.1, 0.2))
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("getPowerFit")
> ### * getPowerFit
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: getPowerFit
> ### Title: Find power in rejecting alternative models based on fit indices
> ###   criteria
> ### Aliases: getPowerFit
> 
> ### ** Examples
> 
> ## Not run: 
> ##D # Null model with one factor
> ##D loading.null <- matrix(0, 6, 1)
> ##D loading.null[1:6, 1] <- NA
> ##D LY.NULL <- bind(loading.null, 0.7)
> ##D RPS.NULL <- binds(diag(1))
> ##D RTE <- binds(diag(6))
> ##D CFA.Model.NULL <- model(LY = LY.NULL, RPS = RPS.NULL, RTE = RTE, modelType="CFA")
> ##D 
> ##D # We make the examples running only 5 replications to save time.
> ##D # In reality, more replications are needed.
> ##D Output.NULL <- sim(5, n=500, model=CFA.Model.NULL)
> ##D 
> ##D # Get the fit index cutoff from the null model
> ##D Cut.NULL <- getCutoff(Output.NULL, 0.05)
> ##D 
> ##D # Alternative model with two factor
> ##D loading.alt <- matrix(0, 6, 2)
> ##D loading.alt[1:3, 1] <- NA
> ##D loading.alt[4:6, 2] <- NA
> ##D LY.ALT <- bind(loading.alt, 0.7)
> ##D latent.cor.alt <- matrix(NA, 2, 2)
> ##D diag(latent.cor.alt) <- 1
> ##D RPS.ALT <- binds(latent.cor.alt, "runif(1, 0.7, 0.9)")
> ##D CFA.Model.ALT <- model(LY = LY.ALT, RPS = RPS.ALT, RTE = RTE, modelType="CFA")
> ##D 
> ##D # We make the examples running only 5 replications to save time.
> ##D # In reality, more replications are needed.
> ##D Output.ALT <- sim(5, n=500, model=CFA.Model.NULL, generate=CFA.Model.ALT)
> ##D 
> ##D # Get the power based on the derived cutoff
> ##D getPowerFit(Output.ALT, cutoff=Cut.NULL)
> ##D 
> ##D # Get the power based on the rule of thumb proposed by Hu & Bentler (1999)
> ##D Rule.of.thumb <- c(RMSEA=0.05, CFI=0.95, TLI=0.95, SRMR=0.06)
> ##D getPowerFit(Output.ALT, cutoff=Rule.of.thumb, usedFit=c("RMSEA", "CFI", "TLI", "SRMR"))
> ##D 
> ##D # The example of continous varying sample size. Note that more fine-grained 
> ##D # values of n is needed, e.g., n=seq(50, 500, 1)
> ##D Output.NULL2 <- sim(NULL, n=seq(50, 500, 50), model=CFA.Model.NULL, generate=CFA.Model.NULL)
> ##D Output.ALT2 <- sim(NULL, n=seq(50, 500, 50), model=CFA.Model.NULL, generate=CFA.Model.ALT)
> ##D 
> ##D # Get the power based on the derived cutoff from the null model at the sample size of 250
> ##D getPowerFit(Output.ALT2, nullObject=Output.NULL2, nVal=250)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("getPowerFitNested")
> ### * getPowerFitNested
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: getPowerFitNested
> ### Title: Find power in rejecting nested models based on the differences
> ###   in fit indices
> ### Aliases: getPowerFitNested
> 
> ### ** Examples
> 
> ## Not run: 
> ##D # Null model (Nested model) with one factor
> ##D loading.null <- matrix(0, 6, 1)
> ##D loading.null[1:6, 1] <- NA
> ##D LY.NULL <- bind(loading.null, 0.7)
> ##D RPS.NULL <- binds(diag(1))
> ##D RTE <- binds(diag(6))
> ##D CFA.Model.NULL <- model(LY = LY.NULL, RPS = RPS.NULL, RTE = RTE, modelType="CFA")
> ##D 
> ##D # Alternative model (Parent model) with two factors
> ##D loading.alt <- matrix(0, 6, 2)
> ##D loading.alt[1:3, 1] <- NA
> ##D loading.alt[4:6, 2] <- NA
> ##D LY.ALT <- bind(loading.alt, 0.7)
> ##D latent.cor.alt <- matrix(NA, 2, 2)
> ##D diag(latent.cor.alt) <- 1
> ##D RPS.ALT <- binds(latent.cor.alt, 0.7)
> ##D CFA.Model.ALT <- model(LY = LY.ALT, RPS = RPS.ALT, RTE = RTE, modelType="CFA")
> ##D 
> ##D # We make the examples running only 10 replications to save time.
> ##D # In reality, more replications are needed.
> ##D Output.NULL.NULL <- sim(10, n=500, model=CFA.Model.NULL, generate=CFA.Model.NULL) 
> ##D Output.ALT.NULL <- sim(10, n=500, model=CFA.Model.NULL, generate=CFA.Model.ALT) 
> ##D Output.NULL.ALT <- sim(10, n=500, model=CFA.Model.ALT, generate=CFA.Model.NULL) 
> ##D Output.ALT.ALT <- sim(10, n=500, model=CFA.Model.ALT, generate=CFA.Model.ALT) 
> ##D 
> ##D # Find the power based on the derived cutoff from the models analyzed on the null datasets
> ##D getPowerFitNested(Output.ALT.NULL, Output.ALT.ALT, nullNested=Output.NULL.NULL, nullParent=Output.NULL.ALT)
> ##D 
> ##D # Find the power based on the chi-square value at df=1 and the CFI change (intentionally
> ##D # use a cutoff from Cheung and Rensvold (2002) in an appropriate situation).
> ##D getPowerFitNested(Output.ALT.NULL, Output.ALT.ALT, cutoff=c(Chi=3.84, CFI=-0.10))
> ##D 
> ##D # The example of continous varying sample size. Note that more fine-grained 
> ##D # values of n is needed, e.g., n=seq(50, 500, 1)
> ##D Output.NULL.NULL2 <- sim(NULL, n=seq(50, 500, 50), model=CFA.Model.NULL, generate=CFA.Model.NULL) 
> ##D Output.ALT.NULL2 <- sim(NULL, n=seq(50, 500, 50), model=CFA.Model.NULL, generate=CFA.Model.ALT) 
> ##D Output.NULL.ALT2 <- sim(NULL, n=seq(50, 500, 50), model=CFA.Model.ALT, generate=CFA.Model.NULL) 
> ##D Output.ALT.ALT2 <- sim(NULL, n=seq(50, 500, 50), model=CFA.Model.ALT, generate=CFA.Model.ALT) 
> ##D 
> ##D # Get the power based on the derived cutoff from the null model at the sample size of 250
> ##D getPowerFitNested(Output.ALT.NULL2, Output.ALT.ALT2, nullNested=Output.NULL.NULL2, nullParent=Output.NULL.ALT2, nVal = 250)
> ##D 
> ##D # Get the power based on the rule of thumb from the null model at the sample size of 250
> ##D getPowerFitNested(Output.ALT.NULL2, Output.ALT.ALT2, cutoff=c(Chi=3.84, CFI=-0.10), nVal = 250)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("getPowerFitNonNested")
> ### * getPowerFitNonNested
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: getPowerFitNonNested
> ### Title: Find power in rejecting non-nested models based on the
> ###   differences in fit indices
> ### Aliases: getPowerFitNonNested getPowerFitNonNested-methods
> ###   getPowerFitNonNested,SimResult,SimResult,vector-method
> ###   getPowerFitNonNested,SimResult,SimResult,missing-method
> 
> ### ** Examples
> 
> ## Not run: 
> ##D # Model A: Factor 1 on Items 1-3 and Factor 2 on Items 4-8
> ##D loading.A <- matrix(0, 8, 2)
> ##D loading.A[1:3, 1] <- NA
> ##D loading.A[4:8, 2] <- NA
> ##D LY.A <- bind(loading.A, 0.7)
> ##D latent.cor <- matrix(NA, 2, 2)
> ##D diag(latent.cor) <- 1
> ##D RPS <- binds(latent.cor, "runif(1, 0.7, 0.9)")
> ##D RTE <- binds(diag(8))
> ##D CFA.Model.A <- model(LY = LY.A, RPS = RPS, RTE = RTE, modelType="CFA")
> ##D 
> ##D # Model B: Factor 1 on Items 1-4 and Factor 2 on Items 5-8
> ##D loading.B <- matrix(0, 8, 2)
> ##D loading.B[1:4, 1] <- NA
> ##D loading.B[5:8, 2] <- NA
> ##D LY.B <- bind(loading.B, 0.7)
> ##D CFA.Model.B <- model(LY = LY.B, RPS = RPS, RTE = RTE, modelType="CFA")
> ##D 
> ##D # The actual number of replications should be greater than 10.
> ##D Output.A.A <- sim(10, n=500, model=CFA.Model.A, generate=CFA.Model.A) 
> ##D Output.A.B <- sim(10, n=500, model=CFA.Model.B, generate=CFA.Model.A) 
> ##D Output.B.A <- sim(10, n=500, model=CFA.Model.A, generate=CFA.Model.B) 
> ##D Output.B.B <- sim(10, n=500, model=CFA.Model.B, generate=CFA.Model.B) 
> ##D 
> ##D # Find the power based on the derived cutoff for both models
> ##D getPowerFitNonNested(Output.B.A, Output.B.B, dat1Mod1=Output.A.A, dat1Mod2=Output.A.B)
> ##D 
> ##D # Find the power based on the AIC and BIC of 0 (select model B if Output.B.B has lower AIC or BIC)
> ##D getPowerFitNonNested(Output.B.A, Output.B.B, cutoff=c(AIC=0, BIC=0))
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("imposeMissing")
> ### * imposeMissing
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: imposeMissing
> ### Title: Impose MAR, MCAR, planned missingness, or attrition on a data
> ###   set
> ### Aliases: imposeMissing impose
> 
> ### ** Examples
> 
>   data <- matrix(rep(rnorm(10,1,1),19),ncol=19)
>   datac <- cbind(data,rnorm(10,0,1),rnorm(10,5,5))
>  
>   # Imposing Missing with the following arguments produces no missing values
>   imposeMissing(data)
           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
           [,8]      [,9]     [,10]     [,11]     [,12]     [,13]     [,14]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
          [,15]     [,16]     [,17]     [,18]     [,19]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
>   imposeMissing(data,cov=c(1,2))
           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
           [,8]      [,9]     [,10]     [,11]     [,12]     [,13]     [,14]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
          [,15]     [,16]     [,17]     [,18]     [,19]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
>   imposeMissing(data,pmMCAR=0)
           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
           [,8]      [,9]     [,10]     [,11]     [,12]     [,13]     [,14]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
          [,15]     [,16]     [,17]     [,18]     [,19]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
>   imposeMissing(data,pmMAR=0)
           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
           [,8]      [,9]     [,10]     [,11]     [,12]     [,13]     [,14]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
          [,15]     [,16]     [,17]     [,18]     [,19]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
>   imposeMissing(data,nforms=0)
           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
           [,8]      [,9]     [,10]     [,11]     [,12]     [,13]     [,14]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
          [,15]     [,16]     [,17]     [,18]     [,19]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
> 
>   #Some more usage examples
>   
>   # No missing at variables 1 and 2
>   imposeMissing(data,cov=c(1,2),pmMCAR=.1)
           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433        NA 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316        NA 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
           [,8]      [,9]     [,10]     [,11]     [,12]     [,13]     [,14]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,]        NA 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,]        NA 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291        NA 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247        NA 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
          [,15]     [,16]     [,17]     [,18]     [,19]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247        NA 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
>   
>   # 3-Form design
>   imposeMissing(data,nforms=3)
           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462        NA        NA        NA
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433        NA        NA        NA
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714        NA        NA        NA
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
           [,8]      [,9]     [,10]     [,11]     [,12]     [,13]     [,14]
 [1,]        NA        NA 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,]        NA        NA 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,]        NA        NA 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808        NA        NA        NA        NA        NA
 [5,] 1.3295078 1.3295078        NA        NA        NA        NA        NA
 [6,] 0.1795316 0.1795316        NA        NA        NA        NA        NA
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
          [,15]     [,16]     [,17]     [,18]     [,19]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,]        NA        NA        NA        NA        NA
 [8,]        NA        NA        NA        NA        NA
 [9,]        NA        NA        NA        NA        NA
[10,]        NA        NA        NA        NA        NA
>   
>   # 3-Form design with specified groups of items (XABC)
>   imposeMissing(data,nforms=3,itemGroups=list(c(1,2,3,4,5),c(6,7,8,9,10),c(11,12,13,14,15),c(16,17,18,19)))
           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462        NA        NA
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433        NA        NA
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714        NA        NA
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
           [,8]      [,9]     [,10]     [,11]     [,12]     [,13]     [,14]
 [1,]        NA        NA        NA 0.3735462 0.3735462 0.3735462 0.3735462
 [2,]        NA        NA        NA 1.1836433 1.1836433 1.1836433 1.1836433
 [3,]        NA        NA        NA 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808        NA        NA        NA        NA
 [5,] 1.3295078 1.3295078 1.3295078        NA        NA        NA        NA
 [6,] 0.1795316 0.1795316 0.1795316        NA        NA        NA        NA
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
          [,15]     [,16]     [,17]     [,18]     [,19]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,]        NA 2.5952808 2.5952808 2.5952808 2.5952808
 [5,]        NA 1.3295078 1.3295078 1.3295078 1.3295078
 [6,]        NA 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291        NA        NA        NA        NA
 [8,] 1.7383247        NA        NA        NA        NA
 [9,] 1.5757814        NA        NA        NA        NA
[10,] 0.6946116        NA        NA        NA        NA
>   
>   # 3-Form design when variables 20 and 21 are not missing
>   imposeMissing(datac,cov=c(20,21),nforms=3)
           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462        NA        NA        NA
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433        NA        NA        NA
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714        NA        NA        NA
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
           [,8]      [,9]     [,10]     [,11]     [,12]     [,13]     [,14]
 [1,]        NA        NA 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,]        NA        NA 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,]        NA        NA 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808        NA        NA        NA        NA        NA
 [5,] 1.3295078 1.3295078        NA        NA        NA        NA        NA
 [6,] 0.1795316 0.1795316        NA        NA        NA        NA        NA
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
          [,15]     [,16]     [,17]     [,18]     [,19]       [,20]     [,21]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462  1.51178117  9.594887
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433  0.38984324  8.910682
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 -0.62124058  5.372825
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 -2.21469989 -4.946758
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078  1.12493092  8.099129
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 -0.04493361  4.719356
 [7,]        NA        NA        NA        NA        NA -0.01619026  4.221022
 [8,]        NA        NA        NA        NA        NA  0.94383621 -2.353762
 [9,]        NA        NA        NA        NA        NA  0.82122120  2.609250
[10,]        NA        NA        NA        NA        NA  0.59390132  7.089708
>   
>   # 2 method design where the expensive measure is on Variable 19
>   imposeMissing(data,twoMethod=c(19,.8))
           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
           [,8]      [,9]     [,10]     [,11]     [,12]     [,13]     [,14]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
          [,15]     [,16]     [,17]     [,18]     [,19]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462        NA
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433        NA
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714        NA
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808        NA
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078        NA
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316        NA
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291        NA
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247        NA
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
>   
>   # Impose missing data with percent attrition of 0.1 in 5 time points
>   imposeMissing(datac,cov=21,prAttr=.1,timePoints=5)
           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291        NA        NA        NA
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
           [,8]      [,9]     [,10]     [,11]     [,12]     [,13]     [,14]
 [1,] 0.3735462        NA        NA        NA        NA        NA        NA
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078        NA        NA
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,]        NA        NA        NA        NA        NA        NA        NA
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
          [,15]     [,16]     [,17]     [,18]     [,19]       [,20]     [,21]
 [1,]        NA        NA        NA        NA        NA          NA  9.594887
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433  0.38984324  8.910682
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 -0.62124058  5.372825
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 -2.21469989 -4.946758
 [5,]        NA        NA        NA        NA        NA          NA  8.099129
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 -0.04493361  4.719356
 [7,]        NA        NA        NA        NA        NA          NA  4.221022
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247  0.94383621 -2.353762
 [9,] 1.5757814 1.5757814        NA        NA        NA          NA  2.609250
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116  0.59390132  7.089708
> 
>   # Logistic-regression MAR
>   colnames(data) <- paste("y", 1:ncol(data), sep="")
>   script <- 'y1 ~ 0.05 + 0.1*y2 + 0.3*y3
+ 			y4 ~ -2 + 0.1*y4
+ 			y5 ~ -0.5'
>   imposeMissing(data, logit=script)
             y1        y2        y3        y4        y5        y6        y7
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,]        NA 1.1836433 1.1836433 1.1836433        NA 1.1836433 1.1836433
 [3,]        NA 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,]        NA 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,]        NA 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,]        NA 1.4874291 1.4874291        NA 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,]        NA 1.5757814 1.5757814 1.5757814        NA 1.5757814 1.5757814
[10,]        NA 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
             y8        y9       y10       y11       y12       y13       y14
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
            y15       y16       y17       y18       y19
 [1,] 0.3735462 0.3735462 0.3735462 0.3735462 0.3735462
 [2,] 1.1836433 1.1836433 1.1836433 1.1836433 1.1836433
 [3,] 0.1643714 0.1643714 0.1643714 0.1643714 0.1643714
 [4,] 2.5952808 2.5952808 2.5952808 2.5952808 2.5952808
 [5,] 1.3295078 1.3295078 1.3295078 1.3295078 1.3295078
 [6,] 0.1795316 0.1795316 0.1795316 0.1795316 0.1795316
 [7,] 1.4874291 1.4874291 1.4874291 1.4874291 1.4874291
 [8,] 1.7383247 1.7383247 1.7383247 1.7383247 1.7383247
 [9,] 1.5757814 1.5757814 1.5757814 1.5757814 1.5757814
[10,] 0.6946116 0.6946116 0.6946116 0.6946116 0.6946116
> 
> 
> 
> cleanEx()
> nameEx("likRatioFit")
> ### * likRatioFit
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: likRatioFit
> ### Title: Find the likelihood ratio (or Bayes factor) based on the
> ###   bivariate distribution of fit indices
> ### Aliases: likRatioFit
> 
> ### ** Examples
> 
> ## Not run: 
> ##D # Model A; Factor 1 --> Factor 2; Factor 2 --> Factor 3
> ##D library(lavaan)
> ##D loading <- matrix(0, 11, 3)
> ##D loading[1:3, 1] <- NA
> ##D loading[4:7, 2] <- NA
> ##D loading[8:11, 3] <- NA
> ##D path.A <- matrix(0, 3, 3)
> ##D path.A[2, 1] <- NA
> ##D path.A[3, 2] <- NA
> ##D model.A <- estmodel(LY=loading, BE=path.A, modelType="SEM", indLab=c(paste("x", 1:3, sep=""), paste("y", 1:8, sep="")))
> ##D 
> ##D out.A <- analyze(model.A, PoliticalDemocracy)
> ##D 
> ##D # Model A; Factor 1 --> Factor 3; Factor 3 --> Factor 2
> ##D path.B <- matrix(0, 3, 3)
> ##D path.B[3, 1] <- NA
> ##D path.B[2, 3] <- NA
> ##D model.B <- estmodel(LY=loading, BE=path.B, modelType="SEM", indLab=c(paste("x", 1:3, sep=""), paste("y", 1:8, sep="")))
> ##D 
> ##D out.B <- analyze(model.B, PoliticalDemocracy)
> ##D 
> ##D loading.mis <- matrix("runif(1, -0.2, 0.2)", 11, 3)
> ##D loading.mis[is.na(loading)] <- 0
> ##D 
> ##D # Create SimSem object for data generation and data analysis template
> ##D datamodel.A <- model.lavaan(out.A, std=TRUE, LY=loading.mis)
> ##D datamodel.B <- model.lavaan(out.B, std=TRUE, LY=loading.mis)
> ##D 
> ##D # Get sample size
> ##D n <- nrow(PoliticalDemocracy)
> ##D 
> ##D # The actual number of replications should be greater than 20.
> ##D output.A.A <- sim(20, n=n, model.A, generate=datamodel.A) 
> ##D output.A.B <- sim(20, n=n, model.B, generate=datamodel.A)
> ##D output.B.A <- sim(20, n=n, model.A, generate=datamodel.B)
> ##D output.B.B <- sim(20, n=n, model.B, generate=datamodel.B)
> ##D 
> ##D # Find the likelihood ratio ;The output may contain some warnings here. 
> ##D # When the number of replications increases (e.g., 1000), the warnings should disappear.
> ##D likRatioFit(out.A, out.B, output.A.A, output.A.B, output.B.A, output.B.B)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("miss")
> ### * miss
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: miss
> ### Title: Specifying the missing template to impose on a dataset
> ### Aliases: miss
> 
> ### ** Examples
> 
> #Example of imposing 10% MCAR missing in all variables with no imputations (FIML method)
> Missing <- miss(pmMCAR=0.1, ignoreCols="group")
> summary(Missing)
MISSING OBJECT
The method of missing data handling: Maximum Likelihood 
Covariates: none 
Ignored Variables: group 
Proportion of MCAR: 0.1 
> 
> loading <- matrix(0, 6, 1)
> loading[1:6, 1] <- NA
> LY <- bind(loading, 0.7)
> RPS <- binds(diag(1))
> RTE <- binds(diag(6))
> CFA.Model <- model(LY = LY, RPS = RPS, RTE = RTE, modelType="CFA")
> 
> #Create data
> dat <- generate(CFA.Model, n = 20)
> 
> #Impose missing
> datmiss <- impose(Missing, dat)
> 
> #Analyze data
> out <- analyze(CFA.Model, datmiss)
> summary(out)
lavaan (0.5-10) converged normally after  24 iterations

  Number of observations                            20

  Number of missing patterns                         7

  Estimator                                         ML
  Minimum Function Chi-square                    8.196
  Degrees of freedom                                 9
  P-value                                        0.515

Parameter estimates:

  Information                                 Observed
  Standard Errors                             Standard

                   Estimate  Std.err  Z-value  P(>|z|)
Latent variables:
  f1 =~
    y1                0.694    0.161    4.309    0.000
    y2                0.783    0.234    3.348    0.001
    y3                0.739    0.237    3.120    0.002
    y4                0.412    0.158    2.609    0.009
    y5                0.605    0.147    4.124    0.000
    y6                0.933    0.202    4.611    0.000

Covariances:
  y1 ~~
    y2                0.000
    y3                0.000
    y4                0.000
    y5                0.000
    y6                0.000
  y2 ~~
    y3                0.000
    y4                0.000
    y5                0.000
    y6                0.000
  y3 ~~
    y4                0.000
    y5                0.000
    y6                0.000
  y4 ~~
    y5                0.000
    y6                0.000
  y5 ~~
    y6                0.000

Intercepts:
    f1                0.000
    y1               -0.080    0.190   -0.419    0.675
    y2               -0.292    0.236   -1.238    0.216
    y3                0.132    0.255    0.515    0.606
    y4               -0.273    0.166   -1.645    0.100
    y5               -0.233    0.173   -1.349    0.177
    y6               -0.110    0.235   -0.469    0.639

Variances:
    f1                1.000
    y1                0.242    0.097
    y2                0.436    0.181
    y3                0.585    0.228
    y4                0.319    0.117
    y5                0.216    0.084
    y6                0.185    0.124

> 
> #Missing using logistic regression
> script <- 'y1 ~ 0.05 + 0.1*y2 + 0.3*y3
+ 	y4 ~ -2 + 0.1*y4
+ 	y5 ~ -0.5' 
> Missing2 <- miss(logit=script, pmMCAR=0.1, ignoreCols="group")
> summary(Missing2)
MISSING OBJECT
The method of missing data handling: Maximum Likelihood 
Covariates: none 
Ignored Variables: group 
Proportion of MCAR: 0.1 
Logistic-regression MAR:
y1 ~ 0.05 + 0.1*y2 + 0.3*y3
	y4 ~ -2 + 0.1*y4
	y5 ~ -0.5 
> datmiss2 <- impose(Missing2, dat)
> 
> #Missing using logistic regression (2)
> script <- 'y1 ~ 0.05 + 0.5*y3
+ 	y2 ~ p(0.2)
+ 	y3 ~ p(0.1) + -1*y1
+ 	y4 ~ p(0.3) + 0.2*y1 + -0.3*y2
+ 	y5 ~ -0.5' 
> Missing2 <- miss(logit=script)
> summary(Missing2)
MISSING OBJECT
The method of missing data handling: Maximum Likelihood 
Covariates: none 
Ignored Variables: none 
Logistic-regression MAR:
y1 ~ 0.05 + 0.5*y3
	y2 ~ p(0.2)
	y3 ~ p(0.1) + -1*y1
	y4 ~ p(0.3) + 0.2*y1 + -0.3*y2
	y5 ~ -0.5 
> datmiss2 <- impose(Missing2, dat)
> 
> #Example to create simMissing object for 3 forms design at 3 timepoints with 10 imputations
> Missing <- miss(nforms=3, timePoints=3, numImps=10)
> 
> #Missing template for data analysis with multiple imputation
> Missing <- miss(package="mice", m=10, chi="all", convergentCutoff=0.6)
> 
> 
> 
> cleanEx()
> nameEx("model")
> ### * model
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: model
> ### Title: Data generation template and analysis template for simulation.
> ### Aliases: model model.cfa model.path model.sem
> 
> ### ** Examples
> 
> # Example 1: Confirmatory factor analysis
> loading <- matrix(0, 6, 2)
> loading[1:3, 1] <- NA
> loading[4:6, 2] <- NA
> LY <- bind(loading, 0.7)
> 
> latent.cor <- matrix(NA, 2, 2)
> diag(latent.cor) <- 1
> RPS <- binds(latent.cor, 0.5)
> 
> RTE <- binds(diag(6))
> 
> VY <- bind(rep(NA,6),2)
> 
> CFA.Model <- model(LY = LY, RPS = RPS, RTE = RTE, modelType = "CFA")
> 
> # Example 2: Multiple-group CFA with weak invariance
> loading <- matrix(0, 6, 2)
> loading[1:3, 1] <- paste0("con", 1:3)
> loading[4:6, 2] <- paste0("con", 4:6)
> LY <- bind(loading, 0.7)
> 
> latent.cor <- matrix(NA, 2, 2)
> diag(latent.cor) <- 1
> RPS <- binds(latent.cor, 0.5)
> 
> RTE <- binds(diag(6))
> 
> VTE <- bind(rep(NA, 6), 0.51)
> 
> CFA.Model <- model(LY = LY, RPS = list(RPS, RPS), RTE = list(RTE, RTE), VTE=list(VTE, VTE), ngroups=2, modelType = "CFA")
> 
> # Example 3: Linear growth curve model with model misspecification
> factor.loading <- matrix(NA, 4, 2)
> factor.loading[,1] <- 1
> factor.loading[,2] <- 0:3
> LY <- bind(factor.loading)
> 
> factor.mean <- rep(NA, 2)
> factor.mean.starting <- c(5, 2)
> AL <- bind(factor.mean, factor.mean.starting)
> 
> factor.var <- rep(NA, 2)
> factor.var.starting <- c(1, 0.25)
> VPS <- bind(factor.var, factor.var.starting)
> 
> factor.cor <- matrix(NA, 2, 2)
> diag(factor.cor) <- 1
> RPS <- binds(factor.cor, 0.5)
> 
> VTE <- bind(rep(NA, 4), 1.2)
> 
> RTE <- binds(diag(4))
> 
> TY <- bind(rep(0, 4))
> 
> LCA.Model <- model(LY=LY, RPS=RPS, VPS=VPS, AL=AL, VTE=VTE, RTE=RTE, TY=TY, modelType="CFA")
> 
> # Example 4: Path analysis model with misspecified direct effect
> path.BE <- matrix(0, 4, 4)
> path.BE[3, 1:2] <- NA
> path.BE[4, 3] <- NA
> starting.BE <- matrix("", 4, 4)
> starting.BE[3, 1:2] <- "runif(1, 0.3, 0.5)"
> starting.BE[4, 3] <- "runif(1,0.5,0.7)"
> mis.path.BE <- matrix(0, 4, 4)
> mis.path.BE[4, 1:2] <- "runif(1,-0.1,0.1)"
> BE <- bind(path.BE, starting.BE, misspec=mis.path.BE)
> 
> residual.error <- diag(4)
> residual.error[1,2] <- residual.error[2,1] <- NA
> RPS <- binds(residual.error, "rnorm(1,0.3,0.1)")
> 
> ME <- bind(rep(NA, 4), 0)
> 
> Path.Model <- model(RPS = RPS, BE = BE, ME = ME, modelType="Path")
> 
> # Example 5: Full SEM model 
> loading <- matrix(0, 8, 3)
> loading[1:3, 1] <- NA
> loading[4:6, 2] <- NA
> loading[7:8, 3] <- "con1"
> loading.start <- matrix("", 8, 3)
> loading.start[1:3, 1] <- 0.7
> loading.start[4:6, 2] <- 0.7
> loading.start[7:8, 3] <- "rnorm(1,0.6,0.05)"
> LY <- bind(loading, loading.start)
> 
> RTE <- binds(diag(8))
> 
> factor.cor <- diag(3)
> factor.cor[1, 2] <- factor.cor[2, 1] <- NA
> RPS <- binds(factor.cor, 0.5)
> 
> path <- matrix(0, 3, 3)
> path[3, 1:2] <- NA
> path.start <- matrix(0, 3, 3)
> path.start[3, 1] <- "rnorm(1,0.6,0.05)"
> path.start[3, 2] <- "runif(1,0.3,0.5)"
> BE <- bind(path, path.start)
> 
> SEM.model <- model(BE=BE, LY=LY, RPS=RPS, RTE=RTE, modelType="SEM")
> 
> # Shortcut example
> SEM.model <- model.sem(BE=BE, LY=LY, RPS=RPS, RTE=RTE)
> 
> # Example 6: Multiple Group Model
> loading1 <- matrix(NA, 6, 1)
> LY1 <- bind(loading1, 0.7)
> loading2 <- matrix(0, 6, 2)
> loading2[1:3, 1] <- NA
> loading2[4:6, 2] <- NA
> LY2 <- bind(loading2, 0.7)
> 
> latent.cor2 <- matrix(NA, 2, 2)
> diag(latent.cor2) <- 1
> RPS1 <- binds(as.matrix(1))
> RPS2 <- binds(latent.cor2, 0.5)
> 
> RTE <- binds(diag(6))
> 
> VTE <- bind(rep(NA, 6), 0.51)
> 
> noninvariance <- model(LY = list(LY1, LY2), RPS = list(RPS1, RPS2), RTE = list(RTE, RTE), VTE=list(VTE, VTE), ngroups=2, modelType = "CFA")
> 
> # Example 7: Inequality Constraints
> 
> loading.in <- matrix(0, 6, 2)
> loading.in[1:3, 1] <- c("load1", "load2", "load3")
> loading.in[4:6, 2] <- c("load4", "load5", "load6")
> mis <- matrix(0,6,2)
> mis[loading.in == "0"] <- "runif(1, -0.1, 0.1)"
> LY.in <- bind(loading.in, "runif(1, 0.7, 0.8)", mis)
> 
> latent.cor <- matrix(NA, 2, 2)
> diag(latent.cor) <- 1
> RPS <- binds(latent.cor, 0.5)
> 
> RTE <- binds(diag(6))
> 
> VTE <- bind(rep(NA, 6), 0.51)
> 
> VPS1 <- bind(rep(1, 2))
> 
> VPS2 <- bind(rep(NA, 2), c(1.1, 1.2))
> 
> # Inequality constraint
> script <- "
+ sth := load1 + load2 + load3
+ load4 == (load5 + load6) / 2
+ load4 > 0
+ load5 > 0
+ sth2 := load1 - load2
+ "
> 
> # Model Template
> weak <- model(LY = LY.in, RPS = RPS, VPS=list(VPS1, VPS2), RTE = RTE, VTE=VTE, ngroups=2, modelType = "CFA", con=script)
> 
> 
> 
> cleanEx()
> nameEx("modelLavaan")
> ### * modelLavaan
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: model.lavaan
> ### Title: Build the data generation template and analysis template from
> ###   the lavaan result
> ### Aliases: model.lavaan
> 
> ### ** Examples
> 
> HS.model <- ' visual  =~ x1 + x2 + x3
+              textual =~ x4 + x5 + x6
+              speed   =~ x7 + x8 + x9 '
> 
> fit <- cfa(HS.model, data=HolzingerSwineford1939)
> 
> # Create data generation and data analysis model from lavaan
> # Data generation is based on standardized parameters
> datamodel1 <- model.lavaan(fit, std=TRUE)
> 
> # Data generation is based on unstandardized parameters
> datamodel2 <- model.lavaan(fit, std=FALSE)
> 
> # Data generation model with misspecification on cross-loadings
> crossload <- matrix("runif(1, -0.1, 0.1)", 9, 3)
> crossload[1:3, 1] <- 0
> crossload[4:6, 2] <- 0
> crossload[7:9, 3] <- 0
> datamodel3 <- model.lavaan(fit, std=TRUE, LY=crossload)
> 
> 
> 
> cleanEx()
> nameEx("multipleAllEqual")
> ### * multipleAllEqual
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: multipleAllEqual
> ### Title: Test whether all objects are equal
> ### Aliases: multipleAllEqual
> 
> ### ** Examples
> 
> multipleAllEqual(1:5, 1:5, seq(2, 10, 2)/2) # Should be TRUE
[1] TRUE
> multipleAllEqual(1:5, 1:6, seq(2, 10, 2)/2) # Should be FALSE
[1] FALSE
> 
> 
> 
> cleanEx()
> nameEx("pValue")
> ### * pValue
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: pValue
> ### Title: Find p-values (1 - percentile)
> ### Aliases: pValue pValue-methods pValue,ANY-method
> ###   pValue,numeric,vector-method pValue,numeric,data.frame-method
> ###   pValue,lavaan,SimResult-method
> 
> ### ** Examples
> 
> ## Not run: 
> ##D # Compare number with a vector
> ##D pValue(0.5, rnorm(1000, 0, 1))
> ##D 
> ##D # Compare numbers with a data frame
> ##D pValue(c(0.5, 0.2), data.frame(rnorm(1000, 0, 1), runif(1000, 0, 1)))
> ##D 
> ##D # Compare an analysis result with a result of simulation study
> ##D library(lavaan)
> ##D loading <- matrix(0, 9, 3)
> ##D loading[1:3, 1] <- NA
> ##D loading[4:6, 2] <- NA
> ##D loading[7:9, 3] <- NA
> ##D targetmodel <- estmodel(LY=loading, modelType="CFA", indLab=paste("x", 1:9, sep=""))
> ##D out <- analyze(targetmodel, HolzingerSwineford1939)
> ##D 
> ##D loading.trivial <- matrix("runif(1, -0.2, 0.2)", 9, 3)
> ##D loading.trivial[is.na(loading)] <- 0
> ##D mismodel <- model.lavaan(out, std=TRUE, LY=loading.trivial)
> ##D 
> ##D # The actual number of replications should be much greater than 20.
> ##D simout <- sim(20, n=nrow(HolzingerSwineford1939), mismodel)
> ##D 
> ##D # Find the p-value comparing the observed fit indices against the simulated 
> ##D # sampling distribution of fit indices
> ##D pValue(out, simout)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("pValueNested")
> ### * pValueNested
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: pValueNested
> ### Title: Find p-values (1 - percentile) for a nested model comparison
> ### Aliases: pValueNested
> 
> ### ** Examples
> 
> ## Not run: 
> ##D library(lavaan)
> ##D 
> ##D # Nested Model: Linear growth curve model
> ##D LY <- matrix(1, 4, 2)
> ##D LY[,2] <- 0:3
> ##D PS <- matrix(NA, 2, 2)
> ##D TY <- rep(0, 4)
> ##D AL <- rep(NA, 2)
> ##D TE <- diag(NA, 4)
> ##D nested <- estmodel(LY=LY, PS=PS, TY=TY, AL=AL, TE=TE, modelType="CFA", indLab=paste("t", 1:4, sep=""))
> ##D 
> ##D # Parent Model: Unconditional growth curve model
> ##D LY2 <- matrix(1, 4, 2)
> ##D LY2[,2] <- c(0, NA, NA, 3)
> ##D parent <- estmodel(LY=LY2, PS=PS, TY=TY, AL=AL, TE=TE, modelType="CFA", indLab=paste("t", 1:4, sep=""))
> ##D 
> ##D # Analyze the output
> ##D outNested <- analyze(nested, Demo.growth)
> ##D outParent <- analyze(parent, Demo.growth)
> ##D 
> ##D # Create data template from the nested model with small misfit on the linear curve
> ##D loadingMis <- matrix(0, 4, 2)
> ##D loadingMis[2:3, 2] <- "runif(1, -0.1, 0.1)"
> ##D datamodel <- model.lavaan(outNested, LY=loadingMis)
> ##D 
> ##D # Get the sample size
> ##D n <- nrow(Demo.growth)
> ##D 
> ##D # The actual replications should be much greater than 30.
> ##D simNestedNested <- sim(30, n=n, nested, generate=datamodel) 
> ##D simNestedParent <- sim(30, n=n, parent, generate=datamodel)
> ##D 
> ##D # Find the p-value comparing the observed fit indices against the simulated 
> ##D # sampling distribution of fit indices
> ##D pValueNested(outNested, outParent, simNestedNested, simNestedParent)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("pValueNonNested")
> ### * pValueNonNested
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: pValueNonNested
> ### Title: Find p-values (1 - percentile) for a non-nested model comparison
> ### Aliases: pValueNonNested
> 
> ### ** Examples
> 
> ## Not run: 
> ##D # Model A; Factor 1 --> Factor 2; Factor 2 --> Factor 3
> ##D library(lavaan)
> ##D loading <- matrix(0, 11, 3)
> ##D loading[1:3, 1] <- NA
> ##D loading[4:7, 2] <- NA
> ##D loading[8:11, 3] <- NA
> ##D path.A <- matrix(0, 3, 3)
> ##D path.A[2, 1] <- NA
> ##D path.A[3, 2] <- NA
> ##D model.A <- estmodel(LY=loading, BE=path.A, modelType="SEM", indLab=c(paste("x", 1:3, sep=""), paste("y", 1:8, sep="")))
> ##D 
> ##D out.A <- analyze(model.A, PoliticalDemocracy)
> ##D 
> ##D # Model A; Factor 1 --> Factor 3; Factor 3 --> Factor 2
> ##D path.B <- matrix(0, 3, 3)
> ##D path.B[3, 1] <- NA
> ##D path.B[2, 3] <- NA
> ##D model.B <- estmodel(LY=loading, BE=path.B, modelType="SEM", indLab=c(paste("x", 1:3, sep=""), paste("y", 1:8, sep="")))
> ##D 
> ##D out.B <- analyze(model.B, PoliticalDemocracy)
> ##D 
> ##D loading.mis <- matrix("runif(1, -0.2, 0.2)", 11, 3)
> ##D loading.mis[is.na(loading)] <- 0
> ##D 
> ##D # Create SimSem object for data generation and data analysis template
> ##D datamodel.A <- model.lavaan(out.A, std=TRUE, LY=loading.mis)
> ##D datamodel.B <- model.lavaan(out.B, std=TRUE, LY=loading.mis)
> ##D 
> ##D # Get sample size
> ##D n <- nrow(PoliticalDemocracy)
> ##D 
> ##D # The actual number of replications should be greater than 20.
> ##D output.A.A <- sim(20, n=n, model.A, generate=datamodel.A) 
> ##D output.A.B <- sim(20, n=n, model.B, generate=datamodel.A)
> ##D output.B.A <- sim(20, n=n, model.A, generate=datamodel.B)
> ##D output.B.B <- sim(20, n=n, model.B, generate=datamodel.B)
> ##D 
> ##D # Find the p-value comparing the observed fit indices against the simulated 
> ##D # sampling distribution of fit indices
> ##D 
> ##D pValueNonNested(out.A, out.B, output.A.A, output.A.B, output.B.A, output.B.B)
> ##D 
> ##D # If the p-value for model A is significant but the p-value for model B is not
> ##D # significant, model B is preferred.
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("plotCutoff")
> ### * plotCutoff
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plotCutoff
> ### Title: Plot sampling distributions of fit indices with fit indices
> ###   cutoffs
> ### Aliases: plotCutoff plotCutoff-methods plotCutoff,data.frame-method
> ###   plotCutoff,SimResult-method
> 
> ### ** Examples
> 
> ## Not run: 
> ##D loading <- matrix(0, 6, 2)
> ##D loading[1:3, 1] <- NA
> ##D loading[4:6, 2] <- NA
> ##D loadingValues <- matrix(0, 6, 2)
> ##D loadingValues[1:3, 1] <- 0.7
> ##D loadingValues[4:6, 2] <- 0.7
> ##D LY <- bind(loading, loadingValues)
> ##D latent.cor <- matrix(NA, 2, 2)
> ##D diag(latent.cor) <- 1
> ##D RPS <- binds(latent.cor, 0.5)
> ##D error.cor <- matrix(0, 6, 6)
> ##D diag(error.cor) <- 1
> ##D RTE <- binds(error.cor)
> ##D CFA.Model <- model(LY = LY, RPS = RPS, RTE = RTE, modelType="CFA")
> ##D 
> ##D # We make the examples running only 5 replications to save time.
> ##D # In reality, more replications are needed.
> ##D Output <- sim(5, n=200, model=CFA.Model) 
> ##D 
> ##D # Plot the cutoffs with desired fit indices
> ##D plotCutoff(Output, 0.05, usedFit=c("RMSEA", "SRMR", "CFI", "TLI"))
> ##D 
> ##D # The example of continous varying sample size. Note that more fine-grained 
> ##D # values of n is needed, e.g., n=seq(50, 500, 1)
> ##D Output2 <- sim(NULL, n=seq(450, 500, 10), model=CFA.Model)
> ##D 
> ##D # Plot the cutoffs along sample size value
> ##D plotCutoff(Output2, 0.05)
> ##D 
> ##D # Specify both continuoussample size and percent missing completely at random. Note that more fine-grained 
> ##D # values of n and pmMCAR is needed, e.g., n=seq(50, 500, 1) and pmMCAR=seq(0, 0.2, 0.01)
> ##D Output3 <- sim(NULL, n=seq(450, 500, 10), pmMCAR=c(0, 0.05, 0.1, 0.15), model=CFA.Model)
> ##D 
> ##D # Plot the contours that each contour represents the value of cutoff at each level
> ##D # of sample size and percent missing completely at random
> ##D plotCutoff(Output3, 0.05)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("plotCutoffNested")
> ### * plotCutoffNested
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plotCutoffNested
> ### Title: Plot sampling distributions of the differences in fit indices
> ###   between nested models with fit indices cutoffs
> ### Aliases: plotCutoffNested
> 
> ### ** Examples
> 
> ## Not run: 
> ##D # Nested model: One factor
> ##D loading.null <- matrix(0, 6, 1)
> ##D loading.null[1:6, 1] <- NA
> ##D LY.NULL <- bind(loading.null, 0.7)
> ##D RPS.NULL <- binds(diag(1))
> ##D RTE <- binds(diag(6))
> ##D CFA.Model.NULL <- model(LY = LY.NULL, RPS = RPS.NULL, RTE = RTE, modelType="CFA")
> ##D 
> ##D # Parent model: two factors
> ##D loading.alt <- matrix(0, 6, 2)
> ##D loading.alt[1:3, 1] <- NA
> ##D loading.alt[4:6, 2] <- NA
> ##D LY.ALT <- bind(loading.alt, 0.7)
> ##D latent.cor.alt <- matrix(NA, 2, 2)
> ##D diag(latent.cor.alt) <- 1
> ##D RPS.ALT <- binds(latent.cor.alt, "runif(1, 0.7, 0.9)")
> ##D CFA.Model.ALT <- model(LY = LY.ALT, RPS = RPS.ALT, RTE = RTE, modelType="CFA")
> ##D 
> ##D # The actual number of replications should be greater than 10.
> ##D Output.NULL.NULL <- sim(10, n=500, model=CFA.Model.NULL) 
> ##D Output.NULL.ALT <- sim(10, n=500, model=CFA.Model.ALT, generate=CFA.Model.NULL)
> ##D 
> ##D # Plot the cutoffs in nested model comparison
> ##D plotCutoffNested(Output.NULL.NULL, Output.NULL.ALT, alpha=0.05)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("plotCutoffNonNested")
> ### * plotCutoffNonNested
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plotCutoffNonNested
> ### Title: Plot sampling distributions of the differences in fit indices
> ###   between non-nested models with fit indices cutoffs
> ### Aliases: plotCutoffNonNested
> 
> ### ** Examples
> 
> ## Not run: 
> ##D # Model A: Factor 1 on Items 1-3 and Factor 2 on Items 4-8
> ##D loading.A <- matrix(0, 8, 2)
> ##D loading.A[1:3, 1] <- NA
> ##D loading.A[4:8, 2] <- NA
> ##D LY.A <- bind(loading.A, 0.7)
> ##D latent.cor <- matrix(NA, 2, 2)
> ##D diag(latent.cor) <- 1
> ##D RPS <- binds(latent.cor, "runif(1, 0.7, 0.9)")
> ##D RTE <- binds(diag(8))
> ##D CFA.Model.A <- model(LY = LY.A, RPS = RPS, RTE = RTE, modelType="CFA")
> ##D 
> ##D # Model B: Factor 1 on Items 1-4 and Factor 2 on Items 5-8
> ##D loading.B <- matrix(0, 8, 2)
> ##D loading.B[1:4, 1] <- NA
> ##D loading.B[5:8, 2] <- NA
> ##D LY.B <- bind(loading.B, 0.7)
> ##D CFA.Model.B <- model(LY = LY.B, RPS = RPS, RTE = RTE, modelType="CFA")
> ##D 
> ##D # The actual number of replications should be greater than 10.
> ##D Output.A.A <- sim(10, n=500, model=CFA.Model.A, generate=CFA.Model.A)
> ##D Output.A.B <- sim(10, n=500, model=CFA.Model.B, generate=CFA.Model.A)
> ##D Output.B.A <- sim(10, n=500, model=CFA.Model.A, generate=CFA.Model.B)
> ##D Output.B.B <- sim(10, n=500, model=CFA.Model.B, generate=CFA.Model.B)
> ##D 
> ##D # Plot cutoffs for both model A and model B
> ##D plotCutoffNonNested(Output.A.A, Output.A.B, Output.B.A, Output.B.B)
> ##D 
> ##D # Plot cutoffs for the model A only
> ##D plotCutoffNonNested(Output.A.A, Output.A.B)
> ##D 
> ##D # Plot cutoffs for the model A with one-tailed test
> ##D plotCutoffNonNested(Output.A.A, Output.A.B, onetailed=TRUE)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("plotDist")
> ### * plotDist
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plotDist
> ### Title: Plot a distribution of a data distribution object
> ### Aliases: plotDist
> 
> ### ** Examples
> 
> datadist <- bindDist(c("chisq", "t", "f"), list(df=5), list(df=3), list(df1=3, df2=5))
> 
> # Plot the joint distribution of Variables 1 and 2 with correlation of 0.5
> plotDist(datadist, r=0.5, var=1:2)
> 
> # Plot the marginal distribution of the variable 3
> plotDist(datadist, var=3)
> 
> 
> 
> cleanEx()
> nameEx("plotLogitMiss")
> ### * plotLogitMiss
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plotLogitMiss
> ### Title: Visualize the missing proportion when the logistic regression
> ###   method is used.
> ### Aliases: plotLogitMiss
> 
> ### ** Examples
> 
> script <- 'y1 ~ 0.05 + 0.1*y2 + 0.3*y3
+ 	y4 ~ -2 + 0.1*y4
+ 	y5 ~ -0.5' 
> plotLogitMiss(script)
> 
> script2 <- 'y1 ~ 0.05 + 0.5*y3
+ 	y2 ~ p(0.2)
+ 	y3 ~ p(0.1) + -1*y1
+ 	y4 ~ p(0.3) + 0.2*y1 + -0.3*y2
+ 	y5 ~ -0.5' 
> plotLogitMiss(script2)
> 
> 
> 
> cleanEx()
> nameEx("plotMisfit")
> ### * plotMisfit
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plotMisfit
> ### Title: Plot the population misfit in the result object
> ### Aliases: plotMisfit
> 
> ### ** Examples
> 
> path.BE <- matrix(0, 4, 4)
> path.BE[3, 1:2] <- NA
> path.BE[4, 3] <- NA
> starting.BE <- matrix("", 4, 4)
> starting.BE[3, 1:2] <- "runif(1, 0.3, 0.5)"
> starting.BE[4, 3] <- "runif(1, 0.5, 0.7)"
> mis.path.BE <- matrix(0, 4, 4)
> mis.path.BE[4, 1:2] <- "runif(1, -0.1, 0.1)"
> BE <- bind(path.BE, starting.BE, misspec=mis.path.BE)
> 
> residual.error <- diag(4)
> residual.error[1,2] <- residual.error[2,1] <- NA
> RPS <- binds(residual.error, "rnorm(1, 0.3, 0.1)")
> 
> ME <- bind(rep(NA, 4), 0)
> 
> Path.Model <- model(RPS = RPS, BE = BE, ME = ME, modelType="Path")
> 
> # The number of replications in actual analysis should be much more than 20
> Output <- sim(20, n=500, Path.Model)
Loading required package: parallel
> 
> # Plot the distribution of population misfit
> plotMisfit(Output)
> 
> # Plot the relationship between population RMSEA and all misspecified direct effects
> plotMisfit(Output, misParam=1:2)
> 
> # Plot the relationship between sample CFI and all misspecified direct effects 
> plotMisfit(Output, usedFit="CFI", misParam=1:2)
> 
> 
> 
> cleanEx()

detaching 'package:parallel'

> nameEx("plotPower")
> ### * plotPower
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plotPower
> ### Title: Make a power plot of a parameter given varying parameters
> ### Aliases: plotPower
> 
> ### ** Examples
> 
> ## Not run: 
> ##D loading <- matrix(0, 6, 1)
> ##D loading[1:6, 1] <- NA
> ##D LY <- bind(loading, 0.4)
> ##D RPS <- binds(diag(1))
> ##D RTE <- binds(diag(6))
> ##D CFA.Model <- model(LY = LY, RPS = RPS, RTE = RTE, modelType="CFA")
> ##D 
> ##D # Specify both continuous sample size and percent missing completely at random. Note that more fine-grained 
> ##D # values of n and pmMCAR is needed, e.g., n=seq(50, 500, 1) and pmMCAR=seq(0, 0.2, 0.01)
> ##D 
> ##D Output <- sim(NULL, n=seq(100, 200, 20), pmMCAR=c(0, 0.1, 0.2), model=CFA.Model)
> ##D 
> ##D # Plot the power of the first factor loading along the sample size value
> ##D plotPower(Output, "1.f1=~y1", contMCAR=FALSE)
> ##D 
> ##D # Plot the power of the correlation along the sample size and percent missing completely at random
> ##D plotPower(Output, "1.f1=~y1")
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("plotPowerFit")
> ### * plotPowerFit
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plotPowerFit
> ### Title: Plot sampling distributions of fit indices that visualize power
> ###   of rejecting datasets underlying misspecified models
> ### Aliases: plotPowerFit
> 
> ### ** Examples
> 
> ## Not run: 
> ##D # Null model: One factor model
> ##D loading.null <- matrix(0, 6, 1)
> ##D loading.null[1:6, 1] <- NA
> ##D LY.NULL <- bind(loading.null, 0.7)
> ##D RPS.NULL <- binds(diag(1))
> ##D RTE <- binds(diag(6))
> ##D CFA.Model.NULL <- model(LY = LY.NULL, RPS = RPS.NULL, RTE = RTE, modelType="CFA")
> ##D 
> ##D # We make the examples running only 5 replications to save time.
> ##D # In reality, more replications are needed.
> ##D Output.NULL <- sim(50, n=50, model=CFA.Model.NULL, generate=CFA.Model.NULL) 
> ##D 
> ##D # Alternative model: Two-factor model
> ##D loading.alt <- matrix(0, 6, 2)
> ##D loading.alt[1:3, 1] <- NA
> ##D loading.alt[4:6, 2] <- NA
> ##D LY.ALT <- bind(loading.alt, 0.7)
> ##D latent.cor.alt <- matrix(NA, 2, 2)
> ##D diag(latent.cor.alt) <- 1
> ##D RPS.ALT <- binds(latent.cor.alt, 0.5)
> ##D CFA.Model.ALT <- model(LY = LY.ALT, RPS = RPS.ALT, RTE = RTE, modelType="CFA")
> ##D Output.ALT <- sim(50, n=50, model=CFA.Model.NULL, generate=CFA.Model.ALT)
> ##D 
> ##D # Plot the power based on derived cutoff from the null model using four fit indices
> ##D plotPowerFit(Output.ALT, nullObject=Output.NULL, alpha=0.05, usedFit=c("RMSEA", "CFI", "TLI", "SRMR"))
> ##D 
> ##D # Plot the power of rejecting null model when the rule of thumb from Hu & Bentler (1999) is used
> ##D Rule.of.thumb <- c(RMSEA=0.05, CFI=0.95, TLI=0.95, SRMR=0.06)
> ##D plotPowerFit(Output.ALT, cutoff=Rule.of.thumb, alpha=0.05, usedFit=c("RMSEA", "CFI", "TLI", "SRMR"))
> ##D 
> ##D # The example of continous varying sample size. Note that more fine-grained 
> ##D # values of n is needed, e.g., n=seq(50, 500, 1)
> ##D Output.NULL2 <- sim(NULL, n=seq(50, 250, 25), model=CFA.Model.NULL, generate=CFA.Model.NULL)
> ##D Output.ALT2 <- sim(NULL, n=seq(50, 250, 25), model=CFA.Model.NULL, generate=CFA.Model.ALT)
> ##D 
> ##D # Plot the power based on derived cutoff from the null model using four fit indices along sample size
> ##D plotPowerFit(Output.ALT2, nullObject=Output.NULL2, alpha=0.05, usedFit=c("RMSEA", "CFI", "TLI", "SRMR"))
> ##D 
> ##D # Plot the power based on rule of thumb along sample size
> ##D plotPowerFit(Output.ALT2, cutoff=Rule.of.thumb, alpha=0.05, usedFit=c("RMSEA", "CFI", "TLI", "SRMR"))
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("plotPowerFitNested")
> ### * plotPowerFitNested
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plotPowerFitNested
> ### Title: Plot power of rejecting a nested model in a nested model
> ###   comparison by each fit index
> ### Aliases: plotPowerFitNested
> 
> ### ** Examples
> 
> ## Not run: 
> ##D # Null model: One-factor model
> ##D loading.null <- matrix(0, 6, 1)
> ##D loading.null[1:6, 1] <- NA
> ##D LY.NULL <- bind(loading.null, 0.7)
> ##D RPS.NULL <- binds(diag(1))
> ##D RTE <- binds(diag(6))
> ##D CFA.Model.NULL <- model(LY = LY.NULL, RPS = RPS.NULL, RTE = RTE, modelType="CFA")
> ##D 
> ##D # Alternative model: Two-factor model
> ##D loading.alt <- matrix(0, 6, 2)
> ##D loading.alt[1:3, 1] <- NA
> ##D loading.alt[4:6, 2] <- NA
> ##D LY.ALT <- bind(loading.alt, 0.7)
> ##D latent.cor.alt <- matrix(NA, 2, 2)
> ##D diag(latent.cor.alt) <- 1
> ##D RPS.ALT <- binds(latent.cor.alt, 0.7)
> ##D CFA.Model.ALT <- model(LY = LY.ALT, RPS = RPS.ALT, RTE = RTE, modelType="CFA")
> ##D 
> ##D # In reality, more than 10 replications are needed
> ##D Output.NULL.NULL <- sim(10, n=500, model=CFA.Model.NULL, generate=CFA.Model.NULL) 
> ##D Output.ALT.NULL <- sim(10, n=500, model=CFA.Model.NULL, generate=CFA.Model.ALT) 
> ##D Output.NULL.ALT <- sim(10, n=500, model=CFA.Model.ALT, generate=CFA.Model.NULL) 
> ##D Output.ALT.ALT <- sim(10, n=500, model=CFA.Model.ALT, generate=CFA.Model.ALT) 
> ##D 
> ##D # Plot the power based on the derived cutoff from the models analyzed on the null datasets
> ##D plotPowerFitNested(Output.ALT.NULL, Output.ALT.ALT, nullNested=Output.NULL.NULL, nullParent=Output.NULL.ALT)
> ##D 
> ##D # Plot the power by only CFI
> ##D plotPowerFitNested(Output.ALT.NULL, Output.ALT.ALT, nullNested=Output.NULL.NULL, nullParent=Output.NULL.ALT, usedFit="CFI")
> ##D 
> ##D # The example of continous varying sample size. Note that more fine-grained 
> ##D # values of n is needed, e.g., n=seq(50, 500, 1)
> ##D Output.NULL.NULL2 <- sim(NULL, n=seq(50, 500, 25), model=CFA.Model.NULL, generate=CFA.Model.NULL) 
> ##D Output.ALT.NULL2 <- sim(NULL, n=seq(50, 500, 25), model=CFA.Model.NULL, generate=CFA.Model.ALT) 
> ##D Output.NULL.ALT2 <- sim(NULL, n=seq(50, 500, 25), model=CFA.Model.ALT, generate=CFA.Model.NULL) 
> ##D Output.ALT.ALT2 <- sim(NULL, n=seq(50, 500, 25), model=CFA.Model.ALT, generate=CFA.Model.ALT) 
> ##D 
> ##D # Plot logistic line for the power based on the derived cutoff from the null model along sample size values
> ##D plotPowerFitNested(Output.ALT.NULL2, Output.ALT.ALT2, nullNested=Output.NULL.NULL2, nullParent=Output.NULL.ALT2)
> ##D 
> ##D # Plot scatterplot for the power based on the derived cutoff from the null model along sample size values
> ##D plotPowerFitNested(Output.ALT.NULL2, Output.ALT.ALT2, nullNested=Output.NULL.NULL2, nullParent=Output.NULL.ALT2, logistic=FALSE)
> ##D 
> ##D # Plot scatterplot for the power based on the advanced CFI value
> ##D plotPowerFitNested(Output.ALT.NULL2, Output.ALT.ALT2, cutoff=c(CFI=-0.1), logistic=FALSE)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("plotPowerFitNonNested")
> ### * plotPowerFitNonNested
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plotPowerFitNonNested
> ### Title: Plot power of rejecting a non-nested model based on a difference
> ###   in fit index
> ### Aliases: plotPowerFitNonNested
> 
> ### ** Examples
> 
> ## Not run: 
> ##D # Model A: Factor 1 on Items 1-3 and Factor 2 on Items 4-8
> ##D loading.A <- matrix(0, 8, 2)
> ##D loading.A[1:3, 1] <- NA
> ##D loading.A[4:8, 2] <- NA
> ##D LY.A <- bind(loading.A, 0.7)
> ##D latent.cor <- matrix(NA, 2, 2)
> ##D diag(latent.cor) <- 1
> ##D RPS <- binds(latent.cor, "runif(1, 0.7, 0.9)")
> ##D RTE <- binds(diag(8))
> ##D CFA.Model.A <- model(LY = LY.A, RPS = RPS, RTE = RTE, modelType="CFA")
> ##D 
> ##D # Model B: Factor 1 on Items 1-4 and Factor 2 on Items 5-8
> ##D loading.B <- matrix(0, 8, 2)
> ##D loading.B[1:4, 1] <- NA
> ##D loading.B[5:8, 2] <- NA
> ##D LY.B <- bind(loading.B, 0.7)
> ##D CFA.Model.B <- model(LY = LY.B, RPS = RPS, RTE = RTE, modelType="CFA")
> ##D 
> ##D # The actual number of replications should be greater than 10.
> ##D Output.A.A <- sim(10, n=500, model=CFA.Model.A, generate=CFA.Model.A)
> ##D Output.A.B <- sim(10, n=500, model=CFA.Model.B, generate=CFA.Model.A)
> ##D Output.B.A <- sim(10, n=500, model=CFA.Model.A, generate=CFA.Model.B)
> ##D Output.B.B <- sim(10, n=500, model=CFA.Model.B, generate=CFA.Model.B)
> ##D 
> ##D # Plot the power based on the derived cutoff for both models
> ##D plotPowerFitNonNested(Output.B.A, Output.B.B, dat1Mod1=Output.A.A, dat1Mod2=Output.A.B)
> ##D 
> ##D # Plot the power based on AIC and BIC cutoffs
> ##D plotPowerFitNonNested(Output.B.A, Output.B.B, cutoff=c(AIC=0, BIC=0))
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("popDiscrepancy")
> ### * popDiscrepancy
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: popDiscrepancy
> ### Title: Find the discrepancy value between two means and covariance
> ###   matrices
> ### Aliases: popDiscrepancy
> 
> ### ** Examples
> 
> m1 <- rep(0, 3)
> m2 <- c(0.1, -0.1, 0.05)
> S1 <- matrix(c(1, 0.6, 0.5, 0.6, 1, 0.4, 0.5, 0.4, 1), 3, 3)
> S2 <- matrix(c(1, 0.55, 0.55, 0.55, 1, 0.55, 0.55, 0.55, 1), 3, 3)
> popDiscrepancy(m1, S1, m2, S2)
         [,1]
[1,] 0.116864
> 
> 
> 
> cleanEx()
> nameEx("popMisfitMACS")
> ### * popMisfitMACS
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: popMisfitMACS
> ### Title: Find population misfit by sufficient statistics
> ### Aliases: popMisfitMACS
> 
> ### ** Examples
> 
> m1 <- rep(0, 3)
> m2 <- c(0.1, -0.1, 0.05)
> S1 <- matrix(c(1, 0.6, 0.5, 0.6, 1, 0.4, 0.5, 0.4, 1), 3, 3)
> S2 <- matrix(c(1, 0.55, 0.55, 0.55, 1, 0.55, 0.55, 0.55, 1), 3, 3)
> popMisfitMACS(m1, S1, m2, S2)
        f0       srmr 
0.11686397 0.03191424 
> 
> 
> 
> cleanEx()
> nameEx("rawDraw")
> ### * rawDraw
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: rawDraw
> ### Title: Draw values from vector or matrix objects
> ### Aliases: rawDraw
> 
> ### ** Examples
> 
> loading <- matrix(0, 7, 3)
> loading[1:3, 1] <- NA
> loading[4:6, 2] <- NA
> loading[1:7, 3] <- NA
> loadingVal <- matrix(0, 7, 3)
> loadingVal[1:3, 1] <- "runif(1, 0.5, 0.7)"
> loadingVal[4:6, 2] <- "runif(1, 0.5, 0.7)"
> loadingVal[1:6, 3] <- "runif(1, 0.3, 0.5)"
> loadingVal[7, 3] <- 1
> loading.mis <- matrix("runif(1, -0.2, 0.2)", 7, 3)
> loading.mis[is.na(loading)] <- 0
> loading.mis[,3] <- 0
> loading.mis[7,] <- 0
> loading[1:3, 1] <- "con1"
> LY <- bind(loading, loadingVal, misspec=loading.mis)
> 
> # Draw values
> rawDraw(LY)
$param
         [,1]      [,2]      [,3]
[1,] 0.576007 0.0000000 0.4739382
[2,] 0.576007 0.0000000 0.3680698
[3,] 0.576007 0.0000000 0.3964160
[4,] 0.000000 0.5772228 0.4199132
[5,] 0.000000 0.5026781 0.3987083
[6,] 0.000000 0.5764776 0.3372435
[7,] 0.000000 0.0000000 1.0000000

$paramMis
           [,1]        [,2]      [,3]
[1,]  0.5760070  0.06066951 0.4739382
[2,]  0.5760070 -0.14977796 0.3680698
[3,]  0.5760070 -0.09311173 0.3964160
[4,]  0.1109781  0.57722282 0.4199132
[5,]  0.1738821  0.50267807 0.3987083
[6,] -0.1151430  0.57647759 0.3372435
[7,]  0.0000000  0.00000000 1.0000000

$missRaw
           [,1]        [,2] [,3]
[1,]  0.0000000  0.06066951    0
[2,]  0.0000000 -0.14977796    0
[3,]  0.0000000 -0.09311173    0
[4,]  0.1109781  0.00000000    0
[5,]  0.1738821  0.00000000    0
[6,] -0.1151430  0.00000000    0
[7,]  0.0000000  0.00000000    0

> 
> # Draw only model parameters containing misspecification
> rawDraw(LY, parMisOnly=TRUE)
           [,1]        [,2]      [,3]
[1,]  0.6654747  0.08948438 0.4059439
[2,]  0.6654747 -0.03549023 0.4578712
[3,]  0.6654747  0.12837852 0.3046662
[4,]  0.0673867  0.62941204 0.3954460
[5,]  0.1176959  0.65658655 0.4464627
[6,] -0.1568225  0.61060726 0.4385463
[7,]  0.0000000  0.00000000 1.0000000
> 
> # Draw only misspecification.
> rawDraw(LY, misOnly=TRUE)
            [,1]        [,2] [,3]
[1,]  0.00000000 -0.17172838    0
[2,]  0.00000000 -0.16021354    0
[3,]  0.00000000 -0.07349132    0
[4,]  0.14448379  0.00000000    0
[5,] -0.02476116  0.00000000    0
[6,] -0.10208109  0.00000000    0
[7,]  0.00000000  0.00000000    0
> 
> 
> 
> cleanEx()
> nameEx("setPopulation")
> ### * setPopulation
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: setPopulation
> ### Title: Set the data generation population model underlying an object
> ### Aliases: setPopulation
> 
> ### ** Examples
> 
> # See each class for an example.
> ## Not run: 
> ##D # Data generation model
> ##D loading <- matrix(0, 7, 3)
> ##D loading[1:3, 1] <- NA
> ##D loading[4:6, 2] <- NA
> ##D loading[1:7, 3] <- NA
> ##D loadingVal <- matrix(0, 7, 3)
> ##D loadingVal[1:3, 1] <- "runif(1, 0.5, 0.7)"
> ##D loadingVal[4:6, 2] <- "runif(1, 0.5, 0.7)"
> ##D loadingVal[1:6, 3] <- "runif(1, 0.3, 0.5)"
> ##D loadingVal[7, 3] <- 1
> ##D loading.mis <- matrix("runif(1, -0.2, 0.2)", 7, 3)
> ##D loading.mis[is.na(loading)] <- 0
> ##D loading.mis[,3] <- 0
> ##D loading.mis[7,] <- 0
> ##D LY <- bind(loading, loadingVal, misspec=loading.mis)
> ##D 
> ##D RPS <- binds(diag(3))
> ##D 
> ##D path <- matrix(0, 3, 3)
> ##D path[2, 1] <- NA
> ##D BE <- bind(path, "runif(1, 0.3, 0.5)")
> ##D 
> ##D RTE <- binds(diag(7))
> ##D 
> ##D VY <- bind(c(rep(NA, 6), 0), c(rep(1, 6), ""))
> ##D 
> ##D datamodel <- model(LY=LY, RPS=RPS, BE=BE, RTE=RTE, VY=VY, modelType="SEM")
> ##D 
> ##D # Data analysis model
> ##D loading <- matrix(0, 7, 3)
> ##D loading[1:3, 1] <- NA
> ##D loading[4:6, 2] <- NA
> ##D loading[7, 3] <- NA
> ##D path <- matrix(0, 3, 3)
> ##D path[2, 1] <- NA
> ##D path[1, 3] <- NA
> ##D path[2, 3] <- NA
> ##D errorCov <- diag(NA, 7)
> ##D errorCov[7, 7] <- 0
> ##D facCov <- diag(3)
> ##D analysis <- estmodel(LY=loading, BE=path, TE=errorCov, PS=facCov, modelType="SEM", indLab=paste("y", 1:7, sep=""))
> ##D 
> ##D # In reality, more than 10 replications are needed.
> ##D Output <- sim(10, n=200, analysis, generate=datamodel)
> ##D 
> ##D # Population 
> ##D loadingVal <- matrix(0, 7, 3)
> ##D loadingVal[1:3, 1] <- 0.6
> ##D loadingVal[4:6, 2] <- 0.6
> ##D loadingVal[7, 3] <- 1
> ##D LY <- bind(loading, loadingVal)
> ##D pathVal <- matrix(0, 3, 3)
> ##D pathVal[2, 1] <- 0.4
> ##D pathVal[1, 3] <- 0.4
> ##D pathVal[2, 3] <- 0.4
> ##D BE <- bind(path, pathVal)
> ##D PS <- binds(facCov)
> ##D errorCovVal <- diag(0.64, 7)
> ##D errorCovVal[7, 7] <- 0
> ##D TE <- binds(errorCov, errorCovVal)
> ##D population <- model(LY=LY, PS=PS, BE=BE, TE=TE, modelType="SEM")
> ##D 
> ##D # Set up the new population
> ##D Output <- setPopulation(Output, population) 
> ##D 
> ##D # This summary will contain the bias information
> ##D summary(Output)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("sim")
> ### * sim
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: sim
> ### Title: Run a monte carlo simulation with a structural equation model.
> ### Aliases: sim
> 
> ### ** Examples
> 
> # Please go to www.simsem.org for more examples.
> 
> # Example of using simsem model template
> 
> loading <- matrix(0, 6, 2)
> loading[1:3, 1] <- NA
> loading[4:6, 2] <- NA
> LY <- bind(loading, 0.7)
> 
> latent.cor <- matrix(NA, 2, 2)
> diag(latent.cor) <- 1
> RPS <- binds(latent.cor, 0.5)
> 
> RTE <- binds(diag(6))
> 
> VY <- bind(rep(NA,6),2)
> 
> CFA.Model <- model(LY = LY, RPS = RPS, RTE = RTE, modelType = "CFA")
> 
> # In reality, more than 5 replications are needed.
> Output <- sim(5, CFA.Model, n=200)
Loading required package: parallel
> summary(Output)
RESULT OBJECT
Model Type
[1] "cfa"
========= Fit Indices Cutoffs ============
           Alpha
Fit Indices      0.1     0.05     0.01    0.001     Mean     SD
      chisq   16.675   19.341   21.474   21.954    9.193  7.614
      aic   3147.136 3155.092 3161.457 3162.890 3114.008 38.008
      bic   3209.804 3217.760 3224.125 3225.558 3176.676 38.008
      rmsea    0.064    0.079    0.091    0.093    0.026  0.039
      cfi      0.972    0.964    0.957    0.955    0.990  0.020
      tli      0.948    0.932    0.919    0.916    0.996  0.049
      srmr     0.042    0.046    0.049    0.050    0.028  0.013
========= Parameter Estimates and Standard Errors ============
       Estimate.Average Estimate.SD Average.SE Power..Not.equal.0. Std.Est
f1=~y1            0.629       0.057      0.072                 1.0   0.651
f1=~y2            0.728       0.027      0.074                 1.0   0.736
f1=~y3            0.699       0.088      0.075                 1.0   0.692
f2=~y4            0.678       0.067      0.073                 1.0   0.694
f2=~y5            0.685       0.086      0.073                 1.0   0.697
f2=~y6            0.704       0.086      0.074                 1.0   0.707
f1~~f2            0.453       0.141      0.081                 1.0   0.453
y1~~y1            0.534       0.051      0.073                 1.0   0.574
y2~~y2            0.455       0.128      0.079                 1.0   0.455
y3~~y3            0.522       0.066      0.080                 1.0   0.517
y4~~y4            0.491       0.083      0.074                 1.0   0.515
y5~~y5            0.489       0.083      0.074                 1.0   0.511
y6~~y6            0.491       0.073      0.076                 1.0   0.498
y1~1              0.023       0.113      0.068                 0.2   0.023
y2~1              0.023       0.072      0.070                 0.0   0.022
y3~1              0.024       0.102      0.071                 0.2   0.022
y4~1             -0.069       0.080      0.069                 0.2  -0.071
y5~1             -0.031       0.068      0.069                 0.0  -0.032
y6~1             -0.015       0.092      0.070                 0.0  -0.016
       Std.Est.SD Average.Param Average.Bias Coverage
f1=~y1      0.045          0.70       -0.071      0.8
f1=~y2      0.058          0.70        0.028      1.0
f1=~y3      0.070          0.70       -0.001      1.0
f2=~y4      0.055          0.70       -0.022      1.0
f2=~y5      0.065          0.70       -0.015      1.0
f2=~y6      0.055          0.70        0.004      1.0
f1~~f2      0.141          0.50       -0.047      0.6
y1~~y1      0.058          0.51        0.024      1.0
y2~~y2      0.085          0.51       -0.055      0.6
y3~~y3      0.093          0.51        0.012      1.0
y4~~y4      0.078          0.51       -0.019      0.8
y5~~y5      0.094          0.51       -0.021      0.8
y6~~y6      0.075          0.51       -0.019      1.0
y1~1        0.115          0.00        0.023      0.8
y2~1        0.071          0.00        0.023      1.0
y3~1        0.101          0.00        0.024      0.8
y4~1        0.080          0.00       -0.069      0.8
y5~1        0.069          0.00       -0.031      1.0
y6~1        0.091          0.00       -0.015      1.0
========= Correlation between Fit Indices ============
       chisq    aic    bic  rmsea    cfi    tli   srmr
chisq  1.000  0.135  0.135  0.995 -0.956 -0.995  0.947
aic    0.135  1.000  1.000  0.070  0.074 -0.120  0.353
bic    0.135  1.000  1.000  0.070  0.074 -0.120  0.353
rmsea  0.995  0.070  0.070  1.000 -0.980 -0.985  0.944
cfi   -0.956  0.074  0.074 -0.980  1.000  0.935 -0.906
tli   -0.995 -0.120 -0.120 -0.985  0.935  1.000 -0.918
srmr   0.947  0.353  0.353  0.944 -0.906 -0.918  1.000
================== Replications =====================
Number of replications = 5 
Number of converged replications = 5 
Number of nonconverged replications: 
   1. Nonconvergent Results = 0 
   2. Nonconvergent results from multiple imputation = 0 
   3. At least one SE were negative or NA = 0 
   4. At least one variance estimates were negative = 0 
   5. At least one correlation estimates were greater than 1 or less than -1 = 0 
> 
> # Example of using simsem model template
> 
> popModel <- "
+ f1 =~ 0.7*y1 + 0.7*y2 + 0.7*y3
+ f2 =~ 0.7*y4 + 0.7*y5 + 0.7*y6
+ f1 ~~ 1*f1
+ f2 ~~ 1*f2
+ f1 ~~ 0.5*f2
+ y1 ~~ 0.49*y1
+ y2 ~~ 0.49*y2
+ y3 ~~ 0.49*y3
+ y4 ~~ 0.49*y4
+ y5 ~~ 0.49*y5
+ y6 ~~ 0.49*y6
+ "
> 
> analysisModel <- "
+ f1 =~ y1 + y2 + y3
+ f2 =~ y4 + y5 + y6
+ "
> 
> Output <- sim(5, model=analysisModel, n=200, generate=popModel, std.lv=TRUE)
> summary(Output)
RESULT OBJECT
Model Type
[1] "lavaan"
========= Fit Indices Cutoffs ============
           Alpha
Fit Indices      0.1     0.05     0.01    0.001     Mean     SD
      chisq   22.988   25.092   26.775   27.153   14.438  8.218
      aic   3103.496 3114.409 3123.140 3125.104 3065.072 41.744
      bic   3146.374 3157.288 3166.018 3167.982 3107.950 41.744
      rmsea    0.095    0.102    0.108    0.109    0.050  0.046
      cfi      0.955    0.948    0.942    0.941    0.979  0.024
      tli      0.915    0.902    0.891    0.889    0.963  0.048
      srmr     0.056    0.061    0.065    0.066    0.040  0.017
========= Parameter Estimates and Standard Errors ============
       Estimate.Average Estimate.SD Average.SE Power..Not.equal.0. Std.Est
f1=~y1            0.663       0.048      0.067                   1   0.716
f1=~y2            0.698       0.045      0.069                   1   0.734
f1=~y3            0.669       0.043      0.072                   1   0.678
f2=~y4            0.653       0.063      0.073                   1   0.666
f2=~y5            0.721       0.135      0.073                   1   0.719
f2=~y6            0.721       0.077      0.076                   1   0.706
y1~~y1            0.417       0.051      0.064                   1   0.486
y2~~y2            0.416       0.080      0.068                   1   0.459
y3~~y3            0.527       0.049      0.073                   1   0.540
y4~~y4            0.533       0.067      0.074                   1   0.555
y5~~y5            0.462       0.078      0.077                   1   0.476
y6~~y6            0.520       0.126      0.082                   1   0.497
f1~~f2            0.477       0.126      0.078                   1   0.477
       Std.Est.SD Average.Param Average.Bias Coverage
f1=~y1      0.034          0.70       -0.037      1.0
f1=~y2      0.050          0.70       -0.002      1.0
f1=~y3      0.017          0.70       -0.031      1.0
f2=~y4      0.036          0.70       -0.047      0.8
f2=~y5      0.095          0.70        0.021      0.6
f2=~y6      0.079          0.70        0.021      1.0
y1~~y1      0.047          0.49       -0.073      0.6
y2~~y2      0.072          0.49       -0.074      0.8
y3~~y3      0.023          0.49        0.037      1.0
y4~~y4      0.047          0.49        0.043      1.0
y5~~y5      0.131          0.49       -0.028      1.0
y6~~y6      0.116          0.49        0.030      0.8
f1~~f2      0.126          0.50       -0.023      0.6
========= Correlation between Fit Indices ============
       chisq    aic    bic  rmsea    cfi    tli   srmr
chisq  1.000  0.261  0.261  0.968 -0.995 -0.997  0.989
aic    0.261  1.000  1.000  0.434 -0.248 -0.304  0.289
bic    0.261  1.000  1.000  0.434 -0.248 -0.304  0.289
rmsea  0.968  0.434  0.434  1.000 -0.956 -0.967  0.940
cfi   -0.995 -0.248 -0.248 -0.956  1.000  0.997 -0.985
tli   -0.997 -0.304 -0.304 -0.967  0.997  1.000 -0.992
srmr   0.989  0.289  0.289  0.940 -0.985 -0.992  1.000
================== Replications =====================
Number of replications = 5 
Number of converged replications = 5 
Number of nonconverged replications: 
   1. Nonconvergent Results = 0 
   2. Nonconvergent results from multiple imputation = 0 
   3. At least one SE were negative or NA = 0 
   4. At least one variance estimates were negative = 0 
   5. At least one correlation estimates were greater than 1 or less than -1 = 0 
> 
> # Example of using population data
> 
> pop <- data.frame(y1 = rnorm(100000, 0, 1), y2 = rnorm(100000, 0, 1))
> 
> covModel <- "
+ y1 ~~ y2
+ "
> 
> Output <- sim(5, model=covModel, n=200, rawData=pop)
> summary(Output)
RESULT OBJECT
Model Type
[1] "lavaan"
========= Fit Indices Cutoffs ============
           Alpha
Fit Indices      0.1     0.05     0.01    0.001     Mean     SD
      chisq    0.000    0.000    0.000    0.000    0.000  0.000
      aic   1142.931 1153.299 1161.594 1163.460 1113.425 29.748
      bic   1152.826 1163.194 1171.489 1173.355 1123.320 29.748
      rmsea    0.000    0.000    0.000    0.000    0.000  0.000
      cfi      0.200    0.100    0.020    0.002    0.667  0.577
      tli      1.000    1.000    1.000    1.000    1.000  0.000
      srmr     0.000    0.000    0.000    0.000    0.000  0.000
========= Parameter Estimates and Standard Errors ============
       Estimate.Average Estimate.SD Average.SE Power..Not.equal.0. Std.Est
y1~~y2            0.011       0.101      0.067                 0.2   0.017
y1~~y1            0.924       0.056      0.092                 1.0   1.000
y2~~y2            0.960       0.134      0.096                 1.0   1.000
       Std.Est.SD Average.Param Average.Bias Coverage
y1~~y2      0.105        -0.002        0.013      0.8
y1~~y1      0.000         1.004       -0.080      1.0
y2~~y2      0.000         0.999       -0.039      1.0
========= Correlation between Fit Indices ============
Warning in cor(fit) : the standard deviation is zero
       chisq    aic    bic rmsea cfi tli   srmr
chisq  1.000 -0.030 -0.030    NA  NA  NA  0.827
aic   -0.030  1.000  1.000    NA  NA  NA -0.372
bic   -0.030  1.000  1.000    NA  NA  NA -0.372
rmsea     NA     NA     NA     1  NA  NA     NA
cfi       NA     NA     NA    NA   1  NA     NA
tli       NA     NA     NA    NA  NA   1     NA
srmr   0.827 -0.372 -0.372    NA  NA  NA  1.000
================== Replications =====================
Number of replications = 5 
Number of converged replications = 5 
Number of nonconverged replications: 
   1. Nonconvergent Results = 0 
   2. Nonconvergent results from multiple imputation = 0 
   3. At least one SE were negative or NA = 0 
   4. At least one variance estimates were negative = 0 
   5. At least one correlation estimates were greater than 1 or less than -1 = 0 
> 
> # Example of data transformation: Transforming to standard score
> fun1 <- function(data) {
+ 	temp <- scale(data)
+ 	temp[,"group"] <- data[,"group"]
+ 	as.data.frame(temp)
+ }
> 
> # Example of additional output: Extract modification indices from lavaan
> fun2 <- function(out) {
+ 	inspect(out, "mi")
+ }
> 
> # In reality, more than 5 replications are needed.
> Output <- sim(5, CFA.Model,n=200,datafun=fun1, outfun=fun2)
> summary(Output)
RESULT OBJECT
Model Type
[1] "cfa"
========= Fit Indices Cutoffs ============
           Alpha
Fit Indices      0.1     0.05     0.01    0.001     Mean     SD
      chisq   16.675   19.341   21.474   21.954    9.193  7.614
      aic   3182.616 3198.124 3210.530 3213.322 3144.531 39.840
      bic   3245.284 3260.792 3273.198 3275.990 3207.199 39.840
      rmsea    0.064    0.079    0.091    0.093    0.026  0.039
      cfi      0.972    0.964    0.957    0.955    0.990  0.020
      tli      0.948    0.932    0.919    0.916    0.996  0.049
      srmr     0.042    0.046    0.049    0.050    0.028  0.013
========= Parameter Estimates and Standard Errors ============
       Estimate.Average Estimate.SD Average.SE Power..Not.equal.0. Std.Est
f1=~y1            0.650       0.045      0.075                   1   0.651
f1=~y2            0.735       0.058      0.074                   1   0.736
f1=~y3            0.690       0.070      0.074                   1   0.692
f2=~y4            0.693       0.055      0.074                   1   0.694
f2=~y5            0.695       0.065      0.074                   1   0.697
f2=~y6            0.705       0.054      0.074                   1   0.707
f1~~f2            0.453       0.141      0.081                   1   0.453
y1~~y1            0.572       0.058      0.078                   1   0.574
y2~~y2            0.453       0.085      0.080                   1   0.455
y3~~y3            0.515       0.093      0.078                   1   0.517
y4~~y4            0.513       0.077      0.077                   1   0.515
y5~~y5            0.508       0.093      0.077                   1   0.511
y6~~y6            0.496       0.074      0.077                   1   0.498
y1~1              0.000       0.000      0.071                   0   0.000
y2~1              0.000       0.000      0.071                   0   0.000
y3~1              0.000       0.000      0.071                   0   0.000
y4~1              0.000       0.000      0.071                   0   0.000
y5~1              0.000       0.000      0.071                   0   0.000
y6~1              0.000       0.000      0.071                   0   0.000
       Std.Est.SD Average.Param Average.Bias Coverage
f1=~y1      0.045          0.70       -0.050      1.0
f1=~y2      0.058          0.70        0.035      1.0
f1=~y3      0.070          0.70       -0.010      1.0
f2=~y4      0.055          0.70       -0.007      1.0
f2=~y5      0.065          0.70       -0.005      1.0
f2=~y6      0.055          0.70        0.005      1.0
f1~~f2      0.141          0.50       -0.047      0.6
y1~~y1      0.058          0.51        0.062      1.0
y2~~y2      0.085          0.51       -0.057      1.0
y3~~y3      0.093          0.51        0.005      1.0
y4~~y4      0.078          0.51        0.003      1.0
y5~~y5      0.094          0.51       -0.002      0.8
y6~~y6      0.075          0.51       -0.014      1.0
y1~1        0.000          0.00        0.000      1.0
y2~1        0.000          0.00        0.000      1.0
y3~1        0.000          0.00        0.000      1.0
y4~1        0.000          0.00        0.000      1.0
y5~1        0.000          0.00        0.000      1.0
y6~1        0.000          0.00        0.000      1.0
========= Correlation between Fit Indices ============
       chisq    aic    bic  rmsea    cfi    tli   srmr
chisq  1.000 -0.343 -0.343  0.995 -0.956 -0.995  0.947
aic   -0.343  1.000  1.000 -0.303  0.186  0.432 -0.132
bic   -0.343  1.000  1.000 -0.303  0.186  0.432 -0.132
rmsea  0.995 -0.303 -0.303  1.000 -0.980 -0.985  0.944
cfi   -0.956  0.186  0.186 -0.980  1.000  0.935 -0.906
tli   -0.995  0.432  0.432 -0.985  0.935  1.000 -0.918
srmr   0.947 -0.132 -0.132  0.944 -0.906 -0.918  1.000
================== Replications =====================
Number of replications = 5 
Number of converged replications = 5 
Number of nonconverged replications: 
   1. Nonconvergent Results = 0 
   2. Nonconvergent results from multiple imputation = 0 
   3. At least one SE were negative or NA = 0 
   4. At least one variance estimates were negative = 0 
   5. At least one correlation estimates were greater than 1 or less than -1 = 0 
> 
> # Get modification indices
> getExtraOutput(Output)
[[1]]
   lhs op rhs    mi    epc sepc.lv sepc.all sepc.nox
1   f1 =~  y1 0.000  0.000   0.000    0.000    0.000
2   f1 =~  y2 0.000  0.000   0.000    0.000    0.000
3   f1 =~  y3 0.000  0.000   0.000    0.000    0.000
4   f1 =~  y4 0.484  0.074   0.074    0.074    0.074
5   f1 =~  y5 0.692  0.087   0.087    0.088    0.088
6   f1 =~  y6 2.250 -0.161  -0.161   -0.161   -0.161
7   f2 =~  y1 3.584 -0.210  -0.210   -0.211   -0.211
8   f2 =~  y2 1.431  0.143   0.143    0.143    0.143
9   f2 =~  y3 0.321  0.075   0.075    0.075    0.075
10  f2 =~  y4 0.000  0.000   0.000    0.000    0.000
11  f2 =~  y5 0.000  0.000   0.000    0.000    0.000
12  f2 =~  y6 0.000  0.000   0.000    0.000    0.000
13  y1 ~~  y1 0.000  0.000   0.000    0.000    0.000
14  y1 ~~  y2 0.321  0.040   0.040    0.041    0.041
15  y1 ~~  y3 1.431  0.097   0.097    0.098    0.098
16  y1 ~~  y4 0.210 -0.022  -0.022   -0.022   -0.022
17  y1 ~~  y5 0.849  0.045   0.045    0.045    0.045
18  y1 ~~  y6 4.581 -0.103  -0.103   -0.103   -0.103
19  y2 ~~  y2 0.000  0.000   0.000    0.000    0.000
20  y2 ~~  y3 3.584 -0.189  -0.189   -0.190   -0.190
21  y2 ~~  y4 0.924  0.045   0.045    0.045    0.045
22  y2 ~~  y5 0.000  0.001   0.001    0.001    0.001
23  y2 ~~  y6 0.000  0.001   0.001    0.001    0.001
24  y3 ~~  y3 0.000  0.000   0.000    0.000    0.000
25  y3 ~~  y4 0.016  0.006   0.006    0.006    0.006
26  y3 ~~  y5 0.007  0.004   0.004    0.004    0.004
27  y3 ~~  y6 0.045  0.010   0.010    0.010    0.010
28  y4 ~~  y4 0.000  0.000   0.000    0.000    0.000
29  y4 ~~  y5 2.250 -0.118  -0.118   -0.118   -0.118
30  y4 ~~  y6 0.692  0.071   0.071    0.071    0.071
31  y5 ~~  y5 0.000  0.000   0.000    0.000    0.000
32  y5 ~~  y6 0.484  0.055   0.055    0.056    0.056
33  y6 ~~  y6 0.000  0.000   0.000    0.000    0.000
34  f1 ~~  f1    NA     NA      NA       NA       NA
35  f1 ~~  f2 0.000  0.000   0.000    0.000    0.000
36  f2 ~~  f2    NA     NA      NA       NA       NA
37  y1 ~1     0.000  0.000   0.000    0.000    0.000
38  y2 ~1     0.000  0.000   0.000    0.000    0.000
39  y3 ~1     0.000  0.000   0.000    0.000    0.000
40  y4 ~1     0.000  0.000   0.000    0.000    0.000
41  y5 ~1     0.000  0.000   0.000    0.000    0.000
42  y6 ~1     0.000  0.000   0.000    0.000    0.000
43  f1 ~1        NA     NA      NA       NA       NA
44  f2 ~1        NA     NA      NA       NA       NA

[[2]]
   lhs op rhs    mi    epc sepc.lv sepc.all sepc.nox
1   f1 =~  y1 0.000  0.000   0.000    0.000    0.000
2   f1 =~  y2 0.000  0.000   0.000    0.000    0.000
3   f1 =~  y3 0.000  0.000   0.000    0.000    0.000
4   f1 =~  y4 2.576  0.140   0.140    0.141    0.141
5   f1 =~  y5 1.875 -0.120  -0.120   -0.120   -0.120
6   f1 =~  y6 0.060 -0.021  -0.021   -0.021   -0.021
7   f2 =~  y1 0.094  0.026   0.026    0.026    0.026
8   f2 =~  y2 0.128 -0.030  -0.030   -0.030   -0.030
9   f2 =~  y3 0.002  0.004   0.004    0.004    0.004
10  f2 =~  y4 0.000  0.000   0.000    0.000    0.000
11  f2 =~  y5 0.000  0.000   0.000    0.000    0.000
12  f2 =~  y6 0.000  0.000   0.000    0.000    0.000
13  y1 ~~  y1 0.000  0.000   0.000    0.000    0.000
14  y1 ~~  y2 0.002  0.008   0.008    0.008    0.008
15  y1 ~~  y3 0.128 -0.066  -0.066   -0.066   -0.066
16  y1 ~~  y4 0.182  0.022   0.022    0.022    0.022
17  y1 ~~  y5 0.035  0.010   0.010    0.010    0.010
18  y1 ~~  y6 0.086 -0.015  -0.015   -0.015   -0.015
19  y2 ~~  y2 0.000  0.000   0.000    0.000    0.000
20  y2 ~~  y3 0.094  0.056   0.056    0.056    0.056
21  y2 ~~  y4 0.058  0.013   0.013    0.013    0.013
22  y2 ~~  y5 0.654 -0.042  -0.042   -0.042   -0.042
23  y2 ~~  y6 0.034  0.010   0.010    0.010    0.010
24  y3 ~~  y3 0.000  0.000   0.000    0.000    0.000
25  y3 ~~  y4 0.649  0.041   0.041    0.041    0.041
26  y3 ~~  y5 0.417 -0.033  -0.033   -0.033   -0.033
27  y3 ~~  y6 0.014 -0.006  -0.006   -0.006   -0.006
28  y4 ~~  y4 0.000  0.000   0.000    0.000    0.000
29  y4 ~~  y5 0.060 -0.042  -0.042   -0.042   -0.042
30  y4 ~~  y6 1.875 -0.226  -0.226   -0.227   -0.227
31  y5 ~~  y5 0.000  0.000   0.000    0.000    0.000
32  y5 ~~  y6 2.576  0.262   0.262    0.264    0.264
33  y6 ~~  y6 0.000  0.000   0.000    0.000    0.000
34  f1 ~~  f1    NA     NA      NA       NA       NA
35  f1 ~~  f2 0.000  0.000   0.000    0.000    0.000
36  f2 ~~  f2    NA     NA      NA       NA       NA
37  y1 ~1     0.000  0.000   0.000    0.000    0.000
38  y2 ~1     0.000  0.000   0.000    0.000    0.000
39  y3 ~1     0.000  0.000   0.000    0.000    0.000
40  y4 ~1     0.000  0.000   0.000    0.000    0.000
41  y5 ~1     0.000  0.000   0.000    0.000    0.000
42  y6 ~1     0.000  0.000   0.000    0.000    0.000
43  f1 ~1        NA     NA      NA       NA       NA
44  f2 ~1        NA     NA      NA       NA       NA

[[3]]
   lhs op rhs     mi    epc sepc.lv sepc.all sepc.nox
1   f1 =~  y1  0.000  0.000   0.000    0.000    0.000
2   f1 =~  y2  0.000  0.000   0.000    0.000    0.000
3   f1 =~  y3  0.000  0.000   0.000    0.000    0.000
4   f1 =~  y4  0.831 -0.068  -0.068   -0.068   -0.068
5   f1 =~  y5 14.519  0.289   0.289    0.290    0.290
6   f1 =~  y6 10.940 -0.244  -0.244   -0.244   -0.244
7   f2 =~  y1  0.085  0.022   0.022    0.022    0.022
8   f2 =~  y2  0.757 -0.071  -0.071   -0.071   -0.071
9   f2 =~  y3  0.613  0.060   0.060    0.060    0.060
10  f2 =~  y4  0.000  0.000   0.000    0.000    0.000
11  f2 =~  y5  0.000  0.000   0.000    0.000    0.000
12  f2 =~  y6  0.000  0.000   0.000    0.000    0.000
13  y1 ~~  y1  0.000  0.000   0.000    0.000    0.000
14  y1 ~~  y2  0.613  0.172   0.172    0.172    0.172
15  y1 ~~  y3  0.757 -0.105  -0.105   -0.106   -0.106
16  y1 ~~  y4  1.446 -0.056  -0.056   -0.057   -0.057
17  y1 ~~  y5  4.082  0.089   0.089    0.090    0.090
18  y1 ~~  y6  0.957 -0.045  -0.045   -0.045   -0.045
19  y2 ~~  y2  0.000  0.000   0.000    0.000    0.000
20  y2 ~~  y3  0.085  0.044   0.044    0.044    0.044
21  y2 ~~  y4  1.051  0.047   0.047    0.047    0.047
22  y2 ~~  y5  0.447  0.029   0.029    0.029    0.029
23  y2 ~~  y6  5.957 -0.108  -0.108   -0.109   -0.109
24  y3 ~~  y3  0.000  0.000   0.000    0.000    0.000
25  y3 ~~  y4  1.398 -0.059  -0.059   -0.059   -0.059
26  y3 ~~  y5  0.785  0.041   0.041    0.042    0.042
27  y3 ~~  y6  0.653  0.039   0.039    0.039    0.039
28  y4 ~~  y4  0.000  0.000   0.000    0.000    0.000
29  y4 ~~  y5 10.940 -0.536  -0.536   -0.538   -0.538
30  y4 ~~  y6 14.519  0.504   0.504    0.507    0.507
31  y5 ~~  y5  0.000  0.000   0.000    0.000    0.000
32  y5 ~~  y6  0.831 -0.170  -0.170   -0.171   -0.171
33  y6 ~~  y6  0.000  0.000   0.000    0.000    0.000
34  f1 ~~  f1     NA     NA      NA       NA       NA
35  f1 ~~  f2  0.000  0.000   0.000    0.000    0.000
36  f2 ~~  f2     NA     NA      NA       NA       NA
37  y1 ~1      0.000  0.000   0.000    0.000    0.000
38  y2 ~1      0.000  0.000   0.000    0.000    0.000
39  y3 ~1      0.000  0.000   0.000    0.000    0.000
40  y4 ~1      0.000  0.000   0.000    0.000    0.000
41  y5 ~1      0.000  0.000   0.000    0.000    0.000
42  y6 ~1      0.000  0.000   0.000    0.000    0.000
43  f1 ~1         NA     NA      NA       NA       NA
44  f2 ~1         NA     NA      NA       NA       NA

[[4]]
   lhs op rhs    mi    epc sepc.lv sepc.all sepc.nox
1   f1 =~  y1 0.000  0.000   0.000    0.000    0.000
2   f1 =~  y2 0.000  0.000   0.000    0.000    0.000
3   f1 =~  y3 0.000  0.000   0.000    0.000    0.000
4   f1 =~  y4 0.023  0.015   0.015    0.015    0.015
5   f1 =~  y5 0.017 -0.013  -0.013   -0.013   -0.013
6   f1 =~  y6 0.001 -0.003  -0.003   -0.003   -0.003
7   f2 =~  y1 0.027 -0.016  -0.016   -0.016   -0.016
8   f2 =~  y2 0.200 -0.045  -0.045   -0.045   -0.045
9   f2 =~  y3 0.368  0.059   0.059    0.060    0.060
10  f2 =~  y4 0.000  0.000   0.000    0.000    0.000
11  f2 =~  y5 0.000  0.000   0.000    0.000    0.000
12  f2 =~  y6 0.000  0.000   0.000    0.000    0.000
13  y1 ~~  y1 0.000  0.000   0.000    0.000    0.000
14  y1 ~~  y2 0.368  0.054   0.054    0.055    0.055
15  y1 ~~  y3 0.200 -0.037  -0.037   -0.037   -0.037
16  y1 ~~  y4 0.530  0.036   0.036    0.036    0.036
17  y1 ~~  y5 0.428 -0.032  -0.032   -0.033   -0.033
18  y1 ~~  y6 0.051 -0.011  -0.011   -0.011   -0.011
19  y2 ~~  y2 0.000  0.000   0.000    0.000    0.000
20  y2 ~~  y3 0.027 -0.018  -0.018   -0.018   -0.018
21  y2 ~~  y4 1.168 -0.051  -0.051   -0.051   -0.051
22  y2 ~~  y5 1.389  0.055   0.055    0.055    0.055
23  y2 ~~  y6 0.202 -0.021  -0.021   -0.021   -0.021
24  y3 ~~  y3 0.000  0.000   0.000    0.000    0.000
25  y3 ~~  y4 0.452  0.032   0.032    0.032    0.032
26  y3 ~~  y5 0.670 -0.039  -0.039   -0.039   -0.039
27  y3 ~~  y6 0.419  0.030   0.030    0.030    0.030
28  y4 ~~  y4 0.000  0.000   0.000    0.000    0.000
29  y4 ~~  y5 0.001 -0.002  -0.002   -0.002   -0.002
30  y4 ~~  y6 0.017 -0.013  -0.013   -0.013   -0.013
31  y5 ~~  y5 0.000  0.000   0.000    0.000    0.000
32  y5 ~~  y6 0.023  0.015   0.015    0.015    0.015
33  y6 ~~  y6 0.000  0.000   0.000    0.000    0.000
34  f1 ~~  f1    NA     NA      NA       NA       NA
35  f1 ~~  f2 0.000  0.000   0.000    0.000    0.000
36  f2 ~~  f2    NA     NA      NA       NA       NA
37  y1 ~1     0.000  0.000   0.000    0.000    0.000
38  y2 ~1     0.000  0.000   0.000    0.000    0.000
39  y3 ~1     0.000  0.000   0.000    0.000    0.000
40  y4 ~1     0.000  0.000   0.000    0.000    0.000
41  y5 ~1     0.000  0.000   0.000    0.000    0.000
42  y6 ~1     0.000  0.000   0.000    0.000    0.000
43  f1 ~1        NA     NA      NA       NA       NA
44  f2 ~1        NA     NA      NA       NA       NA

[[5]]
   lhs op rhs    mi    epc sepc.lv sepc.all sepc.nox
1   f1 =~  y1 0.000  0.000   0.000    0.000    0.000
2   f1 =~  y2 0.000  0.000   0.000    0.000    0.000
3   f1 =~  y3 0.000  0.000   0.000    0.000    0.000
4   f1 =~  y4 0.516  0.071   0.071    0.071    0.071
5   f1 =~  y5 0.693 -0.079  -0.079   -0.079   -0.079
6   f1 =~  y6 0.004  0.006   0.006    0.006    0.006
7   f2 =~  y1 0.026  0.016   0.016    0.016    0.016
8   f2 =~  y2 1.024  0.107   0.107    0.107    0.107
9   f2 =~  y3 1.500 -0.120  -0.120   -0.120   -0.120
10  f2 =~  y4 0.000  0.000   0.000    0.000    0.000
11  f2 =~  y5 0.000  0.000   0.000    0.000    0.000
12  f2 =~  y6 0.000  0.000   0.000    0.000    0.000
13  y1 ~~  y1 0.000  0.000   0.000    0.000    0.000
14  y1 ~~  y2 1.500 -0.124  -0.124   -0.124   -0.124
15  y1 ~~  y3 1.024  0.085   0.085    0.086    0.086
16  y1 ~~  y4 1.462  0.057   0.057    0.058    0.058
17  y1 ~~  y5 2.105 -0.071  -0.071   -0.072   -0.072
18  y1 ~~  y6 0.044  0.010   0.010    0.010    0.010
19  y2 ~~  y2 0.000  0.000   0.000    0.000    0.000
20  y2 ~~  y3 0.026  0.017   0.017    0.017    0.017
21  y2 ~~  y4 0.934  0.045   0.045    0.045    0.045
22  y2 ~~  y5 1.101  0.050   0.050    0.050    0.050
23  y2 ~~  y6 1.457 -0.057  -0.057   -0.057   -0.057
24  y3 ~~  y3 0.000  0.000   0.000    0.000    0.000
25  y3 ~~  y4 2.469 -0.074  -0.074   -0.075   -0.075
26  y3 ~~  y5 0.520 -0.035  -0.035   -0.035   -0.035
27  y3 ~~  y6 1.622  0.062   0.062    0.062    0.062
28  y4 ~~  y4 0.000  0.000   0.000    0.000    0.000
29  y4 ~~  y5 0.004  0.006   0.006    0.006    0.006
30  y4 ~~  y6 0.693 -0.087  -0.087   -0.087   -0.087
31  y5 ~~  y5 0.000  0.000   0.000    0.000    0.000
32  y5 ~~  y6 0.516  0.062   0.062    0.063    0.063
33  y6 ~~  y6 0.000  0.000   0.000    0.000    0.000
34  f1 ~~  f1    NA     NA      NA       NA       NA
35  f1 ~~  f2 0.000  0.000   0.000    0.000    0.000
36  f2 ~~  f2    NA     NA      NA       NA       NA
37  y1 ~1     0.000  0.000   0.000    0.000    0.000
38  y2 ~1     0.000  0.000   0.000    0.000    0.000
39  y3 ~1     0.000  0.000   0.000    0.000    0.000
40  y4 ~1     0.000  0.000   0.000    0.000    0.000
41  y5 ~1     0.000  0.000   0.000    0.000    0.000
42  y6 ~1     0.000  0.000   0.000    0.000    0.000
43  f1 ~1        NA     NA      NA       NA       NA
44  f2 ~1        NA     NA      NA       NA       NA

> 
> 
> 
> cleanEx()

detaching 'package:parallel'

> nameEx("summaryConverge")
> ### * summaryConverge
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: summaryConverge
> ### Title: Provide a comparison between the characteristics of convergent
> ###   replications and nonconvergent replications
> ### Aliases: summaryConverge
> 
> ### ** Examples
> 
> ## Not run: 
> ##D path.BE <- matrix(0, 4, 4)
> ##D path.BE[3, 1:2] <- NA
> ##D path.BE[4, 3] <- NA
> ##D starting.BE <- matrix("", 4, 4)
> ##D starting.BE[3, 1:2] <- "runif(1, 0.3, 0.5)"
> ##D starting.BE[4, 3] <- "runif(1, 0.5, 0.7)"
> ##D mis.path.BE <- matrix(0, 4, 4)
> ##D mis.path.BE[4, 1:2] <- "runif(1, -0.1, 0.1)"
> ##D BE <- bind(path.BE, starting.BE, misspec=mis.path.BE)
> ##D 
> ##D residual.error <- diag(4)
> ##D residual.error[1,2] <- residual.error[2,1] <- NA
> ##D RPS <- binds(residual.error, "rnorm(1, 0.3, 0.1)")
> ##D 
> ##D loading <- matrix(0, 12, 4)
> ##D loading[1:3, 1] <- NA
> ##D loading[4:6, 2] <- NA
> ##D loading[7:9, 3] <- NA
> ##D loading[10:12, 4] <- NA
> ##D mis.loading <- matrix("runif(1, -0.3, 0.3)", 12, 4)
> ##D mis.loading[is.na(loading)] <- 0
> ##D LY <- bind(loading, "runif(1, 0.7, 0.9)", misspec=mis.loading)
> ##D 
> ##D mis.error.cor <- matrix("rnorm(1, 0, 0.1)", 12, 12)
> ##D diag(mis.error.cor) <- 0
> ##D RTE <- binds(diag(12), misspec=mis.error.cor)
> ##D 
> ##D SEM.Model <- model(RPS = RPS, BE = BE, LY=LY, RTE=RTE, modelType="SEM")
> ##D 
> ##D n1 <- list(mean = 0, sd = 0.1)
> ##D chi5 <- list(df = 5)
> ##D 
> ##D facDist <- bindDist(c("chisq", "chisq", "norm", "norm"), chi5, chi5, n1, n1)
> ##D 
> ##D # In reality, more than 50 replications are needed.
> ##D simOut <- sim(50, n=500, SEM.Model, sequential=TRUE, facDist=facDist, estimator="mlr")
> ##D 
> ##D # Summary the convergent and nonconvergent replications
> ##D summaryConverge(simOut)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("summaryFit")
> ### * summaryFit
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: summaryFit
> ### Title: Provide summary of model fit across replications
> ### Aliases: summaryFit
> 
> ### ** Examples
> 
> loading <- matrix(0, 6, 1)
> loading[1:6, 1] <- NA
> LY <- bind(loading, 0.7)
> RPS <- binds(diag(1))
> RTE <- binds(diag(6))
> CFA.Model <- model(LY = LY, RPS = RPS, RTE = RTE, modelType="CFA")
> 
> # We make the examples running only 5 replications to save time.
> # In reality, more replications are needed.
> Output <- sim(5, n=500, CFA.Model)
Loading required package: parallel
> 
> # Summarize the sample fit indices
> summaryFit(Output)
           Alpha
Fit Indices          0.1         0.05         0.01        0.001         Mean
      chisq 1.300706e+01 1.431242e+01 1.535671e+01 1.559167e+01 8.442285e+00
      aic   7.494181e+03 7.494820e+03 7.495332e+03 7.495447e+03 7.438781e+03
      bic   7.570044e+03 7.570683e+03 7.571194e+03 7.571310e+03 7.514644e+03
      rmsea 2.480773e-02 3.157818e-02 3.699454e-02 3.821322e-02 8.569000e-03
      cfi   9.964579e-01 9.953105e-01 9.943925e-01 9.941859e-01 9.988127e-01
      tli   9.940965e-01 9.921841e-01 9.906541e-01 9.903099e-01 1.001264e+00
      srmr  1.511901e-02 1.544728e-02 1.570990e-02 1.576899e-02 1.239692e-02
           Alpha
Fit Indices           SD
      chisq  4.586910195
      aic   64.987074434
      bic   64.987074434
      rmsea  0.016760787
      cfi    0.002599602
      tli    0.007294037
      srmr   0.002825279
> 
> 
> 
> cleanEx()

detaching 'package:parallel'

> nameEx("summaryMisspec")
> ### * summaryMisspec
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: summaryMisspec
> ### Title: Provide summary of the population misfit and
> ###   misspecified-parameter values across replications
> ### Aliases: summaryMisspec
> 
> ### ** Examples
> 
> ## Not run: 
> ##D path <- matrix(0, 4, 4)
> ##D path[3, 1:2] <- NA
> ##D path[4, 3] <- NA
> ##D pathVal <- matrix("", 4, 4)
> ##D pathVal[3, 1:2] <- "runif(1, 0.3, 0.5)"
> ##D pathVal[4, 3] <- "runif(1, 0.5, 0.7)"
> ##D pathMis <- matrix(0, 4, 4)
> ##D pathMis[4, 1:2] <- "runif(1, -0.1, 0.1)"
> ##D BE <- bind(path, pathVal, pathMis)
> ##D 
> ##D residual.error <- diag(4)
> ##D residual.error[1,2] <- residual.error[2,1] <- NA
> ##D RPS <- binds(residual.error, "rnorm(1, 0.3, 0.1)")
> ##D 
> ##D Path.Model <- model(RPS = RPS, BE = BE, modelType="Path")
> ##D 
> ##D # The number of replications in actual analysis should be much more than 5
> ##D ParamObject <- sim(5, n=200, Path.Model)
> ##D 
> ##D # Summarize the model misspecification that is specified in the 'pathMis' object
> ##D summaryMisspec(ParamObject)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("summaryParam")
> ### * summaryParam
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: summaryParam
> ### Title: Provide summary of parameter estimates and standard error across
> ###   replications
> ### Aliases: summaryParam
> 
> ### ** Examples
> 
> showClass("SimResult")
Class "SimResult" [package "simsem"]

Slots:
                                                                       
Name:     modelType         nRep         coef           se          fit
Class:    character      numeric   data.frame   data.frame   data.frame
                                                                       
Name:     converged   paramValue misspecValue       popFit         FMI1
Class:       vector   data.frame   data.frame   data.frame   data.frame
                                                                       
Name:          FMI2      stdCoef         seed            n         nobs
Class:   data.frame   data.frame      numeric       vector   data.frame
                                                                       
Name:        pmMCAR        pmMAR     extraOut    paramOnly       timing
Class:       vector       vector         list      logical         list
> loading <- matrix(0, 6, 1)
> loading[1:6, 1] <- NA
> LY <- bind(loading, 0.7)
> RPS <- binds(diag(1))
> RTE <- binds(diag(6))
> CFA.Model <- model(LY = LY, RPS = RPS, RTE = RTE, modelType="CFA")
> 
> # We make the examples running only 5 replications to save time.
> # In reality, more replications are needed.
> Output <- sim(5, n=500, CFA.Model)
Loading required package: parallel
> 
> # Summary of the parameter estimates
> summaryParam(Output)
       Estimate.Average Estimate.SD Average.SE Power..Not.equal.0.      Std.Est
f1=~y1      0.694043770  0.01781547 0.04163742                   1  0.700299596
f1=~y2      0.664032498  0.05004988 0.04174177                   1  0.674733152
f1=~y3      0.652742108  0.04602682 0.04134117                   1  0.671307416
f1=~y4      0.675329584  0.05666475 0.04140133                   1  0.687819804
f1=~y5      0.694838588  0.07836253 0.04143609                   1  0.701624723
f1=~y6      0.698589134  0.05338015 0.04167931                   1  0.702433747
y1~~y1      0.500730846  0.03285951 0.03855153                   1  0.509377930
y2~~y2      0.524743514  0.01245703 0.03927918                   1  0.544291157
y3~~y3      0.518102812  0.06014569 0.03861459                   1  0.547892722
y4~~y4      0.504363909  0.04566056 0.03830122                   1  0.525493316
y5~~y5      0.491558560  0.01803614 0.03810518                   1  0.506775777
y6~~y6      0.499749541  0.04761284 0.03854435                   1  0.506183431
y1~1       -0.008810148  0.05751387 0.04432595                   0 -0.009327775
y2~1       -0.009631695  0.03817582 0.04396553                   0 -0.009606366
y3~1       -0.048035069  0.01876568 0.04348083                   0 -0.049286225
y4~1       -0.030141352  0.05444905 0.04387118                   0 -0.030503564
y5~1       -0.025018328  0.03628409 0.04418667                   0 -0.023806731
y6~1        0.004855082  0.04243569 0.04444396                   0  0.004583798
       Std.Est.SD Average.Param Average.Bias Coverage
f1=~y1 0.01591170          0.70 -0.005956230      1.0
f1=~y2 0.02355888          0.70 -0.035967502      1.0
f1=~y3 0.04262673          0.70 -0.047257892      0.8
f1=~y4 0.04199108          0.70 -0.024670416      1.0
f1=~y5 0.03440514          0.70 -0.005161412      0.8
f1=~y6 0.02245549          0.70 -0.001410866      0.8
y1~~y1 0.02215388          0.51 -0.009269154      1.0
y2~~y2 0.03250012          0.51  0.014743514      1.0
y3~~y3 0.05770237          0.51  0.008102812      0.6
y4~~y4 0.05868259          0.51 -0.005636091      1.0
y5~~y5 0.04916697          0.51 -0.018441440      1.0
y6~~y6 0.03138416          0.51 -0.010250459      1.0
y1~1   0.05825793          0.00 -0.008810148      1.0
y2~1   0.03923871          0.00 -0.009631695      1.0
y3~1   0.01881353          0.00 -0.048035069      1.0
y4~1   0.05627538          0.00 -0.030141352      1.0
y5~1   0.03319385          0.00 -0.025018328      1.0
y6~1   0.04189960          0.00  0.004855082      1.0
> 
> # Summary of the parameter estimates with additional details
> summaryParam(Output, detail=TRUE)
       Estimate.Average Estimate.SD Average.SE Power..Not.equal.0.      Std.Est
f1=~y1      0.694043770  0.01781547 0.04163742                   1  0.700299596
f1=~y2      0.664032498  0.05004988 0.04174177                   1  0.674733152
f1=~y3      0.652742108  0.04602682 0.04134117                   1  0.671307416
f1=~y4      0.675329584  0.05666475 0.04140133                   1  0.687819804
f1=~y5      0.694838588  0.07836253 0.04143609                   1  0.701624723
f1=~y6      0.698589134  0.05338015 0.04167931                   1  0.702433747
y1~~y1      0.500730846  0.03285951 0.03855153                   1  0.509377930
y2~~y2      0.524743514  0.01245703 0.03927918                   1  0.544291157
y3~~y3      0.518102812  0.06014569 0.03861459                   1  0.547892722
y4~~y4      0.504363909  0.04566056 0.03830122                   1  0.525493316
y5~~y5      0.491558560  0.01803614 0.03810518                   1  0.506775777
y6~~y6      0.499749541  0.04761284 0.03854435                   1  0.506183431
y1~1       -0.008810148  0.05751387 0.04432595                   0 -0.009327775
y2~1       -0.009631695  0.03817582 0.04396553                   0 -0.009606366
y3~1       -0.048035069  0.01876568 0.04348083                   0 -0.049286225
y4~1       -0.030141352  0.05444905 0.04387118                   0 -0.030503564
y5~1       -0.025018328  0.03628409 0.04418667                   0 -0.023806731
y6~1        0.004855082  0.04243569 0.04444396                   0  0.004583798
       Std.Est.SD Average.Param Average.Bias Coverage     Rel.Bias    Std.Bias
f1=~y1 0.01591170          0.70 -0.005956230      1.0 -0.008508900 -0.33432918
f1=~y2 0.02355888          0.70 -0.035967502      1.0 -0.051382146 -0.71863313
f1=~y3 0.04262673          0.70 -0.047257892      0.8 -0.067511274 -1.02674693
f1=~y4 0.04199108          0.70 -0.024670416      1.0 -0.035243451 -0.43537500
f1=~y5 0.03440514          0.70 -0.005161412      0.8 -0.007373446 -0.06586582
f1=~y6 0.02245549          0.70 -0.001410866      0.8 -0.002015524 -0.02643055
y1~~y1 0.02215388          0.51 -0.009269154      1.0 -0.018174812 -0.28208441
y2~~y2 0.03250012          0.51  0.014743514      1.0  0.028908851  1.18354975
y3~~y3 0.05770237          0.51  0.008102812      0.6  0.015887866  0.13471973
y4~~y4 0.05868259          0.51 -0.005636091      1.0 -0.011051159 -0.12343455
y5~~y5 0.04916697          0.51 -0.018441440      1.0 -0.036159687 -1.02247178
y6~~y6 0.03138416          0.51 -0.010250459      1.0 -0.020098939 -0.21528768
y1~1   0.05825793          0.00 -0.008810148      1.0           NA -0.15318302
y2~1   0.03923871          0.00 -0.009631695      1.0           NA -0.25229831
y3~1   0.01881353          0.00 -0.048035069      1.0         -Inf -2.55973024
y4~1   0.05627538          0.00 -0.030141352      1.0           NA -0.55356983
y5~1   0.03319385          0.00 -0.025018328      1.0           NA -0.68951235
y6~1   0.04189960          0.00  0.004855082      1.0           NA  0.11441035
       Rel.SE.Bias
f1=~y1  1.33715032
f1=~y2 -0.16599662
f1=~y3 -0.10180250
f1=~y4 -0.26936358
f1=~y5 -0.47122576
f1=~y6 -0.21919826
y1~~y1  0.17322317
y2~~y2  2.15317400
y3~~y3 -0.35798249
y4~~y4 -0.16117506
y5~~y5  1.11271312
y6~~y6 -0.19046320
y1~1   -0.22929975
y2~1    0.15165895
y3~1    1.31704036
y4~1   -0.19427105
y5~1    0.21779743
y6~1    0.04732499
> 
> 
> 
> cleanEx()

detaching 'package:parallel'

> nameEx("summaryPopulation")
> ### * summaryPopulation
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: summaryPopulation
> ### Title: Summarize the population model used for data generation
> ###   underlying a result object
> ### Aliases: summaryPopulation
> 
> ### ** Examples
> 
> ## Not run: 
> ##D loading <- matrix(0, 6, 1)
> ##D loading[1:6, 1] <- NA
> ##D LY <- bind(loading, "runif(1, 0.4, 0.9)")
> ##D RPS <- binds(diag(1))
> ##D RTE <- binds(diag(6))
> ##D CFA.Model <- model(LY = LY, RPS = RPS, RTE = RTE, modelType="CFA")
> ##D 
> ##D # We will use only 10 replications to save time.
> ##D # In reality, more replications are needed.
> ##D Output <- sim(10, n=200, model=CFA.Model)
> ##D 
> ##D # Get the summary of population model
> ##D summaryPopulation(Output)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("summaryShort")
> ### * summaryShort
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: summaryShort
> ### Title: Provide short summary of an object.
> ### Aliases: summaryShort summaryShort-methods summaryShort,ANY-method
> ###   summaryShort,vector-method summaryShort,matrix-method
> 
> ### ** Examples
> 
> loading <- matrix(0, 6, 2)
> loading[1:3, 1] <- NA
> loading[4:6, 2] <- NA
> loadingValues <- matrix(0, 6, 2)
> LY <- bind(loading, "runif(1, 0.8, 0.9)")
> summaryShort(LY)
     [,1]                    [,2]                   
[1,] "NA:runif(1, 0.8, 0.9)" "0"                    
[2,] "NA:runif(1, 0.8, 0.9)" "0"                    
[3,] "NA:runif(1, 0.8, 0.9)" "0"                    
[4,] "0"                     "NA:runif(1, 0.8, 0.9)"
[5,] "0"                     "NA:runif(1, 0.8, 0.9)"
[6,] "0"                     "NA:runif(1, 0.8, 0.9)"
> 
> 
> 
> ### * <FOOTER>
> ###
> cat("Time elapsed: ", proc.time() - get("ptime", pos = 'CheckExEnv'),"\n")
Time elapsed:  7.81 0.14 8.13 NA NA 
> grDevices::dev.off()
null device 
          1 
> ###
> ### Local variables: ***
> ### mode: outline-minor ***
> ### outline-regexp: "\\(> \\)?### [*]+" ***
> ### End: ***
> quit('no')
